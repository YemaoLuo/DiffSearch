1cd490ac0024d2f5b643215fc0862d086c83661a
==================================================
Simplify addition of parameters
==================================================
Mark Emlyn
==================================================
Sun Oct 30 19:01:25 2011 +0000
==================================================
Request.java
Simplify addition of parameters

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1195223 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Parameters.java
index 84901c51b8..6d4c017f49 100644
--- a/java/org/apache/catalina/connector/Request.java
+++ b/java/org/apache/catalina/connector/Request.java
@@ -2524,13 +2524,13 @@ public class Request
                         if (encoding == null) {
                             encoding = Parameters.DEFAULT_ENCODING;
                         }
-                        parameters.addParameterValues(part.getName(),
-                                new String[] { part.getString(encoding) });
+                        parameters.addParameter(part.getName(),
+                                part.getString(encoding));
                     } catch (UnsupportedEncodingException uee) {
                         try {
-                            parameters.addParameterValues(part.getName(),
-                                    new String[] {part.getString(
-                                            Parameters.DEFAULT_ENCODING)});
+                            parameters.addParameter(part.getName(),
+                                    part.getString(
+                                            Parameters.DEFAULT_ENCODING));
                         } catch (UnsupportedEncodingException e) {
                             // Should not be possible
                         }

==================================================
TestParameters.java
index bd1a9c396f..45f3e9f19b 100644
--- a/java/org/apache/tomcat/util/http/Parameters.java
+++ b/java/org/apache/tomcat/util/http/Parameters.java
@@ -99,6 +99,7 @@ public final class Parameters {
     // Access to the current name/values, no side effect ( processing ).
     // You must explicitly call handleQueryParameters and the post methods.
 
+    @Deprecated
     public void addParameterValues(String key, String[] newValues) {
         if (key == null) {
             return;
@@ -171,7 +172,7 @@ public final class Parameters {
     }
 
 
-    private void addParam( String key, String value ) {
+    public void addParameter( String key, String value ) {
         if( key==null ) {
             return;
         }
@@ -342,7 +343,7 @@ public final class Parameters {
                     value = tmpValue.toString();
                 }
 
-                addParam(name, value);
+                addParameter(name, value);
             } catch (IOException e) {
                 decodeFailCount++;
                 if (decodeFailCount == 1 || log.isDebugEnabled()) {

==================================================
