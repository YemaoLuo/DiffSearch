cdc7445d1809429e457e76cc1f9f5f39f7b2f69b
==================================================
Remove unnecessary privileged block from getAttributeNamesInScope.
==================================================
Mark Thomas
==================================================
Thu Apr 6 20:42:01 2017 +0000
==================================================
PageContextImpl.java
Remove unnecessary privileged block from getAttributeNamesInScope.
I can't see anything in doGetAttributeNamesInScope that would trigger a security check.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1790459 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SecurityClassLoad.java
index 68e467b41a..de26955c57 100644
--- a/java/org/apache/jasper/runtime/PageContextImpl.java
+++ b/java/org/apache/jasper/runtime/PageContextImpl.java
@@ -420,20 +420,6 @@ public class PageContextImpl extends PageContext {
 
     @Override
     public Enumeration<String> getAttributeNamesInScope(final int scope) {
-        if (SecurityUtil.isPackageProtectionEnabled()) {
-            return AccessController.doPrivileged(
-                    new PrivilegedAction<Enumeration<String>>() {
-                        @Override
-                        public Enumeration<String> run() {
-                            return doGetAttributeNamesInScope(scope);
-                        }
-                    });
-        } else {
-            return doGetAttributeNamesInScope(scope);
-        }
-    }
-
-    private Enumeration<String> doGetAttributeNamesInScope(int scope) {
         switch (scope) {
         case PAGE_SCOPE:
             return Collections.enumeration(attributes.keySet());
@@ -443,8 +429,7 @@ public class PageContextImpl extends PageContext {
 
         case SESSION_SCOPE:
             if (session == null) {
-                throw new IllegalStateException(Localizer
-                        .getMessage("jsp.error.page.noSession"));
+                throw new IllegalStateException(Localizer.getMessage("jsp.error.page.noSession"));
             }
             return session.getAttributeNames();
 

==================================================
