c8ac1a0e50b94842a7e2fcde6adf9df1e8e5ab14
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51544
==================================================
Mark Emlyn
==================================================
Mon Jul 25 16:23:39 2011 +0000
==================================================
BeanELResolver.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51544
Correctly resolve bean methods in EL so accessible methods that are overridden by inaccessible methods do not cause an IllegalAccessException.
Modify test case to catch this problem on Oracle and OpenJDK JREs.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1150767 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestValueExpressionImpl.java
index 7ba9ce02ed..ddaa8e2ccc 100644
--- a/java/javax/el/BeanELResolver.java
+++ b/java/javax/el/BeanELResolver.java
@@ -402,7 +402,8 @@ public class BeanELResolver extends ELResolver {
         Class<?> clazz = base.getClass();
         if (paramTypes != null) {
             try {
-                matchingMethod = clazz.getMethod(methodName, paramTypes);
+                matchingMethod =
+                    getMethod(clazz, clazz.getMethod(methodName, paramTypes));
             } catch (NoSuchMethodException e) {
                 throw new MethodNotFoundException(e);
             }
@@ -416,11 +417,11 @@ public class BeanELResolver extends ELResolver {
                 if (methodName.equals(m.getName()) && 
                         m.getParameterTypes().length == paramCount) {
                     // Same number of parameters - use the first match
-                    matchingMethod = m;
+                    matchingMethod = getMethod(clazz, m);
                     break;
                 }
                 if (m.isVarArgs()) {
-                    matchingMethod = m;
+                    matchingMethod = getMethod(clazz, m);
                 }
             }
             if (matchingMethod == null) {

==================================================
