4356cd424ad15a2ba7e502447b31c3b64485dce4
==================================================
57974: Key the open session map on the endpoint instance rather than endpoint class. Will backport if it doesn't cause issues.
==================================================
Remy Maucherat
==================================================
Fri Jun 12 16:42:31 2015 +0000
==================================================
WsSession.java
57974: Key the open session map on the endpoint instance rather than endpoint class. Will backport if it doesn't cause issues.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1685128 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WsWebSocketContainer.java
index 111deac173..7994cef20e 100644
--- a/java/org/apache/tomcat/websocket/WsSession.java
+++ b/java/org/apache/tomcat/websocket/WsSession.java
@@ -415,7 +415,7 @@ public class WsSession implements Session {
     @Override
     public Set<Session> getOpenSessions() {
         checkState();
-        return webSocketContainer.getOpenSessions(localEndpoint.getClass());
+        return webSocketContainer.getOpenSessions(localEndpoint);
     }
 
 

==================================================
