9f8450668ca6705303b6c1d96530e1edcf6f9a22
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59888
==================================================
Mark Thomas
==================================================
Thu Aug 4 18:47:41 2016 +0000
==================================================
Cookie.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59888
Correctly handle tabs and spaces in quoted version one cookies when using the Rfc6265CookieProcessor.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1755224 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookieParsing.java
index b20b55586f..c0e277a377 100644
--- a/java/org/apache/tomcat/util/http/parser/Cookie.java
+++ b/java/org/apache/tomcat/util/http/parser/Cookie.java
@@ -86,7 +86,7 @@ public class Cookie {
             }
         }
         for (int i = 0; i < 256; i++) {
-            if (i < 0x21 || i == DEL_BYTE) {
+            if (i < TAB_BYTE || (i > TAB_BYTE && i < SPACE_BYTE) || i == DEL_BYTE) {
                 isText[i] = false;
             } else {
                 isText[i] = true;

==================================================
