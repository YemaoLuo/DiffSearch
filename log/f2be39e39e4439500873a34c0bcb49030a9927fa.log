f2be39e39e4439500873a34c0bcb49030a9927fa
==================================================
Servlet 4.0 updates for web.xml parsing
==================================================
Mark Thomas
==================================================
Mon Mar 20 10:07:29 2017 +0000
==================================================
ContextConfig.java
Servlet 4.0 updates for web.xml parsing
request-encoding -> request-character-encoding
response-encoding -> response-character-encoding

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1787705 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WebRuleSet.java
index ed49cb27f7..8b34e4995c 100644
--- a/java/org/apache/catalina/startup/ContextConfig.java
+++ b/java/org/apache/catalina/startup/ContextConfig.java
@@ -1299,7 +1299,7 @@ public class ContextConfig implements LifecycleListener {
                 webxml.getMimeMappings().entrySet()) {
             context.addMimeMapping(entry.getKey(), entry.getValue());
         }
-        context.setRequestCharacterEncoding(webxml.getRequestEncoding());
+        context.setRequestCharacterEncoding(webxml.getRequestCharacterEncoding());
         // Name is just used for ordering
         for (ContextResourceEnvRef resource :
                 webxml.getResourceEnvRefs().values()) {
@@ -1308,7 +1308,7 @@ public class ContextConfig implements LifecycleListener {
         for (ContextResource resource : webxml.getResourceRefs().values()) {
             context.getNamingResources().addResource(resource);
         }
-        context.setResponseCharacterEncoding(webxml.getResponseEncoding());
+        context.setResponseCharacterEncoding(webxml.getResponseCharacterEncoding());
         boolean allAuthenticatedUsersIsAppRole =
                 webxml.getSecurityRoles().contains(
                         SecurityConstraint.ROLE_ALL_AUTHENTICATED_USERS);

==================================================
WebXml.java
index cba9f60f01..7a5fe20f22 100644
--- a/java/org/apache/tomcat/util/descriptor/web/WebRuleSet.java
+++ b/java/org/apache/tomcat/util/descriptor/web/WebRuleSet.java
@@ -195,9 +195,11 @@ public class WebRuleSet extends RuleSetBase {
             digester.addCallMethod(fullPrefix + "/absolute-ordering/others",
                                    "addAbsoluteOrderingOthers");
             digester.addRule(fullPrefix + "/deny-uncovered-http-methods",
-                    new SetDenyUncoveredHttpMethodsRule());
-            digester.addCallMethod(fullPrefix + "/request-encoding", "setRequestEncoding", 0);
-            digester.addCallMethod(fullPrefix + "/response-encoding", "setResponseEncoding", 0);
+                             new SetDenyUncoveredHttpMethodsRule());
+            digester.addCallMethod(fullPrefix + "/request-character-encoding",
+                                   "setRequestCharacterEncoding", 0);
+            digester.addCallMethod(fullPrefix + "/response-character-encoding",
+                                   "setResponseCharacterEncoding", 0);
         }
 
         digester.addCallMethod(fullPrefix + "/context-param",

==================================================
