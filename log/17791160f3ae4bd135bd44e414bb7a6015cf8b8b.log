17791160f3ae4bd135bd44e414bb7a6015cf8b8b
==================================================
Add a (currently unused) Vary header parser and associated test case.
==================================================
Mark Thomas
==================================================
Fri Jul 6 10:39:44 2018 +0000
==================================================
Vary.java
Add a (currently unused) Vary header parser and associated test case.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1835229 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestVary.java
new file mode 100644
index 0000000000..9522e0174e
--- /dev/null
+++ b/java/org/apache/tomcat/util/http/parser/Vary.java
@@ -0,0 +1,61 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.tomcat.util.http.parser;
+
+import java.io.IOException;
+import java.io.StringReader;
+import java.util.Locale;
+import java.util.Set;
+
+public class Vary {
+
+    private Vary() {
+        // Utility class. Hide default constructor.
+    }
+
+
+    public static void parseVary(StringReader input, Set<String> result) throws IOException {
+
+        do {
+            String fieldName = HttpParser.readToken(input);
+            if (fieldName == null) {
+                // Invalid field-name, skip to the next one
+                HttpParser.skipUntil(input, 0, ',');
+                continue;
+            }
+
+            if (fieldName.length() == 0) {
+                // No more data to read
+                break;
+            }
+
+            int c = HttpParser.skipLws(input);
+            if (c == -1) {
+                // EOF
+                result.add(fieldName.toLowerCase(Locale.ENGLISH));
+                break;
+            } else if (c == ',') {
+                result.add(fieldName.toLowerCase(Locale.ENGLISH));
+                continue;
+            } else {
+                // Not a token - ignore it
+                HttpParser.skipUntil(input, 0, ',');
+                continue;
+            }
+        } while (true);
+    }
+}

==================================================
