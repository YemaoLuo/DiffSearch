a2253227b3700cbcc042a46c474e4b16ba2a2ad5
==================================================
Don't create a session, if none is needed when using PersistentValve.
==================================================
Felix Schumacher
==================================================
Wed Feb 25 21:14:49 2015 +0000
==================================================
PersistentValve.java
Don't create a session, if none is needed when using PersistentValve.

Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=57637


git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1662308 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestPersistentManager.java
index c15d6f3ebf..885220604e 100644
--- a/java/org/apache/catalina/valves/PersistentValve.java
+++ b/java/org/apache/catalina/valves/PersistentValve.java
@@ -128,7 +128,7 @@ public class PersistentValve extends ValveBase {
             // HttpSession hsess = hreq.getSession(false);
             Session hsess;
             try {
-                hsess = request.getSessionInternal();
+                hsess = request.getSessionInternal(false);
             } catch (Exception ex) {
                 hsess = null;
             }

==================================================
