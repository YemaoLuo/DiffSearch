3c380ba0d23004a5d52a3efc47c633e99a9b4134
==================================================
Fix some more unit test failures triggered by WebSocket init changes.
==================================================
Mark Emlyn
==================================================
Thu Apr 25 14:51:17 2013 +0000
==================================================
TestDefaultServlet.java
Fix some more unit test failures triggered by WebSocket init changes.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1475807 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestWebdavServlet.java
index 225100c6f4..1b07a3fe29 100644
--- a/test/org/apache/catalina/servlets/TestDefaultServlet.java
+++ b/test/org/apache/catalina/servlets/TestDefaultServlet.java
@@ -43,6 +43,7 @@ import org.apache.catalina.startup.SimpleHttpClient;
 import org.apache.catalina.startup.Tomcat;
 import org.apache.catalina.startup.TomcatBaseTest;
 import org.apache.tomcat.util.buf.ByteChunk;
+import org.apache.tomcat.websocket.server.WsListener;
 
 public class TestDefaultServlet extends TomcatBaseTest {
 
@@ -100,6 +101,7 @@ public class TestDefaultServlet extends TomcatBaseTest {
         // app dir is relative to server home
         org.apache.catalina.Context ctx =
             tomcat.addWebapp(null, "/examples", appDir.getAbsolutePath());
+        ctx.addApplicationListener(WsListener.class.getName());
 
         // Override the default servlet with our own mappings
         Tomcat.addServlet(ctx, "default2", new DefaultServlet());

==================================================
