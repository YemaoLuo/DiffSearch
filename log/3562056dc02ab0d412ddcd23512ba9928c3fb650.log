3562056dc02ab0d412ddcd23512ba9928c3fb650
==================================================
Unwrap InvocationTargetException if it is caught in ResultSetProxy,
==================================================
Konstantin Kolinko
==================================================
Mon Nov 14 00:44:07 2011 +0000
==================================================
AbstractQueryReport.java
Unwrap InvocationTargetException if it is caught in ResultSetProxy,
like we do it elsewhere.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1201562 13f79535-47bb-0310-9956-ffa450edef68



==================================================
StatementDecoratorInterceptor.java
index 6f732ea5b9..6c2d489edb 100644
--- a/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractQueryReport.java
+++ b/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractQueryReport.java
@@ -235,8 +235,9 @@ public abstract class AbstractQueryReport extends AbstractCreateStatementInterce
                 result =  method.invoke(delegate,args);
             }catch (Throwable t) {
                 reportFailedQuery(query,args,name,start,t);
-                if (t instanceof InvocationTargetException) {
-                    throw t.getCause() != null ? t.getCause() : t;
+                if (t instanceof InvocationTargetException
+                        && t.getCause() != null) {
+                    throw t.getCause();
                 } else {
                     throw t;
                 }

==================================================
