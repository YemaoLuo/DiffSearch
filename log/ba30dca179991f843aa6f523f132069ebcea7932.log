ba30dca179991f843aa6f523f132069ebcea7932
==================================================
- Fix problem with blocking reads for keepalive when using an executor (the number of busy threads is always 0).
==================================================
Remy Maucherat
==================================================
Thu Mar 22 12:58:07 2007 +0000
==================================================
AjpAprProcessor.java
- Fix problem with blocking reads for keepalive when using an executor (the number of busy threads is always 0).

git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@521246 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11AprProcessor.java
index 693d656284..a9659ee8bb 100644
--- a/java/org/apache/coyote/ajp/AjpAprProcessor.java
+++ b/java/org/apache/coyote/ajp/AjpAprProcessor.java
@@ -385,7 +385,7 @@ public class AjpAprProcessor implements ActionHook {
             try {
                 // Get first message of the request
                 if (!readMessage(requestHeaderMessage, true,
-                        keptAlive && (endpoint.getCurrentThreadsBusy() > limit))) {
+                        keptAlive && (endpoint.getCurrentThreadsBusy() >= limit))) {
                     // This means that no data is available right now
                     // (long keepalive), so that the processor should be recycled
                     // and the method should return true

==================================================
