1ed8c3e8f70009a5700a416da88c4c81575eda14
==================================================
Next JSP version will be 4.0
==================================================
Mark Thomas
==================================================
Wed Oct 19 11:47:02 2022 +0100
==================================================
CoyoteAdapter.java
index e49889674e..d2dda8f60d 100644
--- a/build.xml
+++ b/build.xml
@@ -59,8 +59,8 @@
   <!-- Exact spec versions (for the manifests etc.) -->
   <property name="servlet.spec.version"    value="6.0" />
   <property name="servlet.revision"        value="" />
-  <property name="jsp.spec.version"        value="3.1" />
-  <property name="jsp.revision"            value="" />
+  <property name="jsp.spec.version"        value="4.0" />
+  <property name="jsp.revision"            value="-SNAPSHOT" />
   <property name="el.spec.version"         value="5.0" />
   <property name="el.revision"             value="" />
   <property name="websocket.spec.version"  value="2.1" />

==================================================
Constants.java
index 79cff350f0..2d421430fd 100644
--- a/java/org/apache/catalina/connector/CoyoteAdapter.java
+++ b/java/org/apache/catalina/connector/CoyoteAdapter.java
@@ -68,7 +68,7 @@ public class CoyoteAdapter implements Adapter {
 
     // -------------------------------------------------------------- Constants
 
-    private static final String POWERED_BY = "Servlet/6.0 JSP/3.1 " +
+    private static final String POWERED_BY = "Servlet/6.0 JSP/4.0 " +
             "(" + ServerInfo.getServerInfo() + " Java/" +
             System.getProperty("java.vm.vendor") + "/" +
             System.getProperty("java.runtime.version") + ")";

==================================================
Generator.java
index ec17ceadb3..7a5f736e8c 100644
--- a/java/org/apache/jasper/Constants.java
+++ b/java/org/apache/jasper/Constants.java
@@ -30,7 +30,7 @@ import java.util.List;
  */
 public class Constants {
 
-    public static final String SPEC_VERSION = "3.1";
+    public static final String SPEC_VERSION = "4.0";
 
     /**
      * These classes/packages are automatically imported by the

==================================================
Validator.java
index 41c8feb67a..af6f9fc1af 100644
--- a/java/org/apache/jasper/compiler/Generator.java
+++ b/java/org/apache/jasper/compiler/Generator.java
@@ -833,7 +833,7 @@ class Generator {
         out.println(");");
 
         if (ctxt.getOptions().isXpoweredBy()) {
-            out.printil("response.addHeader(\"X-Powered-By\", \"JSP/3.1\");");
+            out.printil("response.addHeader(\"X-Powered-By\", \"JSP/4.0\");");
         }
 
         out.printil("pageContext = _jspxFactory.getPageContext(this, request, response,");

==================================================
