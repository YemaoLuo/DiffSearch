68ac99f6fc8cb62624111ec91be638f4d3d5f85f
==================================================
Refactor to enabling reloading rather than redploying of a context when a WAR file changes and there is an XML file present in the Host's configBase. In this scenario, the context object doesn't need to be re-created because it's config won't change - it is defined by the unchanged XML file in the HOst's configBase.
==================================================
Mark Emlyn
==================================================
Thu May 16 20:39:46 2013 +0000
==================================================
ContextConfig.java
Refactor to enabling reloading rather than redploying of a context when a WAR file changes and there is an XML file present in the Host's configBase. In this scenario, the context object doesn't need to be re-created because it's config won't change - it is defined by the unchanged XML file in the HOst's configBase.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1483552 13f79535-47bb-0310-9956-ffa450edef68



==================================================
HostConfig.java
index 734e96adfc..cee18cc384 100644
--- a/java/org/apache/catalina/startup/ContextConfig.java
+++ b/java/org/apache/catalina/startup/ContextConfig.java
@@ -775,14 +775,6 @@ public class ContextConfig implements LifecycleListener {
 
         createWebXmlDigester(context.getXmlNamespaceAware(),
                 context.getXmlValidation());
-
-        try {
-            fixDocBase();
-        } catch (IOException e) {
-            log.error(sm.getString(
-                    "contextConfig.fixDocBase", context.getName()), e);
-        }
-
     }
 
 
@@ -791,8 +783,14 @@ public class ContextConfig implements LifecycleListener {
      */
     protected synchronized void beforeStart() {
 
-        antiLocking();
+        try {
+            fixDocBase();
+        } catch (IOException e) {
+            log.error(sm.getString(
+                    "contextConfig.fixDocBase", context.getName()), e);
+        }
 
+        antiLocking();
     }
 
 

==================================================
