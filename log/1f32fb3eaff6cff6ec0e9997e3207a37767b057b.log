1f32fb3eaff6cff6ec0e9997e3207a37767b057b
==================================================
Fix NPEs with not found TLDs.
==================================================
Remy Maucherat
==================================================
Mon May 9 15:45:09 2016 +0000
==================================================
TagLibraryInfoImpl.java
Fix NPEs with not found TLDs.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1742984 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TldCache.java
index c6d18866cd..48bd789db1 100644
--- a/java/org/apache/jasper/compiler/TagLibraryInfoImpl.java
+++ b/java/org/apache/jasper/compiler/TagLibraryInfoImpl.java
@@ -172,8 +172,16 @@ class TagLibraryInfoImpl extends TagLibraryInfo implements TagConstants {
             }
 
             // Get the representation of the TLD
+            System.out.println("tldResourcePath: " + tldResourcePath.getUrl());
+            if (tldResourcePath.getUrl() == null) {
+                err.jspError("jsp.error.tld.missing", prefix, uri);
+            }
             TaglibXml taglibXml =
                     ctxt.getOptions().getTldCache().getTaglibXml(tldResourcePath);
+            System.out.println("taglibXml: " + taglibXml);
+            if (taglibXml == null) {
+                err.jspError("jsp.error.tld.missing", prefix, uri);
+            }
 
             // Populate the TagLibraryInfo attributes
             this.jspversion = taglibXml.getJspVersion();

==================================================
