46891de6d7416af596a49cdebdef92d072ef16ff
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60627
==================================================
Mark Thomas
==================================================
Fri Jan 27 20:14:21 2017 +0000
==================================================
Cookie.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60627
Modify the Rfc6265CookieProcessor so that in addition to cookie headers that start with an explicit RFC 2109 $Version=1, cookies that start with $Version=0 are also parsed as RFC 2109 cookies.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1780606 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookieParsing.java
index fc001924f7..ec6e4c9aa3 100644
--- a/java/org/apache/tomcat/util/http/parser/Cookie.java
+++ b/java/org/apache/tomcat/util/http/parser/Cookie.java
@@ -138,8 +138,10 @@ public class Cookie {
 
         ByteBuffer value = readCookieValue(bb);
         if (value != null && value.remaining() == 1) {
-            if (value.get() == (byte) 49) {
+            byte version = value.get();
+            if (version == (byte) 49 || version == (byte) 48) {
                 // $Version=1 -> RFC2109
+                // $Version=0 -> RFC2109
                 skipLWS(bb);
                 byte b = bb.get();
                 if (b == SEMICOLON_BYTE || b == COMMA_BYTE) {

==================================================
