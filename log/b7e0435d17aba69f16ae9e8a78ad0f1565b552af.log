b7e0435d17aba69f16ae9e8a78ad0f1565b552af
==================================================
Partial fix for CVE-2017-12617
==================================================
Mark Thomas
==================================================
Wed Sep 20 12:52:47 2017 +0000
==================================================
DirResourceSet.java
Partial fix for CVE-2017-12617
This ensures that a path specified for creation of a file does not end in '/' since that is dropped by the File API.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1809025 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AbstractTestResourceSet.java
index e5b708dd2d..234dc74ecf 100644
--- a/java/org/apache/catalina/webresources/DirResourceSet.java
+++ b/java/org/apache/catalina/webresources/DirResourceSet.java
@@ -217,6 +217,12 @@ public class DirResourceSet extends AbstractFileResourceSet {
             return false;
         }
 
+        // write() is meant to create a file so ensure that the path doesn't
+        // end in '/'
+        if (path.endsWith("/")) {
+            return false;
+        }
+
         File dest = null;
         String webAppMount = getWebAppMount();
         if (path.startsWith(webAppMount)) {

==================================================
