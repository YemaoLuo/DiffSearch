08dabbd516c7ced43ba5e177942cf82571fd3042
==================================================
Refactored r1842657 to use o.a.t.util.compat.JrePlatform per feedback
==================================================
Igal Sapir
==================================================
Tue Oct 2 22:25:37 2018 +0000
==================================================
TomcatBaseTest.java
Refactored r1842657 to use o.a.t.util.compat.JrePlatform per feedback

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1842664 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestAbstractArchiveResource.java
index 4a4afebd02..0fd2286277 100644
--- a/test/org/apache/catalina/startup/TomcatBaseTest.java
+++ b/test/org/apache/catalina/startup/TomcatBaseTest.java
@@ -88,7 +88,6 @@ public abstract class TomcatBaseTest extends LoggingBaseTest {
     protected static final int DEFAULT_CLIENT_TIMEOUT_MS = 300_000;
 
     public static final String TEMP_DIR = System.getProperty("java.io.tmpdir");
-    public static final String OS_NAME = System.getProperty("os.name");
 
     /**
      * Make the Tomcat instance available to sub-classes.
@@ -149,13 +148,6 @@ public abstract class TomcatBaseTest extends LoggingBaseTest {
         return accessLogEnabled;
     }
 
-    /*
-     * Sub-classes may need to test differently on Windows, e.g. case-insensitive file paths
-     */
-    public boolean isWindows() {
-        return OS_NAME.startsWith("Windows");
-    }
-
     @Before
     @Override
     public void setUp() throws Exception {

==================================================
TestFileResource.java
index c4fcb4c0b5..ae9aac7f80 100644
--- a/test/org/apache/catalina/webresources/TestAbstractArchiveResource.java
+++ b/test/org/apache/catalina/webresources/TestAbstractArchiveResource.java
@@ -18,6 +18,7 @@ package org.apache.catalina.webresources;
 
 import java.io.File;
 
+import org.apache.tomcat.util.compat.JrePlatform;
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -51,7 +52,7 @@ public class TestAbstractArchiveResource extends TomcatBaseTest {
         String expected = expectedURL.toString();
         String actual = webResource.getURL().toString();
 
-        if (isWindows()){
+        if (JrePlatform.IS_WINDOWS){
             expected = expected.toLowerCase();
             actual = actual.toLowerCase();
         }
@@ -82,7 +83,7 @@ public class TestAbstractArchiveResource extends TomcatBaseTest {
         String expected = expectedURL.toString();
         String actual = webResource.getURL().toString();
 
-        if (isWindows()){
+        if (JrePlatform.IS_WINDOWS){
             expected = expected.toLowerCase();
             actual = actual.toLowerCase();
         }

==================================================
Http2TestBase.java
index aa90339198..69d8011170 100644
--- a/test/org/apache/catalina/webresources/TestFileResource.java
+++ b/test/org/apache/catalina/webresources/TestFileResource.java
@@ -20,6 +20,7 @@ import java.io.File;
 
 import javax.servlet.http.HttpServletResponse;
 
+import org.apache.tomcat.util.compat.JrePlatform;
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -44,7 +45,7 @@ public class TestFileResource extends TomcatBaseTest {
         String expected = f.toURI().toURL().toString();
         String actual = out.toString().trim();
 
-        if (isWindows()){
+        if (JrePlatform.IS_WINDOWS){
             expected = expected.toLowerCase();
             actual = actual.toLowerCase();
         }

==================================================
