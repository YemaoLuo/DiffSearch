9406b8501abd6caf507f10aecbcdcc2fca110f81
==================================================
First pass at deprecation in org.apache.tomcat.jni
==================================================
Mark Thomas
==================================================
Tue Dec 1 12:56:46 2020 +0000
==================================================
Address.java
First pass at deprecation in org.apache.tomcat.jni

The intention is to deprecate everything that is not used by the
NIO/NIO2 OpenSSL support. There may still be individual methods within
the remaining classes that are not used.


==================================================
Directory.java
index 231036778c..cabaabc565 100644
--- a/java/org/apache/tomcat/jni/Address.java
+++ b/java/org/apache/tomcat/jni/Address.java
@@ -19,7 +19,12 @@ package org.apache.tomcat.jni;
 /** Address
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Address {
 
     public static final String APR_ANYADDR = "0.0.0.0";

==================================================
File.java
index 8a94972af8..8eb60876c5 100644
--- a/java/org/apache/tomcat/jni/Directory.java
+++ b/java/org/apache/tomcat/jni/Directory.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Directory
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Directory {
 
     /**

==================================================
FileInfo.java
index 4ae5523175..9128b6203b 100644
--- a/java/org/apache/tomcat/jni/File.java
+++ b/java/org/apache/tomcat/jni/File.java
@@ -22,7 +22,12 @@ import java.nio.ByteBuffer;
 /** File
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class File {
 
     /** Open the file for reading */

==================================================
Global.java
index 9fb6bd3db4..9eeba1a79d 100644
--- a/java/org/apache/tomcat/jni/FileInfo.java
+++ b/java/org/apache/tomcat/jni/FileInfo.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Fileinfo
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class FileInfo {
 
     /** Allocates memory and closes lingering handles in the specified pool */

==================================================
Local.java
index c1d1eb5215..2a84f6b9a3 100644
--- a/java/org/apache/tomcat/jni/Global.java
+++ b/java/org/apache/tomcat/jni/Global.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Global
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Global {
 
     /**

==================================================
Lock.java
index 50ed955679..70eb500783 100644
--- a/java/org/apache/tomcat/jni/Local.java
+++ b/java/org/apache/tomcat/jni/Local.java
@@ -21,7 +21,12 @@ package org.apache.tomcat.jni;
  * Local socket.
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Local {
 
     /**

==================================================
Mmap.java
index 6bb789ada9..9e6c0fe9b5 100644
--- a/java/org/apache/tomcat/jni/Lock.java
+++ b/java/org/apache/tomcat/jni/Lock.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Lock
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Lock {
 
     /**

==================================================
Multicast.java
index 08bc795688..b571be0c81 100644
--- a/java/org/apache/tomcat/jni/Mmap.java
+++ b/java/org/apache/tomcat/jni/Mmap.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Mmap
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Mmap {
     /** MMap opened for reading */
     public static final int APR_MMAP_READ  = 1;

==================================================
OS.java
index 44d123bcba..315f1b6ff3 100644
--- a/java/org/apache/tomcat/jni/Multicast.java
+++ b/java/org/apache/tomcat/jni/Multicast.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Multicast
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Multicast {
 
     /**

==================================================
Poll.java
index c93a07bc79..eaa6fafc06 100644
--- a/java/org/apache/tomcat/jni/OS.java
+++ b/java/org/apache/tomcat/jni/OS.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** OS
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class OS {
 
     /* OS Enums */

==================================================
PoolCallback.java
index 112d02eb64..0aa5c54ec2 100644
--- a/java/org/apache/tomcat/jni/Poll.java
+++ b/java/org/apache/tomcat/jni/Poll.java
@@ -19,7 +19,12 @@ package org.apache.tomcat.jni;
 /** Poll
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Poll {
 
     /**

==================================================
Proc.java
index 5075a3e572..4a2b3a04d9 100644
--- a/java/org/apache/tomcat/jni/PoolCallback.java
+++ b/java/org/apache/tomcat/jni/PoolCallback.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** PoolCallback Interface
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public interface PoolCallback {
 
     /**

==================================================
ProcErrorCallback.java
index cbae420d3c..44c0ab7dee 100644
--- a/java/org/apache/tomcat/jni/Proc.java
+++ b/java/org/apache/tomcat/jni/Proc.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Proc
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Proc {
 
     /*

==================================================
Procattr.java
index 60f53c8d4e..a993a9acf2 100644
--- a/java/org/apache/tomcat/jni/ProcErrorCallback.java
+++ b/java/org/apache/tomcat/jni/ProcErrorCallback.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** ProcErrorCallback Interface
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public interface ProcErrorCallback {
 
     /**

==================================================
Registry.java
index 88e97c6d5b..d335063a17 100644
--- a/java/org/apache/tomcat/jni/Procattr.java
+++ b/java/org/apache/tomcat/jni/Procattr.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Procattr
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Procattr {
 
     /**

==================================================
SSLSocket.java
index 209e02fec6..959e23ff1e 100644
--- a/java/org/apache/tomcat/jni/Registry.java
+++ b/java/org/apache/tomcat/jni/Registry.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Windows Registry support
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Registry {
 
     /* Registry Enums */

==================================================
Shm.java
index 2cc42f7718..e8b221d0ae 100644
--- a/java/org/apache/tomcat/jni/SSLSocket.java
+++ b/java/org/apache/tomcat/jni/SSLSocket.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** SSL Socket
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class SSLSocket {
 
     /**

==================================================
Sockaddr.java
index 43c662ce00..bdf322ca26 100644
--- a/java/org/apache/tomcat/jni/Shm.java
+++ b/java/org/apache/tomcat/jni/Shm.java
@@ -22,7 +22,12 @@ import java.nio.ByteBuffer;
 /** Shm
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Shm {
 
     /**

==================================================
Socket.java
index f5262a7d20..8e2ff600c3 100644
--- a/java/org/apache/tomcat/jni/Sockaddr.java
+++ b/java/org/apache/tomcat/jni/Sockaddr.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Sockaddr
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Sockaddr {
 
    /** The pool to use... */

==================================================
Status.java
index 976dd38bc9..c02a843954 100644
--- a/java/org/apache/tomcat/jni/Socket.java
+++ b/java/org/apache/tomcat/jni/Socket.java
@@ -23,7 +23,12 @@ import java.nio.ByteBuffer;
 /** Socket
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Socket {
 
     /* Standard socket defines */

==================================================
Stdlib.java
index 56d94454e5..0440e80d27 100644
--- a/java/org/apache/tomcat/jni/Status.java
+++ b/java/org/apache/tomcat/jni/Status.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Status
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Status {
 
     /**

==================================================
Thread.java
index b2fa63034c..e5a0412a86 100644
--- a/java/org/apache/tomcat/jni/Stdlib.java
+++ b/java/org/apache/tomcat/jni/Stdlib.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Stdlib
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Stdlib {
 
     /**

==================================================
Time.java
index 7435bf3636..0fb961bb02 100644
--- a/java/org/apache/tomcat/jni/Thread.java
+++ b/java/org/apache/tomcat/jni/Thread.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Thread
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Thread {
 
     /**

==================================================
User.java
index 22aeb25fa9..7796d4ec2d 100644
--- a/java/org/apache/tomcat/jni/Time.java
+++ b/java/org/apache/tomcat/jni/Time.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** Time
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class Time {
 
     /** number of microseconds per second */

==================================================
TestFile.java
index 20bb7628e6..7177eccd70 100644
--- a/java/org/apache/tomcat/jni/User.java
+++ b/java/org/apache/tomcat/jni/User.java
@@ -20,7 +20,12 @@ package org.apache.tomcat.jni;
 /** User
  *
  * @author Mladen Turk
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class User {
 
     /**

==================================================
TestSocketServer.java
index 433939f226..95bb10f463 100644
--- a/test/org/apache/tomcat/jni/TestFile.java
+++ b/test/org/apache/tomcat/jni/TestFile.java
@@ -19,7 +19,12 @@ package org.apache.tomcat.jni;
 import org.junit.Assert;
 import org.junit.Test;
 
-
+/*
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
+ */
+@Deprecated
 public class TestFile extends AbstractJniTest {
 
     @Test

==================================================
TestSocketServerAnyLocalAddress.java
index 059add30fb..1a6d4d6ada 100644
--- a/test/org/apache/tomcat/jni/TestSocketServer.java
+++ b/test/org/apache/tomcat/jni/TestSocketServer.java
@@ -34,7 +34,12 @@ import org.junit.Test;
  * It is known that this larger error margin is required for Windows 10. It may
  * be worth revisiting the choice of error margin once that platform is no
  * longer supported.
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class TestSocketServer extends AbstractJniTest {
 
     private static final String HOST = "localhost";

==================================================
TestXxxEndpoint.java
index c983608fbe..8739a1953a 100644
--- a/test/org/apache/tomcat/jni/TestSocketServerAnyLocalAddress.java
+++ b/test/org/apache/tomcat/jni/TestSocketServerAnyLocalAddress.java
@@ -30,7 +30,12 @@ import org.junit.Test;
 
 /**
  * Tests for server-side sockets using any local address (0.0.0.0 or ::).
+ *
+ * @deprecated  The scope of the APR/Native Library will be reduced in Tomcat
+ *              10.1.x onwards to only those components required to provide
+ *              OpenSSL integration with the NIO and NIO2 connectors.
  */
+@Deprecated
 public class TestSocketServerAnyLocalAddress extends AbstractJniTest {
 
     // Excessive but allows for slow systems

==================================================
