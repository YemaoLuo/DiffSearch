7665e65ca3aac5706242613d15cfbe8655d67be6
==================================================
SpotBugs: Make inner classes static where possible
==================================================
Mark Thomas
==================================================
Tue May 22 18:54:04 2018 +0000
==================================================
Http2AsyncUpgradeHandler.java
SpotBugs: Make inner classes static where possible

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1832055 13f79535-47bb-0310-9956-ffa450edef68



==================================================
StatementDecoratorInterceptor.java
index dc0380ac71..ba49986b5b 100644
--- a/java/org/apache/coyote/http2/Http2AsyncUpgradeHandler.java
+++ b/java/org/apache/coyote/http2/Http2AsyncUpgradeHandler.java
@@ -418,7 +418,7 @@ public class Http2AsyncUpgradeHandler extends Http2UpgradeHandler {
     }
 
 
-    private class AsyncHeaderFrameBuffers implements HeaderFrameBuffers {
+    private static class AsyncHeaderFrameBuffers implements HeaderFrameBuffers {
 
         int payloadSize;
 

==================================================
TestSlowQueryReport.java
index 3066ef2fe7..bc2b95dba7 100644
--- a/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/StatementDecoratorInterceptor.java
+++ b/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/StatementDecoratorInterceptor.java
@@ -267,7 +267,7 @@ public class StatementDecoratorInterceptor extends AbstractCreateStatementInterc
         }
     }
 
-    protected class ResultSetProxy implements InvocationHandler {
+    protected static class ResultSetProxy implements InvocationHandler {
 
         private Object st;
         private Object delegate;

==================================================
TestBasicAuthParser.java
index 6a5c89b7e5..411511f314 100644
--- a/modules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java
+++ b/modules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java
@@ -197,7 +197,7 @@ public class TestSlowQueryReport extends DefaultTestCase {
     }
 
 
-    public class ClientListener implements NotificationListener {
+    public static class ClientListener implements NotificationListener {
         AtomicInteger notificationCount = new AtomicInteger(0);
         @Override
         public void handleNotification(Notification notification,

==================================================
TestRequest.java
index 9b542e973c..be6d2b0f19 100644
--- a/test/org/apache/catalina/authenticator/TestBasicAuthParser.java
+++ b/test/org/apache/catalina/authenticator/TestBasicAuthParser.java
@@ -463,7 +463,7 @@ public class TestBasicAuthParser {
      * for BASIC Authentication.
      * Note: only used internally, so no need to validate arguments.
      */
-    private final class BasicAuthHeader {
+    private static final class BasicAuthHeader {
 
         private  final String HTTP_AUTH = "authorization: ";
         private  final byte[] HEADER =

==================================================
TestDefaultInstanceManager.java
index 52935aa126..52049942ba 100644
--- a/test/org/apache/catalina/connector/TestRequest.java
+++ b/test/org/apache/catalina/connector/TestRequest.java
@@ -845,7 +845,7 @@ public class TestRequest extends TomcatBaseTest {
         Assert.assertEquals(expected, resultPath);
     }
 
-    private class Bug56501Servlet extends HttpServlet {
+    private static class Bug56501Servlet extends HttpServlet {
 
         private static final long serialVersionUID = 1L;
 
@@ -957,7 +957,7 @@ public class TestRequest extends TomcatBaseTest {
     }
 
 
-    private class Bug61264GetReaderServlet extends HttpServlet {
+    private static class Bug61264GetReaderServlet extends HttpServlet {
 
         private static final long serialVersionUID = 1L;
 

==================================================
TestStandardContext.java
index d8d728915e..f2b1ec5830 100644
--- a/test/org/apache/catalina/core/TestDefaultInstanceManager.java
+++ b/test/org/apache/catalina/core/TestDefaultInstanceManager.java
@@ -139,7 +139,7 @@ public class TestDefaultInstanceManager extends TomcatBaseTest {
     }
 
 
-    private class InstanceManagerRunnable implements Runnable {
+    private static class InstanceManagerRunnable implements Runnable {
 
         private final InstanceManager im;
 

==================================================
TestWebappClassLoaderExecutorMemoryLeak.java
index 28f5c5ad1a..60f98519ad 100644
--- a/test/org/apache/catalina/core/TestStandardContext.java
+++ b/test/org/apache/catalina/core/TestStandardContext.java
@@ -899,7 +899,7 @@ public class TestStandardContext extends TomcatBaseTest {
                 .isAvailable());
     }
 
-    private class FailingStartupServlet extends HttpServlet {
+    private static class FailingStartupServlet extends HttpServlet {
 
         private static final long serialVersionUID = 1L;
 

==================================================
TestStuckThreadDetectionValve.java
index 2fc7b0ad93..5f8e22b28b 100644
--- a/test/org/apache/catalina/loader/TestWebappClassLoaderExecutorMemoryLeak.java
+++ b/test/org/apache/catalina/loader/TestWebappClassLoaderExecutorMemoryLeak.java
@@ -104,7 +104,7 @@ public class TestWebappClassLoaderExecutorMemoryLeak extends TomcatBaseTest {
             resp.getWriter().flush();
         }
 
-        class Task implements Runnable {
+        static class Task implements Runnable {
 
             String _id;
 

==================================================
TestUpgrade.java
index 2cb3a66a6b..4e425c5ae8 100644
--- a/test/org/apache/catalina/valves/TestStuckThreadDetectionValve.java
+++ b/test/org/apache/catalina/valves/TestStuckThreadDetectionValve.java
@@ -139,7 +139,7 @@ public class TestStuckThreadDetectionValve extends TomcatBaseTest {
         Assert.assertTrue(result.toString().startsWith("OK"));
     }
 
-    private class StuckingServlet extends HttpServlet {
+    private static class StuckingServlet extends HttpServlet {
 
         private static final long serialVersionUID = 1L;
         private final long delay;

==================================================
TestOneLineFormatterPerformance.java
index 94729592a0..c5180d65d7 100644
--- a/test/org/apache/coyote/http11/upgrade/TestUpgrade.java
+++ b/test/org/apache/coyote/http11/upgrade/TestUpgrade.java
@@ -305,7 +305,7 @@ public class TestUpgrade extends TomcatBaseTest {
         }
 
 
-        private class EchoListener implements ReadListener, WriteListener {
+        private static class EchoListener implements ReadListener, WriteListener {
 
             private final ServletInputStream sis;
             private final ServletOutputStream sos;

==================================================
TestByteChunk.java
index 708d114409..a462c8c896 100644
--- a/test/org/apache/juli/TestOneLineFormatterPerformance.java
+++ b/test/org/apache/juli/TestOneLineFormatterPerformance.java
@@ -49,7 +49,7 @@ public class TestOneLineFormatterPerformance {
     }
 
 
-    private class StringFormatImpl implements DateFormat {
+    private static class StringFormatImpl implements DateFormat {
 
         @Override
         public String format(long timestamp) {
@@ -58,7 +58,7 @@ public class TestOneLineFormatterPerformance {
     }
 
 
-    private class DateFormatCacheImpl implements DateFormat {
+    private static class DateFormatCacheImpl implements DateFormat {
 
         private final DateFormatCache cache;
 

==================================================
TestCharChunk.java
index 49167f7a94..0299e891e1 100644
--- a/test/org/apache/tomcat/util/buf/TestByteChunk.java
+++ b/test/org/apache/tomcat/util/buf/TestByteChunk.java
@@ -189,7 +189,7 @@ public class TestByteChunk {
     }
 
 
-    public class Sink implements ByteOutputChannel {
+    public static class Sink implements ByteOutputChannel {
 
         @Override
         public void realWriteBytes(byte[] cbuf, int off, int len) throws IOException {

==================================================
TesterAsyncTiming.java
index 8a6f8e1144..b540ee8baf 100644
--- a/test/org/apache/tomcat/util/buf/TestCharChunk.java
+++ b/test/org/apache/tomcat/util/buf/TestCharChunk.java
@@ -86,7 +86,7 @@ public class TestCharChunk {
     }
 
 
-    public class Sink implements CharOutputChannel {
+    public static class Sink implements CharOutputChannel {
 
         @Override
         public void realWriteChars(char[] cbuf, int off, int len) throws IOException {

==================================================
TestCloseBug58624.java
index cdcdad591a..e9b7a3a593 100644
--- a/test/org/apache/tomcat/websocket/TesterAsyncTiming.java
+++ b/test/org/apache/tomcat/websocket/TesterAsyncTiming.java
@@ -70,7 +70,7 @@ public class TesterAsyncTiming {
             }
         }
 
-        private class SemaphoreSendHandler implements SendHandler {
+        private static class SemaphoreSendHandler implements SendHandler {
 
             private final Semaphore semaphore;
 

==================================================
Room.java
index 140f9a3339..f5a65997ad 100644
--- a/test/org/apache/tomcat/websocket/server/TestCloseBug58624.java
+++ b/test/org/apache/tomcat/websocket/server/TestCloseBug58624.java
@@ -89,7 +89,7 @@ public class TestCloseBug58624 extends WebSocketBaseTest {
     }
 
     @ClientEndpoint
-    public class Bug58624ClientEndpoint {
+    public static class Bug58624ClientEndpoint {
 
         private volatile Throwable t;
 

==================================================
