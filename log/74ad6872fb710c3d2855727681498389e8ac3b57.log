74ad6872fb710c3d2855727681498389e8ac3b57
==================================================
Servlet 4.0
==================================================
Mark Thomas
==================================================
Thu Oct 15 11:32:50 2015 +0000
==================================================
PushBuilder.java
Servlet 4.0
Complete PushBuilder interface
Still need to complete the push() implementation

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1708799 13f79535-47bb-0310-9956-ffa450edef68



==================================================
ApplicationPushBuilder.java
index f3479606ff..5753798fb8 100644
--- a/java/javax/servlet/http/PushBuilder.java
+++ b/java/javax/servlet/http/PushBuilder.java
@@ -41,6 +41,45 @@ public interface PushBuilder {
      */
     PushBuilder method(String method);
 
+    /**
+     * Specifies the query string to use in subsequent push requests generated
+     * by a call to {@link #push()}. This will be appended to any query string
+     * specified in the call to {@link #path(String)}.
+     *
+     * @param queryString The query string to use to generate push requests
+     *
+     * @return This builder instance
+     */
+    PushBuilder queryString(String queryString);
+
+    /**
+     * Specifies the session ID to use in subsequent push requests generated
+     * by a call to {@link #push()}. The session ID will be presented the same
+     * way as it is on the original request (cookie or URL parameter). The
+     * default is determined in the following order:
+     * <ul>
+     * <li>the requested session ID for the originating request</li>
+     * <li>the session ID generated in the originated request</li>
+     * <li>{@code null}</li>
+     * </ul>
+     *
+     * @param sessionId The session ID to use to generate push requests
+     *
+     * @return This builder instance
+     */
+    PushBuilder sessionId(String sessionId);
+
+    /**
+     * Sets if the request will be conditional. If {@code true} the values from
+     * {@link #getEtag()} and {@link #getLastModified()} will be used to
+     * construct appropriate headers.
+     *
+     * @param conditional Should generated push requests be conditional
+     *
+     * @return This builder instance
+     */
+    PushBuilder conditional(boolean conditional);
+
     /**
      * Sets a HTTP header on the request. Any existing headers of the same name
      * are first remove.
@@ -86,6 +125,28 @@ public interface PushBuilder {
      */
     PushBuilder path(String path);
 
+    /**
+     * Sets the etag to be used for conditional push requests. This will be
+     * set to {@code null} after a call to {@link #push()} so it must be
+     * explicitly set for every push request that requires it.
+     *
+     * @param etag The etag use for the push request
+     *
+     * @return This builder instance
+     */
+    PushBuilder etag(String etag);
+
+    /**
+     * Sets the last modified to be used for conditional push requests. This
+     * will be set to {@code null} after a call to {@link #push()} so it must be
+     * explicitly set for every push request that requires it.
+     *
+     * @param lastModified The last modified value to use for the push request
+     *
+     * @return This builder instance
+     */
+    PushBuilder lastModified(String lastModified);
+
     /**
      * Generates the push request. After calling this method the following
      * fields are set to {@code null}:
@@ -109,6 +170,30 @@ public interface PushBuilder {
      */
     String getMethod();
 
+    /**
+     * Obtain the query string that will be used for push requests generated by
+     * future calls to {@code push()}.
+     *
+     * @return The query string that will be appended to push requests.
+     */
+    String getQueryString();
+
+    /**
+     * Obtain the session ID that will be used for push requests generated by
+     * future calls to {@code push()}.
+     *
+     * @return The session that will be used for push requests.
+     */
+    String getSessionId();
+
+    /**
+     * Will push requests generated by future calls to {@code push()} be
+     * conditional.
+     *
+     * @return {@code true} if push requests will be conditional
+     */
+    boolean isConditional();
+
     /**
      * @return The current set of names of HTTP headers to be used the next time
      *         {@code push()} is called.
@@ -126,4 +211,29 @@ public interface PushBuilder {
      *         then any may be returned
      */
     String getHeader(String name);
+
+    /**
+     * Obtain the path that will be used for the push request that will be
+     * generated by the next call to {@code push()}.
+     *
+     * @return The path value that will be associated with the next push request
+     */
+    String getPath();
+
+    /**
+     * Obtain the etag that will be used for the push request that will be
+     * generated by the next call to {@code push()}.
+     *
+     * @return The etag value that will be associated with the next push request
+     */
+    String getEtag();
+
+    /**
+     * Obtain the last modified that will be used for the push request that will
+     * be generated by the next call to {@code push()}.
+     *
+     * @return The last modified value that will be associated with the next
+     *         push request
+     */
+    String getLastModified();
 }

==================================================
