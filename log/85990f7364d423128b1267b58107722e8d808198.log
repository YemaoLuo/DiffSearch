85990f7364d423128b1267b58107722e8d808198
==================================================
Move attribute getter/setter into CookieProcessorBase
==================================================
John Kelly
==================================================
Thu May 16 15:44:01 2019 +0100
==================================================
CookieProcessorBase.java
Move attribute getter/setter into CookieProcessorBase



==================================================
LegacyCookieProcessor.java
index dceb573ce2..3e723fa447 100644
--- a/java/org/apache/tomcat/util/http/CookieProcessorBase.java
+++ b/java/org/apache/tomcat/util/http/CookieProcessorBase.java
@@ -37,6 +37,16 @@ public abstract class CookieProcessorBase implements CookieProcessor {
         }
     };
 
+    private SameSiteCookies sameSiteCookies = SameSiteCookies.NONE;
+
+    public SameSiteCookies getSameSiteCookies() {
+        return sameSiteCookies;
+    }
+
+    public void setSameSiteCookies(String sameSiteCookies) {
+        this.sameSiteCookies = SameSiteCookies.toAttribute(sameSiteCookies);
+    }
+
     protected static final String ANCIENT_DATE;
 
     static {

==================================================
Rfc6265CookieProcessor.java
index f4b5f00089..324824dd8a 100644
--- a/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
+++ b/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
@@ -79,8 +79,6 @@ public final class LegacyCookieProcessor extends CookieProcessorBase {
 
     private final BitSet allowedWithoutQuotes = new BitSet(128);
 
-    private SameSiteCookies sameSiteCookies = SameSiteCookies.NONE;
-
     public LegacyCookieProcessor() {
         // BitSet elements will default to false
         for (char c : HTTP_SEPARATORS) {
@@ -196,16 +194,6 @@ public final class LegacyCookieProcessor extends CookieProcessorBase {
     }
 
 
-    public SameSiteCookies getSameSiteCookies() {
-        return sameSiteCookies;
-    }
-
-
-    public void setSameSiteCookies(String sameSiteCookies) {
-        this.sameSiteCookies = SameSiteCookies.toAttribute(sameSiteCookies);
-    }
-
-
     @Override
     public Charset getCharset() {
         return StandardCharsets.ISO_8859_1;
@@ -336,9 +324,11 @@ public final class LegacyCookieProcessor extends CookieProcessorBase {
             buf.append("; HttpOnly");
         }
 
-        if (!sameSiteCookies.equals(SameSiteCookies.NONE)) {
+        SameSiteCookies sameSiteCookiesValue = getSameSiteCookies();
+
+        if (!sameSiteCookiesValue.equals(SameSiteCookies.NONE)) {
             buf.append("; SameSite=");
-            buf.append(sameSiteCookies.toString());
+            buf.append(sameSiteCookiesValue.toString());
         }
 
         return buf.toString();

==================================================
