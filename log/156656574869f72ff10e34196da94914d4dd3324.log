156656574869f72ff10e34196da94914d4dd3324
==================================================
Make sure acceptor threads are stopped when the connector is stopped.
==================================================
Mark Emlyn
==================================================
Sun Sep 5 19:47:36 2010 +0000
==================================================
AprEndpoint.java
Make sure acceptor threads are stopped when the connector is stopped.
Also fix @Override warnings for the method

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@992881 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JIoEndpoint.java
index 7dcd07bd90..0ffa4daef9 100644
--- a/java/org/apache/tomcat/util/net/AprEndpoint.java
+++ b/java/org/apache/tomcat/util/net/AprEndpoint.java
@@ -918,6 +918,7 @@ public class AprEndpoint extends AbstractEndpoint {
          * The background thread that listens for incoming TCP/IP connections and
          * hands them off to an appropriate processor.
          */
+        @Override
         public void run() {
 
             // Loop until we receive a shutdown command

==================================================
NioEndpoint.java
index f40694728e..813b93399b 100644
--- a/java/org/apache/tomcat/util/net/JIoEndpoint.java
+++ b/java/org/apache/tomcat/util/net/JIoEndpoint.java
@@ -173,13 +173,14 @@ public class JIoEndpoint extends AbstractEndpoint {
          * The background thread that listens for incoming TCP/IP connections and
          * hands them off to an appropriate processor.
          */
+        @Override
         public void run() {
 
             // Loop until we receive a shutdown command
             while (running) {
 
                 // Loop if endpoint is paused
-                while (paused) {
+                while (paused && running) {
                     try {
                         Thread.sleep(1000);
                     } catch (InterruptedException e) {

==================================================
