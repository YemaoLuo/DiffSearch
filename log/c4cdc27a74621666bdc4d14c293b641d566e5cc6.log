c4cdc27a74621666bdc4d14c293b641d566e5cc6
==================================================
65135: Fix JMX decriptor issue
==================================================
remm remm@apache.org
==================================================
Fri Feb 12 14:40:06 2021 +0100
==================================================
Context.java
65135: Fix JMX decriptor issue

The use of "is" is unusual, so change that to "get", which turns out to
be less error prone.


==================================================
StandardContext.java
index 275063bb1f..ad40de5495 100644
--- a/java/org/apache/catalina/Context.java
+++ b/java/org/apache/catalina/Context.java
@@ -765,8 +765,18 @@ public interface Context extends Container, ContextBind {
     /**
      * @return the value of the parallel annotation scanning flag.  If true,
      * it will dispatch scanning to the utility executor.
+     * @deprecated This method will be removed in Tomcat 11 onwards
      */
-    public boolean isParallelAnnotationScanning();
+    @Deprecated
+    public default boolean isParallelAnnotationScanning() {
+        return getParallelAnnotationScanning();
+    }
+
+    /**
+     * @return the value of the parallel annotation scanning flag.  If true,
+     * it will dispatch scanning to the utility executor.
+     */
+    public boolean getParallelAnnotationScanning();
 
     /**
      * Set the parallel annotation scanning value.

==================================================
ContextConfig.java
index abb123f1c6..b48a284428 100644
--- a/java/org/apache/catalina/core/StandardContext.java
+++ b/java/org/apache/catalina/core/StandardContext.java
@@ -1480,7 +1480,7 @@ public class StandardContext extends ContainerBase
 
 
     @Override
-    public boolean isParallelAnnotationScanning() {
+    public boolean getParallelAnnotationScanning() {
         return this.parallelAnnotationScanning;
     }
 

==================================================
FailedContext.java
index 66b58a1f83..bc684993db 100644
--- a/java/org/apache/catalina/startup/ContextConfig.java
+++ b/java/org/apache/catalina/startup/ContextConfig.java
@@ -1379,7 +1379,7 @@ public class ContextConfig implements LifecycleListener {
 
         Map<String, JavaClassCacheEntry> javaClassCache;
 
-        if (context.isParallelAnnotationScanning()) {
+        if (context.getParallelAnnotationScanning()) {
             javaClassCache = new ConcurrentHashMap<>();
         } else {
             javaClassCache = new HashMap<>();
@@ -2144,7 +2144,7 @@ public class ContextConfig implements LifecycleListener {
     protected void processAnnotations(Set<WebXml> fragments,
             boolean handlesTypesOnly, Map<String, JavaClassCacheEntry> javaClassCache) {
 
-        if (context.isParallelAnnotationScanning()) {
+        if (context.getParallelAnnotationScanning()) {
             processAnnotationsInParallel(fragments, handlesTypesOnly, javaClassCache);
         } else {
             for (WebXml fragment : fragments) {

==================================================
TesterContext.java
index 4fee683521..e352ce28c7 100644
--- a/java/org/apache/catalina/startup/FailedContext.java
+++ b/java/org/apache/catalina/startup/FailedContext.java
@@ -832,7 +832,7 @@ public class FailedContext extends LifecycleMBeanBase implements Context {
     public void setDispatcherWrapsSameObject(boolean dispatcherWrapsSameObject) {}
 
     @Override
-    public boolean isParallelAnnotationScanning() { return false; }
+    public boolean getParallelAnnotationScanning() { return false; }
     @Override
     public void setParallelAnnotationScanning(boolean parallelAnnotationScanning) {}
 

==================================================
