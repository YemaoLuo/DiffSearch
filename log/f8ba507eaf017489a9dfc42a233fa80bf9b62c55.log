f8ba507eaf017489a9dfc42a233fa80bf9b62c55
==================================================
Fix regression in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 that broke stream messages.
==================================================
Mark Emlyn
==================================================
Tue Nov 26 11:29:54 2013 +0000
==================================================
WsRemoteEndpointImplBase.java
Fix regression in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 that broke stream messages.
Add a test case for stream messages.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1545619 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestWsRemoteEndpoint.java
index 37eaf94a93..3f0a7c33ba 100644
--- a/java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java
+++ b/java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java
@@ -835,7 +835,7 @@ public abstract class WsRemoteEndpointImplBase implements RemoteEndpoint {
 
         private void doWrite(boolean last) throws IOException {
             buffer.flip();
-            endpoint.sendPartialBytes(buffer, last);
+            endpoint.startMessageBlock(Constants.OPCODE_BINARY, buffer, last);
             buffer.clear();
         }
     }

==================================================
