12669b255b19d776dd95d0b2b75530c5b0774d90
==================================================
Don't duplicate storage of requiredSecret in the Processor
==================================================
Mark Thomas
==================================================
Wed Dec 14 11:06:18 2016 +0000
==================================================
AbstractAjpProtocol.java
Don't duplicate storage of requiredSecret in the Processor

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1774186 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AjpProcessor.java
index 2ef554deb2..d5e81fa6e8 100644
--- a/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
+++ b/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
@@ -139,13 +139,18 @@ public abstract class AbstractAjpProtocol<S> extends AbstractProtocol<S> {
     }
 
 
+    private String requiredSecret = null;
     /**
-     * Required secret.
+     * Set the required secret that must be included with every request.
+     *
+     * @param requiredSecret The required secret
      */
-    private String requiredSecret = null;
     public void setRequiredSecret(String requiredSecret) {
         this.requiredSecret = requiredSecret;
     }
+    protected String getRequiredSecret() {
+        return requiredSecret;
+    }
 
 
     /**
@@ -192,7 +197,6 @@ public abstract class AbstractAjpProtocol<S> extends AbstractProtocol<S> {
     protected Processor createProcessor() {
         AjpProcessor processor = new AjpProcessor(this);
         processor.setAdapter(getAdapter());
-        processor.setRequiredSecret(requiredSecret);
         processor.setKeepAliveTimeout(getKeepAliveTimeout());
         processor.setClientCertProvider(getClientCertProvider());
         return processor;

==================================================
