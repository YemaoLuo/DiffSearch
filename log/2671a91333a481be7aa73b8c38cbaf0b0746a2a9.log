2671a91333a481be7aa73b8c38cbaf0b0746a2a9
==================================================
Further improve MessageFactory number formatting fix.
==================================================
Konstantin Kolinko
==================================================
Fri Sep 9 13:57:42 2022 +0300
==================================================
MessageFactory.java
Further improve MessageFactory number formatting fix.

Handle the case when message patterns does not print all arguments. E.g. when a translation has not been updated.
In that case the array returned by getFormatsByArgumentIndex() call will be shorter than args array.



==================================================
TestMessageFactory.java
index e7b42d0898..2cc93621c5 100644
--- a/java/org/apache/el/util/MessageFactory.java
+++ b/java/org/apache/el/util/MessageFactory.java
@@ -68,7 +68,7 @@ public final class MessageFactory {
                     if (formats == null) {
                         formats = mf.getFormatsByArgumentIndex();
                     }
-                    if (!(formats[i] instanceof NumberFormat)) {
+                    if (i < formats.length && !(formats[i] instanceof NumberFormat)) {
                         args[i] = args[i].toString();
                     }
                 }

==================================================
