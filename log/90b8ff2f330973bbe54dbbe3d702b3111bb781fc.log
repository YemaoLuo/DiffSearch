90b8ff2f330973bbe54dbbe3d702b3111bb781fc
==================================================
64398: Change default value separator for property replacement
==================================================
remm remm@apache.org
==================================================
Thu Apr 30 16:37:52 2020 +0200
==================================================
IntrospectionUtils.java
64398: Change default value separator for property replacement

Due to conflicts, the syntax is now ${name:-default}.


==================================================
TestIntrospectionUtils.java
index aa2f40c2ef..eef89801e6 100644
--- a/java/org/apache/tomcat/util/IntrospectionUtils.java
+++ b/java/org/apache/tomcat/util/IntrospectionUtils.java
@@ -268,9 +268,9 @@ public final class IntrospectionUtils {
                 String v = getProperty(n, staticProp, dynamicProp, classLoader);
                 if (v == null) {
                     // {name:default}
-                    int col = n.indexOf(':');
+                    int col = n.indexOf(":-");
                     if (col != -1) {
-                        String dV = n.substring(col+1);
+                        String dV = n.substring(col + 2);
                         n = n.substring(0, col);
                         v = getProperty(n, staticProp, dynamicProp, classLoader);
                         if (v == null) {

==================================================
