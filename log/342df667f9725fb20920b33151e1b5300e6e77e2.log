342df667f9725fb20920b33151e1b5300e6e77e2
==================================================
Clean up debug logging
==================================================
Mark Emlyn
==================================================
Thu Jul 12 10:30:44 2012 +0000
==================================================
AprSocket.java
Clean up debug logging

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1360618 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AprSocketContext.java
index 4bdd6b7e94..c3dc052f63 100644
--- a/java/org/apache/tomcat/jni/socket/AprSocket.java
+++ b/java/org/apache/tomcat/jni/socket/AprSocket.java
@@ -56,9 +56,10 @@ import org.apache.tomcat.jni.socket.AprSocketContext.BlockingPollHandler;
  */
 public class AprSocket implements Runnable {
 
-    static final byte[][] NO_CERTS = new byte[0][];
+    private static final Logger log =
+            Logger.getLogger("org.apache.tomcat.jni.socket.AprSocket");
 
-    static Logger log = Logger.getLogger("AprSocket");
+    static final byte[][] NO_CERTS = new byte[0][];
 
     static int CONNECTING = 1;
     static int CONNECTED = 0x2;
@@ -280,7 +281,7 @@ public class AprSocket implements Runnable {
                 updatePolling();
                 return rt;
             }
-            if (context.debug) {
+            if (log.isLoggable(Level.WARNING)) {
                 log.warning("apr.send(): Failed to send, closing " + sent);
             }
             reset();
@@ -407,7 +408,7 @@ public class AprSocket implements Runnable {
             if (context.rawDataHandler != null) {
                 context.rawDataHandler.rawData(this, false, null, -1, -1, -1, true);
             }
-            if (context.debug) {
+            if (log.isLoggable(Level.FINE)) {
                 log.info("closing: context.open=" + context.open.get() + " " + this);
             }
 
@@ -725,7 +726,7 @@ public class AprSocket implements Runnable {
                 try {
                     context.open.incrementAndGet();
 
-                    if (context.debug) {
+                    if (log.isLoggable(Level.FINE)) {
                         log.info("Accept: " + context.open.get() + " " + this + " " +
                                 getRemotePort());
                     }
@@ -795,7 +796,7 @@ public class AprSocket implements Runnable {
         }
 
         try {
-            if (context.debug) {
+            if (log.isLoggable(Level.FINE)) {
                 log.info(this + " StartSSL");
             }
 
@@ -851,7 +852,7 @@ public class AprSocket implements Runnable {
             int ticketLen = SSLExt.getTicket(socket, hostInfo.ticket);
             if (ticketLen > 0) {
                 hostInfo.ticketLen = ticketLen;
-                if (context.debug) {
+                if (log.isLoggable(Level.FINE)) {
                     log.info("Received ticket: " + ticketLen);
                 }
             }

==================================================
