339ccb7a7afb4bd688546d367fe970aa439df03d
==================================================
Provide 100 Continue responses if required during FORM authentication
==================================================
Mark Emlyn
==================================================
Sun Aug 22 21:02:33 2010 +0000
==================================================
FormAuthenticator.java
Provide 100 Continue responses if required during FORM authentication
Side issues from investigating https://issues.apache.org/bugzilla/show_bug.cgi?id=49779

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@987948 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestFormAuthenticator.java
index 4b31f7f503..609adcb29c 100644
--- a/java/org/apache/catalina/authenticator/FormAuthenticator.java
+++ b/java/org/apache/catalina/authenticator/FormAuthenticator.java
@@ -246,8 +246,9 @@ public class FormAuthenticator
             return (false);
         }
 
-        // Yes -- Validate the specified credentials and redirect
-        // to the error page if they are not correct
+        // Yes -- Acknowledge the request, validate the specified credentials
+        // and redirect to the error page if they are not correct
+        request.getResponse().sendAcknowledgement();
         Realm realm = context.getRealm();
         if (characterEncoding != null) {
             request.setCharacterEncoding(characterEncoding);
@@ -511,6 +512,9 @@ public class FormAuthenticator
         }
 
         if ("POST".equalsIgnoreCase(request.getMethod())) {
+            // May need to acknowledge a 100-continue expectation
+            request.getResponse().sendAcknowledgement();
+
             ByteChunk body = new ByteChunk();
             body.setLimit(request.getConnector().getMaxSavePostSize());
 

==================================================
