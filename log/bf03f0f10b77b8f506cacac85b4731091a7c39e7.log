bf03f0f10b77b8f506cacac85b4731091a7c39e7
==================================================
Port fix from TC5. As per RFC2616, requests with multiple content-length headers are invalid.
==================================================
Mark Emlyn
==================================================
Sat Mar 3 15:56:14 2007 +0000
==================================================
Request.java
Port fix from TC5. As per RFC2616, requests with multiple content-length headers are invalid.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@514176 13f79535-47bb-0310-9956-ffa450edef68



==================================================
MimeHeaders.java
index 21562754c6..63c1e3d752 100644
--- a/java/org/apache/coyote/Request.java
+++ b/java/org/apache/coyote/Request.java
@@ -294,7 +294,7 @@ public final class Request {
     public long getContentLengthLong() {
         if( contentLength > -1 ) return contentLength;
 
-        MessageBytes clB = headers.getValue("content-length");
+        MessageBytes clB = headers.getUniqueValue("content-length");
         contentLength = (clB == null || clB.isNull()) ? -1 : clB.getLong();
 
         return contentLength;

==================================================
