a505a1a5965e0fda4d94877bad7a94204adc0f86
==================================================
Enable SSLv3 to be used. NOT enabled by default.
==================================================
Mark Thomas
==================================================
Wed Jun 21 21:20:01 2017 +0000
==================================================
SSLUtilBase.java
index 17ada32d91..c3dd53680f 100644
--- a/java/org/apache/tomcat/util/net/LocalStrings.properties
+++ b/java/org/apache/tomcat/util/net/LocalStrings.properties
@@ -109,6 +109,7 @@ channel.nio.ssl.sniHostName=The SNI host name extracted for this connection was
 
 jsse.invalid_truststore_password=The provided trust store password could not be used to unlock and/or validate the trust store. Retrying to access the trust store with a null password which will skip validation.
 jsse.keystore_load_failed=Failed to load keystore type [{0}] with path [{1}] due to [{2}]
+jsse.ssl3=SSLv3 has been explicitly enabled. This protocol is known to be insecure.
 
 sniExtractor.clientHelloTooBig=The ClientHello was not presented in a single TLS record so no SNI information could be extracted
 

==================================================
JSSEUtil.java
index d3115272c4..08dff571cc 100644
--- a/java/org/apache/tomcat/util/net/SSLUtilBase.java
+++ b/java/org/apache/tomcat/util/net/SSLUtilBase.java
@@ -53,6 +53,9 @@ public abstract class SSLUtilBase implements SSLUtil {
         Set<String> implementedProtocols = getImplementedProtocols();
         List<String> enabledProtocols =
                 getEnabled("protocols", getLog(), true, configuredProtocols, implementedProtocols);
+        if (enabledProtocols.contains("SSLv3")) {
+            log.warn(sm.getString("jsse.ssl3"));
+        }
         this.enabledProtocols = enabledProtocols.toArray(new String[enabledProtocols.size()]);
 
         // Calculate the enabled ciphers

==================================================
