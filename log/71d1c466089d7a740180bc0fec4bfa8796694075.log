71d1c466089d7a740180bc0fec4bfa8796694075
==================================================
Silence these warnings
==================================================
Mark Thomas
==================================================
Tue Jul 27 21:14:11 2021 +0100
==================================================
ConnectionPool.java
Silence these warnings

A code review suggests that the use of the deprecated
Proxy.getPorxyClass() method within jdbc-pool is safe.


==================================================
AbstractCreateStatementInterceptor.java
index 37fb7a39a7..7e0232dfe2 100644
--- a/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java
+++ b/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java
@@ -361,6 +361,13 @@ public class ConnectionPool {
      * @return constructor used to instantiate the wrapper object
      * @throws NoSuchMethodException Failed to get a constructor
      */
+    /*
+     * Neither the class nor the constructor are exposed outside of jdbc-pool.
+     * Given the comments in the jdbc-pool code regarding caching for
+     * performance, continue to use Proxy.getProxyClass(). This will need to be
+     * revisited if that method is marked for removal.
+     */
+    @SuppressWarnings("deprecation")
     public Constructor<?> getProxyConstructor(boolean xa) throws NoSuchMethodException {
         //cache the constructor
         if (proxyClassConstructor == null ) {

==================================================
StatementDecoratorInterceptor.java
index 521886e90f..b0820e6e93 100644
--- a/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractCreateStatementInterceptor.java
+++ b/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractCreateStatementInterceptor.java
@@ -91,6 +91,13 @@ public abstract class  AbstractCreateStatementInterceptor extends JdbcIntercepto
      * @return - returns a constructor used to create new instances
      * @throws NoSuchMethodException Constructor not found
      */
+    /*
+     * Neither the class nor the constructor are exposed outside of jdbc-pool.
+     * Given the comments in the jdbc-pool code regarding caching for
+     * performance, continue to use Proxy.getProxyClass(). This will need to be
+     * revisited if that method is marked for removal.
+     */
+    @SuppressWarnings("deprecation")
     protected Constructor<?> getConstructor(int idx, Class<?> clazz) throws NoSuchMethodException {
         if (constructors[idx] == null) {
             Class<?> proxyClass = Proxy.getProxyClass(AbstractCreateStatementInterceptor.class.getClassLoader(),

==================================================
