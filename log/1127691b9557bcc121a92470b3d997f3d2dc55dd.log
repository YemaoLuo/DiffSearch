1127691b9557bcc121a92470b3d997f3d2dc55dd
==================================================
Add test case for bug 52970. Need to apply coercion rules to method invocation
==================================================
Mark Emlyn
==================================================
Sat Mar 24 21:29:11 2012 +0000
==================================================
TestMethodExpressionImpl.java
Add test case for bug 52970. Need to apply coercion rules to method invocation

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1304930 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TesterBeanEnum.java
index fc3bf2599d..6705ff3976 100644
--- a/test/org/apache/el/TestMethodExpressionImpl.java
+++ b/test/org/apache/el/TestMethodExpressionImpl.java
@@ -75,6 +75,10 @@ public class TestMethodExpressionImpl {
         TesterBeanC beanC = new TesterBeanC();
         context.getVariableMapper().setVariable("beanC",
                 factory.createValueExpression(beanC, TesterBeanC.class));
+
+        TesterBeanEnum beanEnum = new TesterBeanEnum();
+        context.getVariableMapper().setVariable("beanEnum",
+                factory.createValueExpression(beanEnum, TesterBeanEnum.class));
     }
 
     @Test
@@ -413,4 +417,17 @@ public class TestMethodExpressionImpl {
         assertEquals("Hello from BB", actual);
     }
 
+    @Test
+    public void testBug52970() {
+        MethodExpression me = factory.createMethodExpression(context,
+                "${beanEnum.submit('APPLE')}", null ,
+                new Class<?>[] { TesterBeanEnum.class });
+        me.invoke(context, null);
+
+        ValueExpression ve = factory.createValueExpression(context,
+                "#{beanEnum.lastSubmitted}", TesterEnum.class);
+        TesterEnum actual = (TesterEnum) ve.getValue(context);
+        assertEquals(TesterEnum.APPLE, actual);
+
+    }
 }

==================================================
