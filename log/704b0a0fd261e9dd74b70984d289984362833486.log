704b0a0fd261e9dd74b70984d289984362833486
==================================================
Correct fix for removal of first read timeout, we are always using soTimeout, both for write and for read
==================================================
Filip Hanik
==================================================
Mon May 21 09:02:21 2007 +0000
==================================================
Http11NioProcessor.java
Correct fix for removal of first read timeout, we are always using soTimeout, both for write and for read


git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@540073 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11NioProtocol.java
index a2b91d6815..d5e281112a 100644
--- a/java/org/apache/coyote/http11/Http11NioProcessor.java
+++ b/java/org/apache/coyote/http11/Http11NioProcessor.java
@@ -89,13 +89,7 @@ public class Http11NioProcessor implements ActionHook {
         this.endpoint = endpoint;
 
         request = new Request();
-        int readTimeout = endpoint.getFirstReadTimeout();
-        if (readTimeout == 0) {
-            readTimeout = 100;
-        } else if (readTimeout < 0) {
-            readTimeout = timeout;
-            //readTimeout = -1;
-        }
+        int readTimeout = endpoint.getSoTimeout();
         inputBuffer = new InternalNioInputBuffer(request, maxHttpHeaderSize,readTimeout);
         request.setInputBuffer(inputBuffer);
 
@@ -825,9 +819,6 @@ public class Http11NioProcessor implements ActionHook {
         long soTimeout = endpoint.getSoTimeout();
 
         int limit = 0;
-        if (endpoint.getFirstReadTimeout() > 0 || endpoint.getFirstReadTimeout() < -1) {
-            limit = endpoint.getMaxThreads() / 2;
-        }
 
         boolean keptAlive = false;
         boolean openSocket = false;

==================================================
NioEndpoint.java
index 8294c21edf..f8f4f9555e 100644
--- a/java/org/apache/coyote/http11/Http11NioProtocol.java
+++ b/java/org/apache/coyote/http11/Http11NioProtocol.java
@@ -330,15 +330,6 @@ public class Http11NioProtocol implements ProtocolHandler, MBeanRegistration
         setAttribute("port", "" + port);
     }
 
-    public int getFirstReadTimeout() {
-        return ep.getFirstReadTimeout();
-    }
-
-    public void setFirstReadTimeout( int i ) {
-        ep.setFirstReadTimeout(i);
-        setAttribute("firstReadTimeout", "" + i);
-    }
-
     public InetAddress getAddress() {
         return ep.getAddress();
     }

==================================================
