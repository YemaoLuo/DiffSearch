5ca3eaa822406e32dc201b450c15c93c3a749ebc
==================================================
Simpler fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48790 based on a patch by kkolinko
==================================================
Mark Emlyn
==================================================
Wed Mar 24 12:38:23 2010 +0000
==================================================
DeltaManager.java
Simpler fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48790 based on a patch by kkolinko
Make maxActive thread safe. Probably unnecessary but technically a bug.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@927037 13f79535-47bb-0310-9956-ffa450edef68



==================================================
ManagerBase.java
index 513a75068c..034710fd2e 100644
--- a/java/org/apache/catalina/ha/session/DeltaManager.java
+++ b/java/org/apache/catalina/ha/session/DeltaManager.java
@@ -1160,7 +1160,7 @@ public class DeltaManager extends ClusterManagerBase{
         rejectedSessions = 0 ;
         sessionReplaceCounter = 0 ;
         counterNoStateTransfered = 0 ;
-        maxActive = getActiveSessions() ;
+        setMaxActive(getActiveSessions());
         sessionCounter = getActiveSessions() ;
         counterReceive_EVT_ALL_SESSION_DATA = 0;
         counterReceive_EVT_GET_ALL_SESSIONS = 0;

==================================================
