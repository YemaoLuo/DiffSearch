f651d876366668fe53f7f03a6b52f0570f38cd03
==================================================
Move initialization of CSRF REST nonce header name context attribute into the RestCsrfPreventionFilter where it belongs.
==================================================
Christopher Schultz
==================================================
0500
==================================================
CsrfPreventionFilter.java
Move initialization of CSRF REST nonce header name context attribute into the RestCsrfPreventionFilter where it belongs.



==================================================
RestCsrfPreventionFilter.java
index 8a09cfbd83..621cd6d507 100644
--- a/java/org/apache/catalina/filters/CsrfPreventionFilter.java
+++ b/java/org/apache/catalina/filters/CsrfPreventionFilter.java
@@ -104,11 +104,6 @@ public class CsrfPreventionFilter extends CsrfPreventionFilterBase {
         filterConfig.getServletContext().setAttribute(
                 Constants.CSRF_NONCE_REQUEST_PARAM_NAME_KEY,
                 nonceRequestParameterName);
-
-        // Put the expected request header name into the application scope
-        filterConfig.getServletContext().setAttribute(
-                Constants.CSRF_REST_NONCE_HEADER_NAME_KEY,
-                Constants.CSRF_REST_NONCE_HEADER_NAME);
     }
 
     @Override

==================================================
