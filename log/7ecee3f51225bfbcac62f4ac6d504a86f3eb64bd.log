7ecee3f51225bfbcac62f4ac6d504a86f3eb64bd
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55314
==================================================
Mark Emlyn
==================================================
Wed Jul 31 14:17:08 2013 +0000
==================================================
Constants.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55314
Provide a configuration option to bypass the specification restriction on not being able to add endpoints prgrammatically once the first endpoint has started a handshake.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1508872 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Constants.java
index 280eb073d0..0259174e48 100644
--- a/java/org/apache/tomcat/websocket/Constants.java
+++ b/java/org/apache/tomcat/websocket/Constants.java
@@ -57,6 +57,9 @@ public class Constants {
     public static final String WS_EXTENSIONS_HEADER_NAME =
             "Sec-WebSocket-Extensions";
 
+    public static final boolean STRICT_SPEC_COMPLIANCE =
+            Boolean.getBoolean(
+                    "org.apache.tomcat.websocket.STRICT_SPEC_COMPLIANCE");
 
     private Constants() {
         // Hide default constructor

==================================================
WsServerContainer.java
index ad43383f4a..9081e23bc5 100644
--- a/java/org/apache/tomcat/websocket/server/Constants.java
+++ b/java/org/apache/tomcat/websocket/server/Constants.java
@@ -28,6 +28,8 @@ public class Constants {
             "org.apache.tomcat.websocket.binaryBufferSize";
     public static final String TEXT_BUFFER_SIZE_SERVLET_CONTEXT_INIT_PARAM =
             "org.apache.tomcat.websocket.textBufferSize";
+    public static final String ENFORCE_NO_ADD_AFTER_HANDSHAKE_CONTEXT_INIT_PARAM =
+            "org.apache.tomcat.websocket.noAddAfterHandshake";
 
     public static final String SERVER_CONTAINER_SERVLET_CONTEXT_ATTRIBUTE =
             "javax.websocket.server.ServerContainer";

==================================================
