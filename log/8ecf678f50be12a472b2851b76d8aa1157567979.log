8ecf678f50be12a472b2851b76d8aa1157567979
==================================================
Implement a TODO: change return value of AnnotationEntry.getElementValuePairs() from an array to a list.
==================================================
Konstantin Kolinko
==================================================
Fri Sep 12 15:41:33 2014 +0000
==================================================
ContextConfig.java
Implement a TODO: change return value of AnnotationEntry.getElementValuePairs() from an array to a list.
As all usages are known and constructor of ElementValuePair class is not accessible from outside (package-visible), I think it is OK to skip defensive copying.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1624573 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AnnotationEntry.java
index 5e48f0fc50..d2de36b94b 100644
--- a/java/org/apache/catalina/startup/ContextConfig.java
+++ b/java/org/apache/catalina/startup/ContextConfig.java
@@ -2222,8 +2222,8 @@ public class ContextConfig implements LifecycleListener {
             AnnotationEntry ae, WebXml fragment) {
         String servletName = null;
         // must search for name s. Spec Servlet API 3.0 - 8.2.3.3.n.ii page 81
-        ElementValuePair[] evps = ae.getElementValuePairs();
-        for (ElementValuePair evp : evps) {
+        List<ElementValuePair> evps = ae.getElementValuePairs();
+        for (ElementValuePair evp : ae.getElementValuePairs()) {
             String name = evp.getNameString();
             if ("name".equals(name)) {
                 servletName = evp.getValue().stringifyValue();
@@ -2249,7 +2249,7 @@ public class ContextConfig implements LifecycleListener {
         boolean urlPatternsSet = false;
         String[] urlPatterns = null;
 
-        // ElementValuePair[] evps = ae.getElementValuePairs();
+        // List<ElementValuePair> evps = ae.getElementValuePairs();
         for (ElementValuePair evp : evps) {
             String name = evp.getNameString();
             if ("value".equals(name) || "urlPatterns".equals(name)) {
@@ -2332,7 +2332,7 @@ public class ContextConfig implements LifecycleListener {
             AnnotationEntry ae, WebXml fragment) {
         String filterName = null;
         // must search for name s. Spec Servlet API 3.0 - 8.2.3.3.n.ii page 81
-        ElementValuePair[] evps = ae.getElementValuePairs();
+        List<ElementValuePair> evps = ae.getElementValuePairs();
         for (ElementValuePair evp : evps) {
             String name = evp.getNameString();
             if ("filterName".equals(name)) {
@@ -2491,8 +2491,8 @@ public class ContextConfig implements LifecycleListener {
                 ((ArrayElementValue) ev).getElementValuesArray();
             for (ElementValue value : arrayValues) {
                 if (value instanceof AnnotationElementValue) {
-                    ElementValuePair[] evps = ((AnnotationElementValue)
-                            value).getAnnotationEntry().getElementValuePairs();
+                    List<ElementValuePair> evps = ((AnnotationElementValue) value)
+                            .getAnnotationEntry().getElementValuePairs();
                     String initParamName = null;
                     String initParamValue = null;
                     for (ElementValuePair evp : evps) {

==================================================
