13eca15ba29b88baabedcf2b73a62580f40a9e08
==================================================
Update Echo example for API changes
==================================================
Mark Emlyn
==================================================
Wed Dec 5 22:52:44 2012 +0000
==================================================
EchoEndpoint.java
Update Echo example for API changes

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1417685 13f79535-47bb-0310-9956-ffa450edef68



==================================================
EchoEndpointConfiguration.java
index d222d2fc49..bdd160f6d2 100644
--- a/webapps/examples/WEB-INF/classes/websocket/echo/EchoEndpoint.java
+++ b/webapps/examples/WEB-INF/classes/websocket/echo/EchoEndpoint.java
@@ -18,30 +18,12 @@ package websocket.echo;
 
 import java.io.IOException;
 
-import javax.websocket.DefaultServerConfiguration;
 import javax.websocket.Endpoint;
-import javax.websocket.EndpointConfiguration;
 import javax.websocket.RemoteEndpoint;
-import javax.websocket.ServerEndpointConfiguration;
 import javax.websocket.Session;
 
 public class EchoEndpoint extends Endpoint{
 
-    private static ServerEndpointConfiguration config =
-            new DefaultServerConfiguration("/websocket/echoProgrammatic") {
-
-        @Override
-        public boolean checkOrigin(String originHeaderValue) {
-            // Accept any
-            return true;
-        }
-    };
-
-    @Override
-    public EndpointConfiguration getEndpointConfiguration() {
-        return config;
-    }
-
     @Override
     public void onOpen(Session session) {
         RemoteEndpoint remoteEndpoint = session.getRemote();

==================================================
WsConfigListener.java
new file mode 100644
index 0000000000..5591c1dba5
--- /dev/null
+++ b/webapps/examples/WEB-INF/classes/websocket/echo/EchoEndpointConfiguration.java
@@ -0,0 +1,56 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one or more
+ *  contributor license agreements.  See the NOTICE file distributed with
+ *  this work for additional information regarding copyright ownership.
+ *  The ASF licenses this file to You under the Apache License, Version 2.0
+ *  (the "License"); you may not use this file except in compliance with
+ *  the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+package websocket.echo;
+
+import javax.websocket.DefaultServerConfiguration;
+import javax.websocket.EndpointFactory;
+
+public class EchoEndpointConfiguration
+        extends DefaultServerConfiguration<EchoEndpoint> {
+
+    @Override
+    public boolean checkOrigin(String originHeaderValue) {
+        // No origin checks
+        return true;
+    }
+
+
+    @Override
+    public String getPath() {
+        return "/websocket/echoProgrammatic";
+    }
+
+
+    private static final EndpointFactory<EchoEndpoint> factory =
+            new EchoEndpointFactory();
+
+
+    @Override
+    public EndpointFactory<EchoEndpoint> getEndpointFactory() {
+        return factory;
+    }
+
+
+    private static class EchoEndpointFactory implements
+            EndpointFactory<EchoEndpoint> {
+
+        @Override
+        public EchoEndpoint createEndpoint() {
+            return new EchoEndpoint();
+        }
+    }
+}

==================================================
