f167ba448f6fec2810b3eb838bba362376dd05b0
==================================================
Add some basic import tests and fix a couple of identified issues.
==================================================
Mark Emlyn
==================================================
Wed Jul 17 21:38:48 2013 +0000
==================================================
AstIdentifier.java
Add some basic import tests and fix a couple of identified issues.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1504286 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestAstIdentifier.java
index ecff8c9159..fbb51b065e 100644
--- a/java/org/apache/el/parser/AstIdentifier.java
+++ b/java/org/apache/el/parser/AstIdentifier.java
@@ -18,6 +18,7 @@
 
 package org.apache.el.parser;
 
+import javax.el.ELClass;
 import javax.el.ELException;
 import javax.el.MethodExpression;
 import javax.el.MethodInfo;
@@ -78,11 +79,27 @@ public final class AstIdentifier extends SimpleNode {
         // EL Resolvers
         ctx.setPropertyResolved(false);
         Object result = ctx.getELResolver().getValue(ctx, null, this.image);
-        if (!ctx.isPropertyResolved()) {
-            throw new PropertyNotFoundException(MessageFactory.get(
-                    "error.resolver.unhandled.null", this.image));
+        if (ctx.isPropertyResolved()) {
+            return result;
         }
-        return result;
+
+        // Import
+        result = ctx.getImportHandler().resolveClass(this.image);
+        if (result != null) {
+            return new ELClass((Class<?>) result);
+        }
+        result = ctx.getImportHandler().resolveStatic(this.image);
+        if (result != null) {
+            try {
+                return ((Class<?>) result).getField(this.image).get(null);
+            } catch (IllegalArgumentException | IllegalAccessException
+                    | NoSuchFieldException | SecurityException e) {
+                throw new ELException(e);
+            }
+        }
+
+        throw new PropertyNotFoundException(MessageFactory.get(
+                "error.resolver.unhandled.null", this.image));
     }
 
     @Override

==================================================
