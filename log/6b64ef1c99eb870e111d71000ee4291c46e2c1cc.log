6b64ef1c99eb870e111d71000ee4291c46e2c1cc
==================================================
Improve BlockPoller thread name
==================================================
remm remm@apache.org
==================================================
Fri Apr 19 11:38:03 2019 +0200
==================================================
NioBlockingSelector.java
Improve BlockPoller thread name

Associate BlockPoller thread name with its NIO connector for better
readability.


==================================================
NioEndpoint.java
index 6702557d6a..252bf0ec18 100644
--- a/java/org/apache/tomcat/util/net/NioBlockingSelector.java
+++ b/java/org/apache/tomcat/util/net/NioBlockingSelector.java
@@ -43,8 +43,6 @@ public class NioBlockingSelector {
     private static final Log log = LogFactory.getLog(NioBlockingSelector.class);
     protected static final StringManager sm = StringManager.getManager(NioBlockingSelector.class);
 
-    private static final AtomicInteger threadCounter = new AtomicInteger();
-
     private final SynchronizedStack<KeyReference> keyReferenceStack =
             new SynchronizedStack<>();
 
@@ -55,12 +53,12 @@ public class NioBlockingSelector {
 
     }
 
-    public void open(Selector selector) {
+    public void open(String name, Selector selector) {
         sharedSelector = selector;
         poller = new BlockPoller();
         poller.selector = sharedSelector;
         poller.setDaemon(true);
-        poller.setName("NioBlockingSelector.BlockPoller-" + threadCounter.incrementAndGet());
+        poller.setName(name + "-BlockPoller");
         poller.start();
     }
 

==================================================
NioSelectorPool.java
index 0df2846695..5ba1c1a01f 100644
--- a/java/org/apache/tomcat/util/net/NioEndpoint.java
+++ b/java/org/apache/tomcat/util/net/NioEndpoint.java
@@ -233,7 +233,7 @@ public class NioEndpoint extends AbstractJsseEndpoint<NioChannel,SocketChannel>
         // Initialize SSL if needed
         initialiseSsl();
 
-        selectorPool.open();
+        selectorPool.open(getName());
     }
 
     // Separated out to make it easier for folks that extend NioEndpoint to

==================================================
