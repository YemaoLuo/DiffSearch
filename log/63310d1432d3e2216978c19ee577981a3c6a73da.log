63310d1432d3e2216978c19ee577981a3c6a73da
==================================================
Add support for RFC 5915, unencrypted EC key files with JSSE based TLS
==================================================
Mark Thomas
==================================================
Thu Jan 9 17:54:04 2020 +0000
==================================================
Asn1Parser.java
Add support for RFC 5915, unencrypted EC key files with JSSE based TLS


==================================================
Asn1Writer.java
index 35fe161674..e8e5727751 100644
--- a/java/org/apache/tomcat/util/buf/Asn1Parser.java
+++ b/java/org/apache/tomcat/util/buf/Asn1Parser.java
@@ -83,6 +83,12 @@ public class Asn1Parser {
     }
 
 
+    public void parseBytes(byte[] dest) {
+        System.arraycopy(source, pos, dest, 0, dest.length);
+        pos += dest.length;
+    }
+
+
     private int next() {
         return source[pos++] & 0xFF;
     }

==================================================
PEMFile.java
index 0f9b29ec3e..a129ca1d13 100644
--- a/java/org/apache/tomcat/util/net/jsse/LocalStrings.properties
+++ b/java/org/apache/tomcat/util/net/jsse/LocalStrings.properties
@@ -31,4 +31,5 @@ jsseUtil.noVerificationDepth=The truststoreProvider [{0}] does not support the c
 jsseUtil.trustedCertNotChecked=The validity dates of the trusted certificate with alias [{0}] were not checked as the certificate was of an unknown type
 jsseUtil.trustedCertNotValid=The trusted certificate with alias [{0}] and DN [{1}] is not valid due to [{2}]. Certificates signed by this trusted certificate WILL be accepted
 
-pemFile.noMultiPrimes=The PKCS#1 certificate is in multi-prime format and Java does not provide an API for constructing an RSA private key object from that format
\ No newline at end of file
+pemFile.noMultiPrimes=The PKCS#1 certificate is in multi-prime format and Java does not provide an API for constructing an RSA private key object from that format
+pemFile.notValidRFC5915=The provided key file does not conform to RFC 5915
\ No newline at end of file

==================================================
