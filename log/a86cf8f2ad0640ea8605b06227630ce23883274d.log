a86cf8f2ad0640ea8605b06227630ce23883274d
==================================================
Tomcat doesn't use .ser files for MBeans
==================================================
Mark Emlyn
==================================================
Wed Feb 20 11:54:55 2013 +0000
==================================================
Registry.java
Tomcat doesn't use .ser files for MBeans

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1448108 13f79535-47bb-0310-9956-ffa450edef68



==================================================
MbeansDescriptorsSerSource.java
index eb9a45e5f9..d4ad788bc0 100644
--- a/java/org/apache/tomcat/util/modeler/Registry.java
+++ b/java/org/apache/tomcat/util/modeler/Registry.java
@@ -553,15 +553,15 @@ public class Registry implements RegistryMBean, MBeanRegistration  {
             location=url.toString();
             type=param;
             inputsource=url.openStream();
-            if( sourceType == null ) {
-                sourceType = sourceTypeFromExt(location);
+            if (sourceType == null && location.endsWith(".xml")) {
+                sourceType = "MbeansDescriptorsDigesterSource";
             }
         } else if( source instanceof File ) {
             location=((File)source).getAbsolutePath();
             inputsource=new FileInputStream((File)source);
             type=param;
-            if( sourceType == null ) {
-                sourceType = sourceTypeFromExt(location);
+            if (sourceType == null && location.endsWith(".xml")) {
+                sourceType = "MbeansDescriptorsDigesterSource";
             }
         } else if( source instanceof InputStream ) {
             type=param;
@@ -585,15 +585,6 @@ public class Registry implements RegistryMBean, MBeanRegistration  {
         return mbeans;
     }
 
-    private String sourceTypeFromExt( String s ) {
-        if( s.endsWith( ".ser")) {
-            return "MbeansDescriptorsSerSource";
-        }
-        else if( s.endsWith(".xml")) {
-            return "MbeansDescriptorsDigesterSource";
-        }
-        return null;
-    }
 
     /** Register a component
      * XXX make it private

==================================================
