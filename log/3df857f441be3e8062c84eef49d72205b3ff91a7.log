3df857f441be3e8062c84eef49d72205b3ff91a7
==================================================
Add the plumbing to 'recycle' an HTTP/2 Stream
==================================================
Mark Thomas
==================================================
Thu Jun 25 11:57:58 2020 +0100
==================================================
Stream.java
Add the plumbing to 'recycle' an HTTP/2 Stream


==================================================
StreamProcessor.java
index e25103f341..fdc6e28792 100644
--- a/java/org/apache/coyote/http2/Stream.java
+++ b/java/org/apache/coyote/http2/Stream.java
@@ -725,6 +725,19 @@ class Stream extends AbstractStream implements HeaderEmitter {
         } else {
             handler.closeConnection(http2Exception);
         }
+        recycle();
+    }
+
+
+    /*
+     * This method is called recycle for consistency with the rest of the Tomcat
+     * code base. Currently, it only sets references to null for the purposes of
+     * reducing memory footprint. It does not fully recycle the Stream ready for
+     * re-use since Stream objects are not re-used.
+     */
+    final void recycle() {
+        // Currently a NO-OP. This will change shortly to address the TODO for
+        // nulling out references.
     }
 
 

==================================================
