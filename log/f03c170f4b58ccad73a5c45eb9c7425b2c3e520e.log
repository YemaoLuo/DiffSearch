f03c170f4b58ccad73a5c45eb9c7425b2c3e520e
==================================================
Partial fox for https://issues.apache.org/bugzilla/show_bug.cgi?id=54734
==================================================
Mark Emlyn
==================================================
Mon Mar 25 14:05:25 2013 +0000
==================================================
ReadListener.java
Partial fox for https://issues.apache.org/bugzilla/show_bug.cgi?id=54734
Add new throws
Based on a patch by Nick Williams

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1460669 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WriteListener.java
index bebb42a87b..312d28c9b3 100644
--- a/java/javax/servlet/ReadListener.java
+++ b/java/javax/servlet/ReadListener.java
@@ -15,12 +15,15 @@
  * limitations under the License.
  */
 package javax.servlet;
+
+import java.io.IOException;
+
 /**
  * TODO SERVLET 3.1
  *
  */
 public interface ReadListener extends java.util.EventListener{
-    public abstract void onDataAvailable();
-    public abstract void onAllDataRead();
+    public abstract void onDataAvailable() throws IOException;
+    public abstract void onAllDataRead() throws IOException;
     public abstract void onError(java.lang.Throwable throwable);
 }

==================================================
AsyncContextImpl.java
index 7f787b693c..06ac4e7d91 100644
--- a/java/javax/servlet/WriteListener.java
+++ b/java/javax/servlet/WriteListener.java
@@ -16,11 +16,13 @@
  */
 package javax.servlet;
 
+import java.io.IOException;
+
 /**
  * TODO SERVLET 3.1
  *
  */
 public interface WriteListener extends java.util.EventListener{
-    public void onWritePossible();
+    public void onWritePossible() throws IOException;
     public void onError(java.lang.Throwable throwable);
 }
\ No newline at end of file

==================================================
AbstractServletInputStream.java
index 69ea65be5b..66201001bc 100644
--- a/java/org/apache/catalina/core/AsyncContextImpl.java
+++ b/java/org/apache/catalina/core/AsyncContextImpl.java
@@ -148,7 +148,7 @@ public class AsyncContextImpl implements AsyncContext, AsyncContextCallback {
         return true;
     }
 
-    public boolean canWrite() {
+    public boolean canWrite() throws IOException {
         if (request.getResponse().getCoyoteResponse().getWriteListener()==null) return false;
         ClassLoader oldCL = Thread.currentThread().getContextClassLoader();
         ClassLoader newCL = request.getContext().getLoader().getClassLoader();

==================================================
AbstractServletOutputStream.java
index 9a4923c369..aa7d4c5492 100644
--- a/java/org/apache/coyote/http11/upgrade/AbstractServletInputStream.java
+++ b/java/org/apache/coyote/http11/upgrade/AbstractServletInputStream.java
@@ -164,7 +164,7 @@ public abstract class AbstractServletInputStream extends ServletInputStream {
     }
 
 
-    protected final void onDataAvailable() {
+    protected final void onDataAvailable() throws IOException {
         ready = Boolean.TRUE;
         listener.onDataAvailable();
     }

==================================================
