1f7db2d57911afc808109bf9089ab4eaec5def49
==================================================
Close the client and server sessions after each test to ensure that the background process stops and reduce the chances of one test interfering with an other. This also simplifies debugging should a test fail.
==================================================
Mark Thomas
==================================================
Fri Feb 20 21:00:04 2015 +0000
==================================================
BackgroundProcessManager.java
Close the client and server sessions after each test to ensure that the background process stops and reduce the chances of one test interfering with an other. This also simplifies debugging should a test fail.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1661222 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestWsWebSocketContainer.java
index 76225892ec..57aff336f6 100644
--- a/java/org/apache/tomcat/websocket/BackgroundProcessManager.java
+++ b/java/org/apache/tomcat/websocket/BackgroundProcessManager.java
@@ -98,6 +98,16 @@ public class BackgroundProcessManager {
     }
 
 
+    /*
+     * For unit testing.
+     */
+    int getProcessCount() {
+        synchronized (processesLock) {
+            return processes.size();
+        }
+    }
+
+
     private static class WsBackgroundThread extends Thread {
 
         private final BackgroundProcessManager manager;

==================================================
