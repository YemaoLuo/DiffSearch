54ba2a59f5c1fa4bec7ecfa7e3b6c8f09dcdc83d
==================================================
Fix test broken by fix for BZ 58373
==================================================
Mark Thomas
==================================================
Fri Sep 18 12:41:19 2015 +0000
==================================================
Tomcat.java
Fix test broken by fix for BZ 58373

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1703821 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestStandardContextResources.java
index 7b09735427..7a0cbf6485 100644
--- a/java/org/apache/catalina/startup/Tomcat.java
+++ b/java/org/apache/catalina/startup/Tomcat.java
@@ -520,6 +520,14 @@ public class Tomcat {
      * @see #addWebapp(String, String)
      */
     public Context addWebapp(Host host, String contextPath, String docBase) {
+        return addWebapp(host,  contextPath, docBase, new ContextConfig());
+    }
+
+    /**
+     * @see #addWebapp(String, String)
+     */
+    public Context addWebapp(Host host, String contextPath, String docBase, ContextConfig config) {
+
         silence(host, contextPath);
 
         Context ctx = createContext(host, contextPath);
@@ -528,11 +536,10 @@ public class Tomcat {
         ctx.addLifecycleListener(new DefaultWebXmlListener());
         ctx.setConfigFile(getWebappConfigFile(docBase, contextPath));
 
-        ContextConfig ctxCfg = new ContextConfig();
-        ctx.addLifecycleListener(ctxCfg);
+        ctx.addLifecycleListener(config);
 
         // prevent it from looking ( if it finds one - it'll have dup error )
-        ctxCfg.setDefaultWebXml(noDefaultWebXmlPath());
+        config.setDefaultWebXml(noDefaultWebXmlPath());
 
         if (host == null) {
             getHost().addChild(ctx);

==================================================
