ea149c538cc2bcfd1fa9f60a3f8f5c97b62a82ca
==================================================
Include TLS implementation name in connector
==================================================
Mark Thomas
==================================================
Wed Mar 30 11:39:11 2016 +0000
==================================================
AbstractHttp11JsseProtocol.java
Include TLS implementation name in connector

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1737105 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11AprProtocol.java
index 7813b55735..92be417689 100644
--- a/java/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java
+++ b/java/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java
@@ -17,6 +17,7 @@
 package org.apache.coyote.http11;
 
 import org.apache.tomcat.util.net.AbstractJsseEndpoint;
+import org.apache.tomcat.util.net.openssl.OpenSSLImplementation;
 
 public abstract class AbstractHttp11JsseProtocol<S>
         extends AbstractHttp11Protocol<S> {
@@ -33,6 +34,13 @@ public abstract class AbstractHttp11JsseProtocol<S>
     }
 
 
+    protected String getSslImplemenationShortName() {
+        if (OpenSSLImplementation.class.getName().equals(getSslImplementationName())) {
+            return "openssl";
+        }
+        return "jsse";
+    }
+
     public String getSslImplementationName() { return getEndpoint().getSslImplementationName(); }
     public void setSslImplementationName(String s) { getEndpoint().setSslImplementationName(s); }
 

==================================================
Http11Nio2Protocol.java
index 1c3d8637f5..fc45b17df0 100644
--- a/java/org/apache/coyote/http11/Http11AprProtocol.java
+++ b/java/org/apache/coyote/http11/Http11AprProtocol.java
@@ -63,7 +63,7 @@ public class Http11AprProtocol extends AbstractHttp11Protocol<Long> {
     @Override
     protected String getNamePrefix() {
         if (isSSLEnabled()) {
-            return ("https-apr");
+            return ("https-openssl-apr");
         } else {
             return ("http-apr");
         }

==================================================
Http11NioProtocol.java
index 9ec47a6a12..a48ffac0cd 100644
--- a/java/org/apache/coyote/http11/Http11Nio2Protocol.java
+++ b/java/org/apache/coyote/http11/Http11Nio2Protocol.java
@@ -44,7 +44,7 @@ public class Http11Nio2Protocol extends AbstractHttp11JsseProtocol<Nio2Channel>
     @Override
     protected String getNamePrefix() {
         if (isSSLEnabled()) {
-            return ("https-nio2");
+            return ("https-" + getSslImplemenationShortName()+ "nio2");
         } else {
             return ("http-nio2");
         }

==================================================
