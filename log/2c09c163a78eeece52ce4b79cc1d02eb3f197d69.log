2c09c163a78eeece52ce4b79cc1d02eb3f197d69
==================================================
Revert r616563 which was a fix for bug 43878 that has now been marked as WONTFIX.
==================================================
Mark Emlyn
==================================================
Thu Feb 21 22:02:50 2008 +0000
==================================================
JspCompilationContext.java
Revert r616563 which was a fix for bug 43878 that has now been marked as WONTFIX.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@630019 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JspRuntimeContext.java
index fe667c876c..efa251f0cb 100644
--- a/java/org/apache/jasper/JspCompilationContext.java
+++ b/java/org/apache/jasper/JspCompilationContext.java
@@ -34,6 +34,7 @@ import org.apache.jasper.compiler.JspRuntimeContext;
 import org.apache.jasper.compiler.JspUtil;
 import org.apache.jasper.compiler.Localizer;
 import org.apache.jasper.compiler.ServletWriter;
+import org.apache.jasper.servlet.JasperLoader;
 import org.apache.jasper.servlet.JspServletWrapper;
 
 /**
@@ -175,7 +176,11 @@ public class JspCompilationContext {
 
     public ClassLoader getJspLoader() {
         if( jspLoader == null ) {
-            jspLoader = rctxt.getJspLoader(baseUrl, getClassLoader());
+            jspLoader = new JasperLoader
+            (new URL[] {baseUrl},
+                    getClassLoader(),
+                    rctxt.getPermissionCollection(),
+                    rctxt.getCodeSource());
         }
         return jspLoader;
     }

==================================================
