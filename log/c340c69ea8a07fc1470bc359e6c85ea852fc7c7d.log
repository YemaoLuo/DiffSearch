c340c69ea8a07fc1470bc359e6c85ea852fc7c7d
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45851
==================================================
Mark Emlyn
==================================================
Fri Sep 26 17:37:34 2008 +0000
==================================================
FarmWarDeployer.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45851
Correct NPE when cluster is defined at engine level
Ensure that only 1 thread writes the replicated WAR to disk and that the messages containing the WAR are processed in the correct order.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@699427 13f79535-47bb-0310-9956-ffa450edef68



==================================================
FileMessageFactory.java
index aa6ceb6e97..ce31bb3999 100644
--- a/java/org/apache/catalina/ha/deploy/FarmWarDeployer.java
+++ b/java/org/apache/catalina/ha/deploy/FarmWarDeployer.java
@@ -158,6 +158,7 @@ public class FarmWarDeployer extends ClusterListener implements ClusterDeployer,
         }else {
             engine = (Engine)parent;
             hostname = engine.getDefaultHost();
+            host = (Host) engine.findChild(hostname);
         }
         try {
             oname = new ObjectName(engine.getName() + ":type=Deployer,host="

==================================================
