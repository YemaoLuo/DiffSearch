c9edf4695b3faca894f877a3ccd6ecd05a1ef626
==================================================
Fix a bunch of failing unit tests.
==================================================
Mark Emlyn
==================================================
Mon Dec 3 15:51:12 2012 +0000
==================================================
ServerContainerImpl.java
Fix a bunch of failing unit tests.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1416568 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WsConfigListener.java
index 082b822ef9..36e862f19a 100644
--- a/java/org/apache/tomcat/websocket/ServerContainerImpl.java
+++ b/java/org/apache/tomcat/websocket/ServerContainerImpl.java
@@ -96,6 +96,11 @@ public class ServerContainerImpl extends ClientContainerImpl implements
     public void publishServer(Class<? extends Endpoint> clazz)
             throws DeploymentException {
 
+        if (servletContext == null) {
+            throw new IllegalArgumentException(
+                    sm.getString("serverContainer.servletContextMissing"));
+        }
+
         Endpoint ep = null;
         try {
             ep = clazz.newInstance();

==================================================
