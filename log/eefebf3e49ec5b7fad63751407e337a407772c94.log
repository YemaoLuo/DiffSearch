eefebf3e49ec5b7fad63751407e337a407772c94
==================================================
Pull up NB_WRITE_INTEREST
==================================================
Mark Emlyn
==================================================
Wed May 1 14:57:11 2013 +0000
==================================================
AbstractHttp11Processor.java
Pull up NB_WRITE_INTEREST

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1478037 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11NioProcessor.java
index 1e831bb82e..6259b8acbd 100644
--- a/java/org/apache/coyote/http11/AbstractHttp11Processor.java
+++ b/java/org/apache/coyote/http11/AbstractHttp11Processor.java
@@ -803,6 +803,9 @@ public abstract class AbstractHttp11Processor<S> extends AbstractProcessor<S> {
             ((AtomicBoolean) param).set(asyncStateMachine.isAsyncTimingOut());
         } else if (actionCode == ActionCode.ASYNC_IS_ERROR) {
             ((AtomicBoolean) param).set(asyncStateMachine.isAsyncError());
+        } else if (actionCode == ActionCode.NB_WRITE_INTEREST) {
+            AtomicBoolean isReady = (AtomicBoolean)param;
+            isReady.set(getOutputBuffer().isReady());
         } else if (actionCode == ActionCode.UPGRADE) {
             httpUpgradeHandler = (HttpUpgradeHandler) param;
             // Stop further HTTP output

==================================================
