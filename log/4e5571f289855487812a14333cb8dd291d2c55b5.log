4e5571f289855487812a14333cb8dd291d2c55b5
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51306.
==================================================
Keiichi Fujino
==================================================
Mon Jun 13 09:44:33 2011 +0000
==================================================
DeltaManager.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51306.
Avoid NPE when handleSESSION_EXPIRED is processed while handleSESSION_CREATED is being processed. 

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1135069 13f79535-47bb-0310-9956-ffa450edef68



==================================================
DeltaSession.java
index 42e59a16bd..9521272258 100644
--- a/java/org/apache/catalina/ha/session/DeltaManager.java
+++ b/java/org/apache/catalina/ha/session/DeltaManager.java
@@ -1385,7 +1385,7 @@ public CatalinaCluster getCluster() {
         session.setPrimarySession(false);
         session.setCreationTime(msg.getTimestamp());
         // use container maxInactiveInterval so that session will expire correctly in case of primary transfer
-        session.setMaxInactiveInterval(getMaxInactiveInterval());
+        session.setMaxInactiveInterval(getMaxInactiveInterval(), false);
         session.access();
         session.setId(msg.getSessionID(), notifySessionListenersOnReplication);
         session.resetDeltaRequest();

==================================================
