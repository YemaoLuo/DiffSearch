902ee30d96f97bffc7e3cffe3b55a5f0c422102f
==================================================
Make parameter names in MediaType case-insensitive.
==================================================
Mark Emlyn
==================================================
Tue Nov 13 14:30:52 2012 +0000
==================================================
HttpParser.java
Make parameter names in MediaType case-insensitive.
Based on review by kkolinko

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1408750 13f79535-47bb-0310-9956-ffa450edef68



==================================================
MediaType.java
index ff00719f15..bfffaf300e 100644
--- a/java/org/apache/tomcat/util/http/parser/HttpParser.java
+++ b/java/org/apache/tomcat/util/http/parser/HttpParser.java
@@ -201,9 +201,9 @@ public class HttpParser {
 
             if (skipConstant(input, "=") == SkipConstantResult.FOUND) {
                 String value = readTokenOrQuotedString(input, true);
-                parameters.put(attribute, value);
+                parameters.put(attribute.toLowerCase(Locale.US), value);
             } else {
-                parameters.put(attribute, "");
+                parameters.put(attribute.toLowerCase(Locale.US), "");
             }
 
             lookForSemiColon = skipConstant(input, ";");

==================================================
TestMediaType.java
index f79b0a27ee..dbee0f637d 100644
--- a/java/org/apache/tomcat/util/http/parser/MediaType.java
+++ b/java/org/apache/tomcat/util/http/parser/MediaType.java
@@ -17,6 +17,7 @@
 package org.apache.tomcat.util.http.parser;
 
 import java.util.LinkedHashMap;
+import java.util.Locale;
 import java.util.Map;
 
 public class MediaType {
@@ -59,7 +60,7 @@ public class MediaType {
     }
 
     public String getParameterValue(String parameter) {
-        return parameters.get(parameter);
+        return parameters.get(parameter.toLowerCase(Locale.US));
     }
 
     @Override

==================================================
