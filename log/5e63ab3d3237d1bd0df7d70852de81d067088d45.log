5e63ab3d3237d1bd0df7d70852de81d067088d45
==================================================
Remove / deprecate code originally added to enable the CGI Servlet to
==================================================
Mark Thomas
==================================================
Mon Sep 3 17:58:46 2018 +0000
==================================================
Globals.java
Remove / deprecate code originally added to enable the CGI Servlet to
work as an include with SSI. The CGI servlet has generic handling for
the include case and this flag is no longer required.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1839977 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SSIFilter.java
index 994902b5b2..88017244a9 100644
--- a/java/org/apache/catalina/Globals.java
+++ b/java/org/apache/catalina/Globals.java
@@ -118,9 +118,13 @@ public final class Globals {
      * We do this because of the pathInfo mangling happening when using
      * the CGIServlet in conjunction with the SSI servlet. (value stored
      * as an object of type String)
+     *
+     * @deprecated Unused. This is no longer used as the CGIO servlet now has
+     *             generic handling for when it is used as an include.
+     *             This will be removed in Tomcat 10
      */
-     public static final String SSI_FLAG_ATTR =
-         "org.apache.catalina.ssi.SSIServlet";
+    @Deprecated
+    public static final String SSI_FLAG_ATTR = "org.apache.catalina.ssi.SSIServlet";
 
 
     /**

==================================================
SSIServlet.java
index c2e6c68bcc..fd053d3346 100644
--- a/java/org/apache/catalina/ssi/SSIFilter.java
+++ b/java/org/apache/catalina/ssi/SSIFilter.java
@@ -35,8 +35,6 @@ import javax.servlet.ServletRequest;
 import javax.servlet.ServletResponse;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
-
-import org.apache.catalina.Globals;
 /**
  * Filter to process SSI requests within a webpage. Mapped to a content types
  * from within web.xml.
@@ -92,9 +90,6 @@ public class SSIFilter extends GenericFilter {
         HttpServletRequest req = (HttpServletRequest)request;
         HttpServletResponse res = (HttpServletResponse)response;
 
-        // indicate that we're in SSI processing
-        req.setAttribute(Globals.SSI_FLAG_ATTR, "true");
-
         // setup to capture output
         ByteArrayServletOutputStream basos = new ByteArrayServletOutputStream();
         ResponseIncludeWrapper responseIncludeWrapper =

==================================================
