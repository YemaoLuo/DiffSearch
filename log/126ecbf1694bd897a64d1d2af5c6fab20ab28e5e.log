126ecbf1694bd897a64d1d2af5c6fab20ab28e5e
==================================================
Remove unnecessary privileged block from getAttribute.
==================================================
Mark Thomas
==================================================
Thu Apr 6 20:27:06 2017 +0000
==================================================
PageContextImpl.java
Remove unnecessary privileged block from getAttribute.
I can't see anything in doGetAttribute that would trigger a security check.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1790454 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SecurityClassLoad.java
index 2b03775e37..a767603f5f 100644
--- a/java/org/apache/jasper/runtime/PageContextImpl.java
+++ b/java/org/apache/jasper/runtime/PageContextImpl.java
@@ -214,25 +214,9 @@ public class PageContextImpl extends PageContext {
     public Object getAttribute(final String name, final int scope) {
 
         if (name == null) {
-            throw new NullPointerException(Localizer
-                    .getMessage("jsp.error.attribute.null_name"));
-        }
-
-        if (SecurityUtil.isPackageProtectionEnabled()) {
-            return AccessController.doPrivileged(
-                    new PrivilegedAction<Object>() {
-                @Override
-                public Object run() {
-                    return doGetAttribute(name, scope);
-                }
-            });
-        } else {
-            return doGetAttribute(name, scope);
+            throw new NullPointerException(Localizer.getMessage("jsp.error.attribute.null_name"));
         }
 
-    }
-
-    private Object doGetAttribute(String name, int scope) {
         switch (scope) {
         case PAGE_SCOPE:
             return attributes.get(name);
@@ -242,8 +226,7 @@ public class PageContextImpl extends PageContext {
 
         case SESSION_SCOPE:
             if (session == null) {
-                throw new IllegalStateException(Localizer
-                        .getMessage("jsp.error.page.noSession"));
+                throw new IllegalStateException(Localizer.getMessage("jsp.error.page.noSession"));
             }
             return session.getAttribute(name);
 

==================================================
