7f77c55d8bec8f52dd58ed55271b3fa1d395d9a3
==================================================
Improve IPv6 validation by ensuring that IPv4-Mapped IPv6 addresses do not contain leading zeros in the IPv4 part.
==================================================
Mark Thomas
==================================================
Mon Jun 4 13:18:54 2018 +0000
==================================================
HttpParser.java
Improve IPv6 validation by ensuring that IPv4-Mapped IPv6 addresses do not contain leading zeros in the IPv4 part.
Based on a patch by Katya Stoycheva.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1832843 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestHttpParserHost.java
index ab8cd22e61..8da137310c 100644
--- a/java/org/apache/tomcat/util/http/parser/LocalStrings.properties
+++ b/java/org/apache/tomcat/util/http/parser/LocalStrings.properties
@@ -26,6 +26,7 @@ http.illegalCharacterIpv6=The character [{0}] is never valid in an IPv6 address.
 http.invalidCharacterDomain=The character [{0}] is not valid{1} a domain name.
 http.invalidHextet=Invalid hextet. A hextet must consist of 4 or less hex characters.
 http.invalidIpv4Location=The IPv6 address contains an embedded IPv4 address at an invalid location.
+http.invalidLeadingZero=An non-zero IPv4 octet may not contain a leading zero.
 http.invalidOctet=Invalid octet [{0}]. The valid range for IPv4 octets is 0 to 255.
 http.invalidSegmentEndState=The state [{0}] is not valid for the end of a segment.
 http.noClosingBracket=The IPv6 address is missing a closing bracket.

==================================================
