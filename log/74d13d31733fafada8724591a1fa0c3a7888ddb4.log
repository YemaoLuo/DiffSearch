74d13d31733fafada8724591a1fa0c3a7888ddb4
==================================================
Parallel deployment
==================================================
Mark Emlyn
==================================================
Fri Nov 19 15:00:32 2010 +0000
==================================================
JvmRouteBinderValve.java
Parallel deployment
One more place where contexy.getPath() needs to be replaced with context.getName()

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1036882 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JvmRouteSessionIDBinderListener.java
index 8cb592873d..699cd0e8f9 100644
--- a/java/org/apache/catalina/ha/session/JvmRouteBinderValve.java
+++ b/java/org/apache/catalina/ha/session/JvmRouteBinderValve.java
@@ -416,7 +416,7 @@ public class JvmRouteBinderValve extends ValveBase implements ClusterValve {
             msg.setOrignalSessionID(sessionId);
             msg.setBackupSessionID(newSessionID);
             Context context = request.getContext();
-            msg.setContextPath(context.getPath());
+            msg.setContextName(context.getName());
             msg.setHost(context.getParent().getName());
             c.send(msg);
         }

==================================================
SessionIDMessage.java
index 880d3363ce..0836a0868f 100644
--- a/java/org/apache/catalina/ha/session/JvmRouteSessionIDBinderListener.java
+++ b/java/org/apache/catalina/ha/session/JvmRouteSessionIDBinderListener.java
@@ -128,7 +128,7 @@ public class JvmRouteSessionIDBinderListener extends ClusterListener {
                         "jvmRoute.receiveMessage.sessionIDChanged", sessionmsg
                                 .getOrignalSessionID(), sessionmsg
                                 .getBackupSessionID(), sessionmsg
-                                .getContextPath()));
+                                .getContextName()));
             Container container = getCluster().getContainer();
             Container host = null ;
             if(container instanceof Engine) {
@@ -138,7 +138,7 @@ public class JvmRouteSessionIDBinderListener extends ClusterListener {
             }
             if (host != null) {
                 Context context = (Context) host.findChild(sessionmsg
-                        .getContextPath());
+                        .getContextName());
                 if (context != null) {
                     try {
                         Session session = context.getManager().findSession(
@@ -148,17 +148,17 @@ public class JvmRouteSessionIDBinderListener extends ClusterListener {
                         } else if (log.isInfoEnabled())
                             log.info(sm.getString("jvmRoute.lostSession",
                                     sessionmsg.getOrignalSessionID(),
-                                    sessionmsg.getContextPath()));
+                                    sessionmsg.getContextName()));
                     } catch (IOException e) {
                         log.error(e);
                     }
 
                 } else if (log.isErrorEnabled())
                     log.error(sm.getString("jvmRoute.contextNotFound",
-                            sessionmsg.getContextPath(), ((StandardEngine) host
+                            sessionmsg.getContextName(), ((StandardEngine) host
                                     .getParent()).getJvmRoute()));
             } else if (log.isErrorEnabled())
-                log.error(sm.getString("jvmRoute.hostNotFound", sessionmsg.getContextPath()));
+                log.error(sm.getString("jvmRoute.hostNotFound", sessionmsg.getContextName()));
         }
         return;
     }

==================================================
