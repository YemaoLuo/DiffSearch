d9f243aa49bbe1426534cf131722243bfcd89261
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=64023
==================================================
Christopher Schultz
==================================================
0500
==================================================
DeltaSession.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=64023

Skip null-valued session attributes when de-serializing sessions.



==================================================
StandardSession.java
index 947fa62ba5..2465c60da7 100644
--- a/java/org/apache/catalina/ha/session/DeltaSession.java
+++ b/java/org/apache/catalina/ha/session/DeltaSession.java
@@ -846,7 +846,9 @@ public class DeltaSession extends StandardSession implements Externalizable,Clus
             if (exclude(name, value)) {
                 continue;
             }
-            attributes.put(name, value);
+            // ConcurrentHashMap does not allow null keys or values
+            if(null != value)
+                attributes.put(name, value);
         }
         isValid = isValidSave;
 

==================================================
