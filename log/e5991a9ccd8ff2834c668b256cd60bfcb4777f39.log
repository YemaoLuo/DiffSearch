e5991a9ccd8ff2834c668b256cd60bfcb4777f39
==================================================
back port from trunk, recovery options and retain membership
==================================================
Filip Hanik
==================================================
Fri Aug 17 19:36:19 2007 +0000
==================================================
McastService.java
back port from trunk, recovery options and retain membership


git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@567117 13f79535-47bb-0310-9956-ffa450edef68



==================================================
McastServiceImpl.java
index 28bb338115..8193795aaa 100644
--- a/java/org/apache/catalina/tribes/membership/McastService.java
+++ b/java/org/apache/catalina/tribes/membership/McastService.java
@@ -217,6 +217,19 @@ public class McastService implements MembershipService,MembershipListener {
     public void setPort(int port) {
         properties.setProperty("mcastPort", String.valueOf(port));
     }
+    
+    public void setRecoveryCounter(int recoveryCounter) {
+        properties.setProperty("recoveryCounter", String.valueOf(recoveryCounter));
+    }
+
+    public void setRecoveryEnabled(boolean recoveryEnabled) {
+        properties.setProperty("recoveryEnabled", String.valueOf(recoveryEnabled));
+    }
+
+    public void setRecoverySleepTime(long recoverySleepTime) {
+        properties.setProperty("recoverySleepTime", String.valueOf(recoverySleepTime));
+    }
+
 
     /**
      * @deprecated use getPort()
@@ -348,6 +361,13 @@ public class McastService implements MembershipService,MembershipListener {
                                     ttl,
                                     soTimeout,
                                     this);
+        boolean recEnabled = Boolean.getBoolean(properties.getProperty("recoveryEnabled","true"));
+        impl.setRecoveryEnabled(recEnabled);        
+        int recCnt = Integer.parseInt(properties.getProperty("recoveryCounter","10"));
+        impl.setRecoveryCounter(recCnt);
+        long recSlpTime = Long.parseLong(properties.getProperty("recoverySleepTime","5000"));
+        impl.setRecoverySleepTime(recSlpTime);
+        
         
         impl.start(level);
 		

==================================================
