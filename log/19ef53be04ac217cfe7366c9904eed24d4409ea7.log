19ef53be04ac217cfe7366c9904eed24d4409ea7
==================================================
Correct error code for decoding issues
==================================================
Mark Thomas
==================================================
Wed Jun 3 18:48:40 2015 +0000
==================================================
Http2Parser.java
Correct error code for decoding issues

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1683413 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestHttp2Section_4_3.java
index 1070123e8e..6c167d7cb8 100644
--- a/java/org/apache/coyote/http2/Http2Parser.java
+++ b/java/org/apache/coyote/http2/Http2Parser.java
@@ -234,7 +234,7 @@ class Http2Parser {
             } catch (HpackException hpe) {
                 throw new Http2Exception(
                         sm.getString("http2Parser.processFrameHeaders.decodingFailed"),
-                        0, ErrorCode.PROTOCOL_ERROR);
+                        0, ErrorCode.COMPRESSION_ERROR);
             }
             // switches to write mode
             headerReadBuffer.compact();
@@ -244,7 +244,7 @@ class Http2Parser {
         if (headerReadBuffer.position() > 0) {
             throw new Http2Exception(
                     sm.getString("http2Parser.processFrameHeaders.decodingDataLeft"),
-                    0, ErrorCode.PROTOCOL_ERROR);
+                    0, ErrorCode.COMPRESSION_ERROR);
         }
 
         swallow(padLength);

==================================================
