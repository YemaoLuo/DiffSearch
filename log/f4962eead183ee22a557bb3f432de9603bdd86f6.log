f4962eead183ee22a557bb3f432de9603bdd86f6
==================================================
The ECDH alias is for "cipher suites using ECDH key exchange, including anonymous, ephemeral and fixed ECDH". Ephemeral was missing.
==================================================
Mark Emlyn
==================================================
Fri Aug 1 10:32:50 2014 +0000
==================================================
OpenSSLCipherConfigurationParser.java
The ECDH alias is for "cipher suites using ECDH key exchange, including anonymous, ephemeral and fixed ECDH". Ephemeral was missing.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1615067 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestOpenSSLCipherConfigurationParser.java
index b2cf11f4e9..caf91ca974 100644
--- a/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
+++ b/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
@@ -407,7 +407,7 @@ public class OpenSSLCipherConfigurationParser {
         addListAlias(kECDHr, filterByKeyExchange(allCiphers, Collections.singleton(KeyExchange.ECDHr)));
         addListAlias(kECDHe, filterByKeyExchange(allCiphers, Collections.singleton(KeyExchange.ECDHe)));
         addListAlias(kECDH, filterByKeyExchange(allCiphers, new HashSet<>(Arrays.asList(KeyExchange.ECDHe, KeyExchange.ECDHr))));
-        aliases.put(ECDH, aliases.get(kECDH));
+        addListAlias(ECDH, filterByKeyExchange(allCiphers, new HashSet<>(Arrays.asList(KeyExchange.ECDHe, KeyExchange.ECDHr, KeyExchange.EECDH))));
         addListAlias(kECDHE, filterByKeyExchange(allCiphers, Collections.singleton(KeyExchange.ECDHe)));
         aliases.put(ECDHE, aliases.get(kECDHE));
         addListAlias(kEECDH, filterByKeyExchange(allCiphers, Collections.singleton(KeyExchange.EECDH)));

==================================================
