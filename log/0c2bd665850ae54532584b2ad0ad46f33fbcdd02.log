0c2bd665850ae54532584b2ad0ad46f33fbcdd02
==================================================
Make all calls to URLDecode use an explicit character set
==================================================
Mark Thomas
==================================================
Mon Mar 16 15:57:13 2020 +0000
==================================================
WebappLoader.java
Make all calls to URLDecode use an explicit character set


==================================================
TestUDecoder.java
index 75bb58933d..604d133f2b 100644
--- a/java/org/apache/catalina/loader/WebappLoader.java
+++ b/java/org/apache/catalina/loader/WebappLoader.java
@@ -25,6 +25,7 @@ import java.io.IOException;
 import java.lang.reflect.Constructor;
 import java.net.URL;
 import java.net.URLClassLoader;
+import java.nio.charset.StandardCharsets;
 
 import javax.management.ObjectName;
 
@@ -573,9 +574,9 @@ public class WebappLoader extends LifecycleMBeanBase
                 for (int i = 0; i < repositories.length; i++) {
                     String repository = repositories[i].toString();
                     if (repository.startsWith("file://"))
-                        repository = UDecoder.URLDecode(repository.substring(7));
+                        repository = UDecoder.URLDecode(repository.substring(7), StandardCharsets.UTF_8);
                     else if (repository.startsWith("file:"))
-                        repository = UDecoder.URLDecode(repository.substring(5));
+                        repository = UDecoder.URLDecode(repository.substring(5), StandardCharsets.UTF_8);
                     else
                         continue;
                     if (repository == null)

==================================================
