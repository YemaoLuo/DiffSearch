147642baa1a7641530851df917166853a7006462
==================================================
Fix IDE warnings after Pool updates
==================================================
Mark Thomas
==================================================
Mon Jun 18 21:06:35 2018 +0000
==================================================
BasicDataSource.java
Fix IDE warnings after Pool updates

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1833769 13f79535-47bb-0310-9956-ffa450edef68



==================================================
PoolableConnectionFactory.java
index 8b92d1f18c..5390ed24cf 100644
--- a/java/org/apache/tomcat/dbcp/dbcp2/BasicDataSource.java
+++ b/java/org/apache/tomcat/dbcp/dbcp2/BasicDataSource.java
@@ -2225,7 +2225,7 @@ public class BasicDataSource implements DataSource, BasicDataSourceMXBean, MBean
      */
     protected void createConnectionPool(final PoolableConnectionFactory factory) {
         // Create an object pool to contain our active connections
-        final GenericObjectPoolConfig config = new GenericObjectPoolConfig();
+        final GenericObjectPoolConfig<PoolableConnection> config = new GenericObjectPoolConfig<>();
         updateJmxName(config);
         config.setJmxEnabled(registeredJmxName != null);  // Disable JMX on the underlying pool if the DS is not registered.
         final GenericObjectPool<PoolableConnection> gop = createObjectPool(factory, config, abandonedConfig);
@@ -2256,7 +2256,7 @@ public class BasicDataSource implements DataSource, BasicDataSourceMXBean, MBean
      * @return a non-null instance
      */
     protected  GenericObjectPool<PoolableConnection> createObjectPool(
-            final PoolableConnectionFactory factory, final GenericObjectPoolConfig poolConfig,
+            final PoolableConnectionFactory factory, final GenericObjectPoolConfig<PoolableConnection> poolConfig,
             final AbandonedConfig abandonedConfig) {
         GenericObjectPool<PoolableConnection> gop;
         if (abandonedConfig != null &&
@@ -2433,7 +2433,7 @@ public class BasicDataSource implements DataSource, BasicDataSourceMXBean, MBean
         // NO-OP
     }
 
-    private void updateJmxName(final GenericObjectPoolConfig config) {
+    private void updateJmxName(final GenericObjectPoolConfig<PoolableConnection> config) {
         if (registeredJmxName == null) {
             return;
         }

==================================================
DriverAdapterCPDS.java
index 80fc95ceb8..c53553ed19 100644
--- a/java/org/apache/tomcat/dbcp/dbcp2/PoolableConnectionFactory.java
+++ b/java/org/apache/tomcat/dbcp/dbcp2/PoolableConnectionFactory.java
@@ -280,7 +280,7 @@ public class PoolableConnectionFactory
 
         if(poolStatements) {
             conn = new PoolingConnection(conn);
-            final GenericKeyedObjectPoolConfig config = new GenericKeyedObjectPoolConfig();
+            final GenericKeyedObjectPoolConfig<DelegatingPreparedStatement> config = new GenericKeyedObjectPoolConfig<>();
             config.setMaxTotalPerKey(-1);
             config.setBlockWhenExhausted(false);
             config.setMaxWaitMillis(0);

==================================================
SharedPoolDataSource.java
index 2fcda558e9..55bd5afedf 100644
--- a/java/org/apache/tomcat/dbcp/dbcp2/cpdsadapter/DriverAdapterCPDS.java
+++ b/java/org/apache/tomcat/dbcp/dbcp2/cpdsadapter/DriverAdapterCPDS.java
@@ -194,7 +194,7 @@ public class DriverAdapterCPDS
         }
         KeyedObjectPool<PStmtKeyCPDS, PoolablePreparedStatement<PStmtKeyCPDS>> stmtPool = null;
         if (isPoolPreparedStatements()) {
-            final GenericKeyedObjectPoolConfig config = new GenericKeyedObjectPoolConfig();
+            final GenericKeyedObjectPoolConfig<PoolablePreparedStatement<PStmtKeyCPDS>> config = new GenericKeyedObjectPoolConfig<>();
             config.setMaxTotalPerKey(Integer.MAX_VALUE);
             config.setBlockWhenExhausted(false);
             config.setMaxWaitMillis(0);

==================================================
PoolableManagedConnectionFactory.java
index 19b5908c19..2b126e3b3c 100644
--- a/java/org/apache/tomcat/dbcp/dbcp2/datasources/SharedPoolDataSource.java
+++ b/java/org/apache/tomcat/dbcp/dbcp2/datasources/SharedPoolDataSource.java
@@ -173,8 +173,8 @@ public class SharedPoolDataSource extends InstanceKeyDataSource {
                 getValidationQueryTimeout(), isRollbackAfterValidation());
         factory.setMaxConnLifetimeMillis(getMaxConnLifetimeMillis());
 
-        final GenericKeyedObjectPoolConfig config =
-                new GenericKeyedObjectPoolConfig();
+        final GenericKeyedObjectPoolConfig<PooledConnectionAndInfo> config =
+                new GenericKeyedObjectPoolConfig<>();
         config.setBlockWhenExhausted(getDefaultBlockWhenExhausted());
         config.setEvictionPolicyClassName(getDefaultEvictionPolicyClassName());
         config.setLifo(getDefaultLifo());

==================================================
