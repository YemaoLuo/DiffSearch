81b47196a2095e4889058c68274912786b663a33
==================================================
Add back ability to disabled tests because the buildbot slave has an ancient (patched, but still ancient) OpenSSL version that expects different ciphers to be present.
==================================================
Mark Thomas
==================================================
Tue Aug 11 14:38:12 2015 +0000
==================================================
TestCipher.java
index 5e6e725777..2bd87b505e 100644
--- a/build.xml
+++ b/build.xml
@@ -1449,7 +1449,6 @@
         <sysproperty key="tomcat.test.accesslog" value="${test.accesslog}" />
         <sysproperty key="tomcat.test.reports" value="${test.reports}" />
         <sysproperty key="tomcat.test.openssl.path" value="${test.openssl.path}" />
-        <sysproperty key="tomcat.test.openssl.version" value="${test.openssl.version}" />
         <sysproperty key="tomcat.test.relaxTiming" value="${test.relaxTiming}" />
         <!-- File for Cobertura to write coverage results to -->
         <sysproperty key="net.sourceforge.cobertura.datafile" file="${cobertura.datafile}" />

==================================================
TestOpenSSLCipherConfigurationParser.java
index 35c5576afe..905f9481b5 100644
--- a/test/org/apache/tomcat/util/net/jsse/openssl/TestCipher.java
+++ b/test/org/apache/tomcat/util/net/jsse/openssl/TestCipher.java
@@ -23,10 +23,17 @@ import java.util.List;
 import java.util.Set;
 
 import org.junit.Assert;
+import org.junit.Assume;
+import org.junit.Before;
 import org.junit.Test;
 
 public class TestCipher {
 
+    @Before
+    public void checkVersion() {
+        Assume.assumeTrue(TesterOpenSSL.TESTS_ENABLED);
+    }
+
     /*
      * Checks that every cipher suite returned by OpenSSL is mapped to at least
      * one cipher suite that is recognised by JSSE or is a cipher suite known

==================================================
TesterOpenSSL.java
index 285343e2ec..4955670eca 100644
--- a/test/org/apache/tomcat/util/net/jsse/openssl/TestOpenSSLCipherConfigurationParser.java
+++ b/test/org/apache/tomcat/util/net/jsse/openssl/TestOpenSSLCipherConfigurationParser.java
@@ -19,11 +19,18 @@ package org.apache.tomcat.util.net.jsse.openssl;
 import java.util.List;
 
 import org.junit.Assert;
+import org.junit.Assume;
+import org.junit.Before;
 import org.junit.Ignore;
 import org.junit.Test;
 
 public class TestOpenSSLCipherConfigurationParser {
 
+    @Before
+    public void checkVersion() {
+        Assume.assumeTrue(TesterOpenSSL.TESTS_ENABLED);
+    }
+
     @Test
     public void testDEFAULT() throws Exception {
         // EXPORT was removed from DEFAULT in 1.1.0 but we prefer the old

==================================================
