7757df4a239562dd4c1a0f400a9fac11d05cacfb
==================================================
Implement the requirements of section 4.3 of the WebSocket 1.1 specification and ensure that the deployment of an Endpoint fails if @PathParam is used with an invalid parameter type.
==================================================
Mark Thomas
==================================================
Thu Jan 31 15:08:15 2019 +0000
==================================================
PojoMethodMapping.java
index f323066362..b0d2c503a5 100644
--- a/java/org/apache/tomcat/websocket/pojo/LocalStrings.properties
+++ b/java/org/apache/tomcat/websocket/pojo/LocalStrings.properties
@@ -41,3 +41,5 @@ pojoMethodMapping.partialObject=Invalid Object and boolean parameters present on
 pojoMethodMapping.partialPong=Invalid PongMessage and boolean parameters present on the method [{0}] of class [{1}] that was annotated with OnMessage
 pojoMethodMapping.partialReader=Invalid Reader and boolean parameters present on the method [{0}] of class [{1}] that was annotated with OnMessage
 pojoMethodMapping.pongWithPayload=Invalid PongMessage and Message parameters present on the method [{0}] of class [{1}] that was annotated with OnMessage
+
+pojoPathParam.wrongType=The type [{0}] is not permitted as a path parameter. Must be String, primitive or boxed version of primitive

==================================================
PojoPathParam.java
index a00072f110..13475bf8d6 100644
--- a/java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java
+++ b/java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java
@@ -388,7 +388,9 @@ public class PojoMethodMapping {
         private DecoderMatch decoderMatch = null;
         private long maxMessageSize = -1;
 
-        public MessageHandlerInfo(Method m, List<DecoderEntry> decoderEntries) {
+        public MessageHandlerInfo(Method m, List<DecoderEntry> decoderEntries)
+                throws DeploymentException {
+
             this.m = m;
 
             Class<?>[] types = m.getParameterTypes();

==================================================
