38c633c583713097142ef3ea8d0792921fee1364
==================================================
Follow-up to r1665736
==================================================
Mark Thomas
==================================================
Wed Mar 11 08:13:07 2015 +0000
==================================================
Nio2Endpoint.java
Follow-up to r1665736
Fix NPEs

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1665781 13f79535-47bb-0310-9956-ffa450edef68



==================================================
NioEndpoint.java
index e81f9c421a..17f4351f46 100644
--- a/java/org/apache/tomcat/util/net/Nio2Endpoint.java
+++ b/java/org/apache/tomcat/util/net/Nio2Endpoint.java
@@ -757,6 +757,7 @@ public class Nio2Endpoint extends AbstractEndpoint<Nio2Channel> {
 
         public Nio2SocketWrapper(Nio2Channel channel, Nio2Endpoint endpoint) {
             super(channel, endpoint);
+            socketBufferHandler = channel.getBufHandler();
 
             this.readCompletionHandler = new CompletionHandler<Integer, SocketWrapperBase<Nio2Channel>>() {
                 @Override

==================================================
