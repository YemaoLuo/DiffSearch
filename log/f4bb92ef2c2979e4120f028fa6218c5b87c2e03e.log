f4bb92ef2c2979e4120f028fa6218c5b87c2e03e
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50044 for APR connector
==================================================
Mark Emlyn
==================================================
Sun Oct 10 22:10:27 2010 +0000
==================================================
Http11AprProcessor.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50044 for APR connector

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1006358 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AprEndpoint.java
index a0911af88b..a5b374bd8e 100644
--- a/java/org/apache/coyote/http11/Http11AprProcessor.java
+++ b/java/org/apache/coyote/http11/Http11AprProcessor.java
@@ -597,7 +597,7 @@ public class Http11AprProcessor extends AbstractHttp11Processor {
         } else if (actionCode == ActionCode.COMET_END) {
             comet = false;
         } else if (actionCode == ActionCode.COMET_CLOSE) {
-            //no op
+            endpoint.processSocketAsync(this.socket, SocketStatus.OPEN);
         } else if (actionCode == ActionCode.COMET_SETTIMEOUT) {
             //no op
         } else if (actionCode == ActionCode.ASYNC_COMPLETE) {

==================================================
