18c3c0992fadf89dd3f4027bd20bcbee6c5d05c8
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63358
==================================================
Mark Thomas
==================================================
Mon Apr 29 14:03:19 2019 +0100
==================================================
StandardService.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63358

Expand throwOnFailure support in the Connector to when a Connector is
added to a running Service.


==================================================
TestStandardService.java
index 02f11e140a..5898b1e86f 100644
--- a/java/org/apache/catalina/core/StandardService.java
+++ b/java/org/apache/catalina/core/StandardService.java
@@ -222,14 +222,13 @@ public class StandardService extends LifecycleMBeanBase implements Service {
             connectors = results;
         }
 
-        if (getState().isAvailable()) {
-            try {
+        try {
+            if (getState().isAvailable()) {
                 connector.start();
-            } catch (LifecycleException e) {
-                log.error(sm.getString(
-                        "standardService.connector.startFailed",
-                        connector), e);
             }
+        } catch (LifecycleException e) {
+            throw new IllegalArgumentException(
+                    sm.getString("standardService.connector.startFailed", connector), e);
         }
 
         // Report this property change to interested listeners
@@ -614,5 +613,4 @@ public class StandardService extends LifecycleMBeanBase implements Service {
     public final String getObjectNameKeyProperties() {
         return "type=Service";
     }
-
 }

==================================================
