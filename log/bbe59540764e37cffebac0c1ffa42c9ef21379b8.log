bbe59540764e37cffebac0c1ffa42c9ef21379b8
==================================================
Take advantage of GenericFilter
==================================================
Mark Thomas
==================================================
Fri Oct 9 19:15:25 2015 +0000
==================================================
WebdavFixFilter.java
Take advantage of GenericFilter

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1707797 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WsFilter.java
index 93608b8ff3..bb68b25682 100644
--- a/java/org/apache/catalina/filters/WebdavFixFilter.java
+++ b/java/org/apache/catalina/filters/WebdavFixFilter.java
@@ -18,9 +18,8 @@ package org.apache.catalina.filters;
 
 import java.io.IOException;
 
-import javax.servlet.Filter;
 import javax.servlet.FilterChain;
-import javax.servlet.FilterConfig;
+import javax.servlet.GenericFilter;
 import javax.servlet.ServletException;
 import javax.servlet.ServletRequest;
 import javax.servlet.ServletResponse;
@@ -57,7 +56,9 @@ import javax.servlet.http.HttpServletResponse;
  *   <li>Unknown issue means it doesn't work</li>
  * </ul>
  */
-public class WebdavFixFilter implements Filter {
+public class WebdavFixFilter extends GenericFilter {
+
+    private static final long serialVersionUID = 1L;
 
     private static final String LOG_MESSAGE_PREAMBLE =
         "WebdavFixFilter: Detected client problem: ";
@@ -73,16 +74,6 @@ public class WebdavFixFilter implements Filter {
     private static final String UA_MINIDIR_5_2_3790 =
         "Microsoft-WebDAV-MiniRedir/5.2.3790";
 
-    @Override
-    public void init(FilterConfig filterConfig) throws ServletException {
-        // NOOP
-    }
-
-    @Override
-    public void destroy() {
-        // NOOP
-    }
-
     /**
      * Check for the broken MS WebDAV client and if detected issue a re-direct
      * that hopefully will cause the non-broken client to be used.
@@ -110,12 +101,11 @@ public class WebdavFixFilter implements Filter {
         } else if (ua.startsWith(UA_MINIDIR_5_2_3790)) {
             // XP 64-bit SP2
             if (!"".equals(httpRequest.getContextPath())) {
-                log(request,
-                        "XP-x64-SP2 clients only work with the root context");
+                log("XP-x64-SP2 clients only work with the root context");
             }
             // Namespace issue maybe
             // see http://greenbytes.de/tech/webdav/webdav-redirector-list.html
-            log(request, "XP-x64-SP2 is known not to work with WebDAV Servlet");
+            log("XP-x64-SP2 is known not to work with WebDAV Servlet");
 
             chain.doFilter(request, response);
         } else {
@@ -141,9 +131,9 @@ public class WebdavFixFilter implements Filter {
         return location.toString();
     }
 
-    private void log(ServletRequest request, String msg) {
+    private void log(String msg) {
         StringBuilder builder = new StringBuilder(LOG_MESSAGE_PREAMBLE);
         builder.append(msg);
-        request.getServletContext().log(builder.toString());
+        getServletContext().log(builder.toString());
     }
 }

==================================================
