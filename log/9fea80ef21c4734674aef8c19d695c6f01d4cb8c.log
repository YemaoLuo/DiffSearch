9fea80ef21c4734674aef8c19d695c6f01d4cb8c
==================================================
Fix some failing tests. No regression in Tomcat/Jasper, just need to take account of changes in test framework.
==================================================
Mark Emlyn
==================================================
Thu Oct 7 15:33:46 2010 +0000
==================================================
TestJspDocumentParser.java
Fix some failing tests. No regression in Tomcat/Jasper, just need to take account of changes in test framework.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1005493 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestValidator.java
index 08b636c7db..0049df0c23 100644
--- a/test/org/apache/jasper/compiler/TestJspDocumentParser.java
+++ b/test/org/apache/jasper/compiler/TestJspDocumentParser.java
@@ -20,8 +20,11 @@ package org.apache.jasper.compiler;
 import java.io.File;
 import java.io.IOException;
 
+import javax.servlet.http.HttpServletResponse;
+
 import org.apache.catalina.startup.Tomcat;
 import org.apache.catalina.startup.TomcatBaseTest;
+import org.apache.tomcat.util.buf.ByteChunk;
 
 public class TestJspDocumentParser extends TomcatBaseTest {
     
@@ -35,15 +38,10 @@ public class TestJspDocumentParser extends TomcatBaseTest {
         
         tomcat.start();
 
-        Exception e = null;
-        try {
-            getUrl("http://localhost:" + getPort() + "/test/bug47977.jspx");
-        } catch (IOException ioe) {
-            e = ioe;
-        }
-
-        // Failure is expected
-        assertNotNull(e);
+        int rc = getUrl("http://localhost:" + getPort() +
+                "/test/bug47977.jspx", new ByteChunk(), null);
+        
+        assertEquals(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, rc);
     }
     
     public void testBug48827() throws Exception {

==================================================
