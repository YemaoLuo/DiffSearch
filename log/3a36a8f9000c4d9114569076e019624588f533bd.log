3a36a8f9000c4d9114569076e019624588f533bd
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55125
==================================================
Mark Emlyn
==================================================
Sun Jun 23 19:47:39 2013 +0000
==================================================
StandardService.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55125
No point starting a process if the Server container fails to start.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1495880 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Catalina.java
index 27531bdd7f..1926ebbb41 100644
--- a/java/org/apache/catalina/core/StandardService.java
+++ b/java/org/apache/catalina/core/StandardService.java
@@ -522,7 +522,11 @@ public class StandardService extends LifecycleMBeanBase implements Service {
             }
         }
 
-        mapperListener.stop();
+        // If the Server failed to start, the mapperListener won't have been
+        // started
+        if (mapperListener.getState() != LifecycleState.INITIALIZED) {
+            mapperListener.stop();
+        }
 
         synchronized (executors) {
             for (Executor executor: executors) {

==================================================
