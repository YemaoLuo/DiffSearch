eaccc5b36507efc50ab5a28e31284bc2ce601851
==================================================
Overflow during handshake is an invalid situation, so fix the NIO handshake. Also improve the error message with the actual status.
==================================================
Remy Maucherat
==================================================
Thu Feb 15 12:05:55 2018 +0000
==================================================
SecureNio2Channel.java
Overflow during handshake is an invalid situation, so fix the NIO handshake. Also improve the error message with the actual status.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1824301 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SecureNioChannel.java
index cbc5c81634..acf0aca4a7 100644
--- a/java/org/apache/tomcat/util/net/SecureNio2Channel.java
+++ b/java/org/apache/tomcat/util/net/SecureNio2Channel.java
@@ -320,7 +320,7 @@ public class SecureNio2Channel extends Nio2Channel  {
                         }
                         return 1;
                     } else {
-                        throw new IOException(sm.getString("channel.nio.ssl.unexpectedStatusDuringUnwrap", handshakeStatus));
+                        throw new IOException(sm.getString("channel.nio.ssl.unexpectedStatusDuringUnwrap", handshake.getStatus()));
                     }
                     break;
                 }

==================================================
