c43a580792f4628d9e9cecc04ab404a5ff22b785
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49217
==================================================
Mark Emlyn
==================================================
Mon Jul 5 21:45:26 2010 +0000
==================================================
AstDotSuffix.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49217
Prevent use of Java keywords in identifiers

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@960712 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AstIdentifier.java
index 009465c99d..d925c1159a 100644
--- a/java/org/apache/el/parser/AstDotSuffix.java
+++ b/java/org/apache/el/parser/AstDotSuffix.java
@@ -21,6 +21,7 @@ package org.apache.el.parser;
 import javax.el.ELException;
 
 import org.apache.el.lang.EvaluationContext;
+import org.apache.el.util.Validation;
 
 
 /**
@@ -37,4 +38,12 @@ public final class AstDotSuffix extends SimpleNode {
             throws ELException {
         return this.image;
     }
+    
+    @Override
+    public void setImage(String image) {
+        if (Validation.isJavaKeyword(image)) {
+            throw new ELException("Can't use Java keyword as identifier");
+        }
+        this.image = image;
+    }
 }

==================================================
Validation.java
index 6bb8946110..2283a8db3f 100644
--- a/java/org/apache/el/parser/AstIdentifier.java
+++ b/java/org/apache/el/parser/AstIdentifier.java
@@ -28,6 +28,7 @@ import javax.el.VariableMapper;
 
 import org.apache.el.lang.EvaluationContext;
 import org.apache.el.util.MessageFactory;
+import org.apache.el.util.Validation;
 
 
 /**
@@ -125,6 +126,14 @@ public final class AstIdentifier extends SimpleNode {
         return this.getMethodExpression(ctx).getMethodInfo(ctx.getELContext());
     }
 
+    @Override
+    public void setImage(String image) {
+        if (Validation.isJavaKeyword(image)) {
+            throw new ELException("Can't use Java keyword as identifier");
+        }
+        this.image = image;
+    }
+
     private final MethodExpression getMethodExpression(EvaluationContext ctx)
             throws ELException {
         Object obj = null;

==================================================
