2a57f083cca89b16331435334a1f38c00066f6de
==================================================
Use a single TLD location cache for a web application rather than one per JSP compilation to speed up JSP compilation.
==================================================
Mark Emlyn
==================================================
Tue Apr 19 11:14:04 2011 +0000
==================================================
EmbeddedServletOptions.java
Use a single TLD location cache for a web application rather than one per JSP compilation to speed up JSP compilation.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1095026 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JspC.java
index 0ab63ab3b4..6c5ddbd082 100644
--- a/java/org/apache/jasper/EmbeddedServletOptions.java
+++ b/java/org/apache/jasper/EmbeddedServletOptions.java
@@ -748,7 +748,7 @@ public final class EmbeddedServletOptions implements Options {
 
         // Setup the global Tag Libraries location cache for this
         // web-application.
-        tldLocationsCache = new TldLocationsCache(context);
+        tldLocationsCache = TldLocationsCache.getInstance(context);
         
         // Setup the jsp config info for this web app.
         jspConfig = new JspConfig(context);

==================================================
TldLocationsCache.java
index 22e43de2a6..bf0886507a 100644
--- a/java/org/apache/jasper/JspC.java
+++ b/java/org/apache/jasper/JspC.java
@@ -1436,7 +1436,7 @@ public class JspC implements Options {
             context =new JspCServletContext
                 (new PrintWriter(System.out),
                  new URL("file:" + uriRoot.replace('\\','/') + '/'));
-            tldLocationsCache = new TldLocationsCache(context);
+            tldLocationsCache = TldLocationsCache.getInstance(context);
         } catch (MalformedURLException me) {
             System.out.println("**" + me);
         }

==================================================
