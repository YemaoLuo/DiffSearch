523ee1b1c6ee00168d1d7d163450580884d82a90
==================================================
Code clean up, last pieces to make is a the KeyAttachment object and the Runnable used for addEvent to be non GC objects, as these events happen very frequently
==================================================
Filip Hanik
==================================================
Wed Oct 25 14:31:25 2006 +0000
==================================================
InternalNioInputBuffer.java
Code clean up, last pieces to make is a the KeyAttachment object and the Runnable used for addEvent to be non GC objects, as these events happen very frequently


git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@467669 13f79535-47bb-0310-9956-ffa450edef68



==================================================
NioEndpoint.java
index a7eaaa3608..5504152cd6 100644
--- a/java/org/apache/coyote/http11/InternalNioInputBuffer.java
+++ b/java/org/apache/coyote/http11/InternalNioInputBuffer.java
@@ -594,31 +594,6 @@ public class InternalNioInputBuffer implements InputBuffer {
         }
     }
 
-    private void addToReadQueue(final SelectionKey key, final KeyAttachment att) {
-        att.setWakeUp(true);
-        att.getPoller().addEvent(
-            new Runnable() {
-            public void run() {
-                try {
-                    if (key != null) {
-                        key.interestOps(SelectionKey.OP_READ);
-                        att.interestOps(SelectionKey.OP_READ);
-                    }
-                } catch (CancelledKeyException ckx) {
-                    try {
-                        if ( att != null ) {
-                            att.setError(true); //set to collect this socket immediately
-                            att.setWakeUp(false);
-                        }
-                        try {socket.close();}catch (Exception ignore){}
-                        if ( socket.isOpen() ) socket.close(true);
-                    } catch (Exception ignore) {}
-                }
-            }
-        });
-    }
-
-
     /**
      * Parse the HTTP headers.
      */

==================================================
