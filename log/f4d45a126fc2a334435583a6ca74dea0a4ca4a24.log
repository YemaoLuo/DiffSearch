f4d45a126fc2a334435583a6ca74dea0a4ca4a24
==================================================
Reduce calls to exists()
==================================================
Mark Emlyn
==================================================
Fri Nov 8 09:30:39 2013 +0000
==================================================
CachedResource.java
Reduce calls to exists()

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1539959 13f79535-47bb-0310-9956-ffa450edef68



==================================================
FileResource.java
index fb4bbb5809..ae18f0cab6 100644
--- a/java/org/apache/catalina/webresources/CachedResource.java
+++ b/java/org/apache/catalina/webresources/CachedResource.java
@@ -66,6 +66,13 @@ public class CachedResource implements WebResource {
                     getLastModified();
                     getContentLength();
                     nextCheck = ttl + now;
+                    // exists() is a relatively expensive check for a file so
+                    // use the fact that we know if it exists at this point
+                    if (webResource instanceof EmptyResource) {
+                        cachedExists = Boolean.FALSE;
+                    } else {
+                        cachedExists = Boolean.TRUE;
+                    }
                     return true;
                 }
             }

==================================================
