cca98b6b8eac35993c6fa8e9c10559618a1be3dd
==================================================
New ciphers added to OpenSSL master
==================================================
Mark Thomas
==================================================
Thu Dec 17 15:20:04 2015 +0000
==================================================
Cipher.java
New ciphers added to OpenSSL master

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1720602 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Encryption.java
index 28f99506f5..d057b915ed 100644
--- a/java/org/apache/tomcat/util/net/openssl/ciphers/Cipher.java
+++ b/java/org/apache/tomcat/util/net/openssl/ciphers/Cipher.java
@@ -4323,6 +4323,119 @@ public enum Cipher {
             null,
             null
     ),
+    // draft-ietf-tl\s-chacha20-poly1305-03
+    TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305(
+            0xCCA8,
+            "ECDHE-RSA-CHACHA20-POLY1305",
+            KeyExchange.EECDH,
+            Authentication.RSA,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305(
+            0xCCA9,
+            "ECDHE-ECDSA-CHACHA20-POLY1305",
+            KeyExchange.EECDH,
+            Authentication.ECDSA,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_DHE_RSA_WITH_CHACHA20_POLY1305(
+            0xCCAA,
+            "DHE-RSA-CHACHA20-POLY1305",
+            KeyExchange.EDH,
+            Authentication.RSA,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_PSK_WITH_CHACHA20_POLY1305(
+            0xCCAB,
+            "PSK-CHACHA20-POLY1305",
+            KeyExchange.PSK,
+            Authentication.PSK,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305(
+            0xCCAC,
+            "ECDHE-PSK-CHACHA20-POLY1305",
+            KeyExchange.ECDHEPSK,
+            Authentication.PSK,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_DHE_PSK_WITH_CHACHA20_POLY1305(
+            0xCCAD,
+            "DHE-PSK-CHACHA20-POLY1305",
+            KeyExchange.DHEPSK,
+            Authentication.PSK,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
+    TLS_RSA_PSK_WITH_CHACHA20_POLY1305(
+            0xCCAE,
+            "RSA-PSK-CHACHA20-POLY1305",
+            KeyExchange.RSAPSK,
+            Authentication.RSA,
+            Encryption.CHACHA20POLY1305,
+            MessageDigest.AEAD,
+            Protocol.TLSv1_2,
+            false,
+            EncryptionLevel.HIGH,
+            false,
+            256,
+            256,
+            null,
+            null
+    ),
 
     // Cipher 0x010080 (SSLv2)
     // RC4_128_WITH_MD5

==================================================
TestCipher.java
index 745fafd9e5..56d6bbc271 100644
--- a/java/org/apache/tomcat/util/net/openssl/ciphers/Encryption.java
+++ b/java/org/apache/tomcat/util/net/openssl/ciphers/Encryption.java
@@ -28,6 +28,7 @@ enum Encryption {
     AES256GCM,
     CAMELLIA256,
     CAMELLIA128,
+    CHACHA20POLY1305,
     TRIPLE_DES,
     DES,
     IDEA,

==================================================
