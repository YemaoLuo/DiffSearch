2f1b1cd89f39aa3da05adc67235cdf3758fe151f
==================================================
Include socket reference in IOExceptions to make debugging easier
==================================================
Mark Emlyn
==================================================
Wed Oct 16 11:14:37 2013 +0000
==================================================
AprServletInputStream.java
Include socket reference in IOExceptions to make debugging easier

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1532720 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AprServletOutputStream.java
index 5a0c0c24b6..62c04aed55 100644
--- a/java/org/apache/coyote/http11/upgrade/AprServletInputStream.java
+++ b/java/org/apache/coyote/http11/upgrade/AprServletInputStream.java
@@ -53,7 +53,7 @@ public class AprServletInputStream extends AbstractServletInputStream {
             readLock.lock();
             if (wrapper.getBlockingStatus() == block) {
                 if (closed) {
-                    throw new IOException(sm.getString("apr.closed"));
+                    throw new IOException(sm.getString("apr.closed", Long.valueOf(socket)));
                 }
                 result = Socket.recv(socket, b, off, len);
                 readDone = true;
@@ -73,7 +73,7 @@ public class AprServletInputStream extends AbstractServletInputStream {
                     readLock.lock();
                     writeLock.unlock();
                     if (closed) {
-                        throw new IOException(sm.getString("apr.closed"));
+                        throw new IOException(sm.getString("apr.closed", Long.valueOf(socket)));
                     }
                     result = Socket.recv(socket, b, off, len);
                 } finally {
@@ -102,7 +102,7 @@ public class AprServletInputStream extends AbstractServletInputStream {
             throw new EOFException(sm.getString("apr.clientAbort"));
         } else {
             throw new IOException(sm.getString("apr.read.error",
-                    Integer.valueOf(-result)));
+                    Integer.valueOf(-result), Long.valueOf(socket)));
         }
     }
 

==================================================
