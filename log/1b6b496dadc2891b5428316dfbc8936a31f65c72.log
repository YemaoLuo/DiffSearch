1b6b496dadc2891b5428316dfbc8936a31f65c72
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=61932
==================================================
Mark Thomas
==================================================
Wed Jan 3 20:03:15 2018 +0000
==================================================
AsyncStateMachine.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=61932
Allow a call to AsyncContext.dispatch() to terminate non-blocking I/O.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1820003 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestNonBlockingAPI.java
index c37435656f..b78b06c211 100644
--- a/java/org/apache/coyote/AsyncStateMachine.java
+++ b/java/org/apache/coyote/AsyncStateMachine.java
@@ -350,6 +350,7 @@ public class AsyncStateMachine {
 
 
     private synchronized boolean doDispatch() {
+        clearNonBlockingListeners();
         boolean doDispatch = false;
         if (state == AsyncState.STARTING ||
                 state == AsyncState.TIMING_OUT ||

==================================================
