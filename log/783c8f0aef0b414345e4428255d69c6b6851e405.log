783c8f0aef0b414345e4428255d69c6b6851e405
==================================================
registered is guarded by registeredLock so there is no need for it to be volatile.
==================================================
Mark Thomas
==================================================
Wed Feb 18 12:14:24 2015 +0000
==================================================
UpgradeProcessor.java
registered is guarded by registeredLock so there is no need for it to be volatile.
Simplify the process of triggering the first call to onWritePossible

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1660609 13f79535-47bb-0310-9956-ffa450edef68



==================================================
UpgradeServletOutputStream.java
index 49aba002d0..6c05a34750 100644
--- a/java/org/apache/coyote/http11/upgrade/UpgradeProcessor.java
+++ b/java/org/apache/coyote/http11/upgrade/UpgradeProcessor.java
@@ -99,7 +99,6 @@ public class UpgradeProcessor implements Processor, WebConnection {
     public final SocketState upgradeDispatch(SocketStatus status) {
         if (status == SocketStatus.OPEN_READ) {
             upgradeServletInputStream.onDataAvailable();
-            upgradeServletOutputStream.checkWriteDispatch();
         } else if (status == SocketStatus.OPEN_WRITE) {
             upgradeServletOutputStream.onWritePossible();
         } else if (status == SocketStatus.STOP) {

==================================================
