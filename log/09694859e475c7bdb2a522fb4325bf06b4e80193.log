09694859e475c7bdb2a522fb4325bf06b4e80193
==================================================
NIO2 should use SocketTimeoutException
==================================================
remm remm@apache.org
==================================================
Wed Mar 6 17:21:19 2019 +0100
==================================================
Nio2Endpoint.java
NIO2 should use SocketTimeoutException

Harmonize on SocketTimeoutException instead of mixing it with
InterruptedByTimeout. Remove exception replacement in websockets code.


==================================================
WsRemoteEndpointImplServer.java
index bba8d974f9..7bd7191343 100644
--- a/java/org/apache/tomcat/util/net/Nio2Endpoint.java
+++ b/java/org/apache/tomcat/util/net/Nio2Endpoint.java
@@ -30,6 +30,7 @@ import java.nio.channels.AsynchronousSocketChannel;
 import java.nio.channels.ClosedChannelException;
 import java.nio.channels.CompletionHandler;
 import java.nio.channels.FileChannel;
+import java.nio.channels.InterruptedByTimeoutException;
 import java.nio.channels.NetworkChannel;
 import java.nio.file.StandardOpenOption;
 import java.util.ArrayList;
@@ -1172,7 +1173,9 @@ public class Nio2Endpoint extends AbstractJsseEndpoint<Nio2Channel,AsynchronousS
             @Override
             public void failed(Throwable exc, OperationState<A> state) {
                 IOException ioe;
-                if (exc instanceof IOException) {
+                if (exc instanceof InterruptedByTimeoutException) {
+                    ioe = new SocketTimeoutException();
+                } else if (exc instanceof IOException) {
                     ioe = (IOException) exc;
                 } else {
                     ioe = new IOException(exc);

==================================================
