bf21e1e02e1a31dc363b537b1ca817a3862559e2
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60798
==================================================
Mark Thomas
==================================================
Fri Mar 3 11:54:46 2017 +0000
==================================================
AbstractInputStreamJar.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60798
Correct a bug in the handling of JARs in unpacked WARs that meant multiple attempts to read the same entry from a JAR in succession would fail for the second and subsequent attempts.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1785271 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestAbstractInputStreamJar.java
index d658353a73..d9c6f5370b 100644
--- a/java/org/apache/tomcat/util/scan/AbstractInputStreamJar.java
+++ b/java/org/apache/tomcat/util/scan/AbstractInputStreamJar.java
@@ -93,6 +93,10 @@ public abstract class AbstractInputStreamJar implements Jar {
         if (entry == null) {
             return null;
         } else {
+            // Clear the entry so that multiple calls to this method for the
+            // same entry will result in a new InputStream for each call
+            // (BZ 60798)
+            entry = null;
             return jarInputStream;
         }
     }

==================================================
