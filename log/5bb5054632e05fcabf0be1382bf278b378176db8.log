5bb5054632e05fcabf0be1382bf278b378176db8
==================================================
Differentiate between retrieving an existing stream and creating a new one.
==================================================
Mark Thomas
==================================================
Tue Jun 9 19:26:08 2015 +0000
==================================================
Http2Parser.java
Differentiate between retrieving an existing stream and creating a new one.
Start to add the 5.1.1 tests

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1684505 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http2UpgradeHandler.java
index 489a4a8752..89f5df1960 100644
--- a/java/org/apache/coyote/http2/Http2Parser.java
+++ b/java/org/apache/coyote/http2/Http2Parser.java
@@ -517,11 +517,11 @@ class Http2Parser {
 
         // Data frames
         ByteBuffer getInputByteBuffer(int streamId, int payloadSize) throws Http2Exception;
-        void receiveEndOfStream(int streamId);
+        void receiveEndOfStream(int streamId) throws ConnectionError;
 
         // Header frames
         HeaderEmitter headersStart(int streamId) throws Http2Exception;
-        void headersEnd(int streamId);
+        void headersEnd(int streamId) throws ConnectionError;
 
         // Priority frames (also headers)
         void reprioritise(int streamId, int parentStreamId, boolean exclusive, int weight)

==================================================
TestHttp2Section_5_1.java
index 14694bd815..8d1893e039 100644
--- a/java/org/apache/coyote/http2/LocalStrings.properties
+++ b/java/org/apache/coyote/http2/LocalStrings.properties
@@ -69,6 +69,10 @@ upgradeHandler.init=Connection [{0}]
 upgradeHandler.ioerror=Connection [{0}]
 upgradeHandler.sendPrefaceFail=Failed to send preface to client
 upgradeHandler.socketCloseFailed=Error closing socket
+upgradeHandler.stream.closed=Stream [{0}] has been closed for some time
+upgradeHandler.stream.even=A new remote stream ID of [{0}] was requested but all remote streams must use odd identifiers
+upgradeHandler.stream.old=A new remote stream ID of [{0}] was requested but the most recent stream was [{1}]
+upgradeHandler.swallow.eos=End of stream found while trying to swallow [{0}] bytes
 upgradeHandler.unexpectedEos=Unexpected end of stream
 upgradeHandler.unexpectedStatus=An unexpected value of status ([{0}]) was passed to this method
 upgradeHandler.upgrade=Connection [{0}], HTTP/1.1 upgrade to stream [1]

==================================================
