19b956bb23de7fac344a719423c8bb795fe97c99
==================================================
Annotations and ParameterAnnotations have a different structure
==================================================
Mark Emlyn
==================================================
Thu Sep 11 22:17:31 2014 +0000
==================================================
Attribute.java
Annotations and ParameterAnnotations have a different structure

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1624408 13f79535-47bb-0310-9956-ffa450edef68



==================================================
ClassParser.java
index e149853908..4e25101f48 100644
--- a/java/org/apache/tomcat/util/bcel/classfile/Attribute.java
+++ b/java/org/apache/tomcat/util/bcel/classfile/Attribute.java
@@ -139,7 +139,7 @@ public abstract class Attribute implements Serializable
             return new RuntimeVisibleParameterAnnotations(name_index, length,
                     file, constant_pool);
         case Constants.ATTR_RUNTIME_INVISIBLE_PARAMETER_ANNOTATIONS:
-            Utility.swallowAnnotations(file);
+            Utility.swallowParameterAnnotations(file);
             return null;
         case Constants.ATTR_ANNOTATION_DEFAULT:
             return new AnnotationDefault(name_index, length, file,

==================================================
Utility.java
index 872bf8a0c2..d1501ccee8 100644
--- a/java/org/apache/tomcat/util/bcel/classfile/ClassParser.java
+++ b/java/org/apache/tomcat/util/bcel/classfile/ClassParser.java
@@ -173,8 +173,7 @@ public final class ClassParser {
      * @throws  ClassFormatException
      */
     private void readFields() throws IOException, ClassFormatException {
-        int fields_count;
-        fields_count = file.readUnsignedShort();
+        int fields_count = file.readUnsignedShort();
         for (int i = 0; i < fields_count; i++) {
             Utility.swallowFieldOrMethod(file, constant_pool);
         }

==================================================
