386912a93f130078f52e7094be3a730cda742121
==================================================
Fix BZ 65563. Correct parsing of Content-Range headers
==================================================
Mark Thomas
==================================================
Thu Sep 9 08:36:12 2021 +0100
==================================================
ContentRange.java
Fix BZ 65563. Correct parsing of Content-Range headers

Tomcat was incorrectly requiring an '=' character after "bytes". Fix
based on pull request #449  by Thierry Gu√©rin.


==================================================
TestDefaultServletPut.java
index 59bf071ce3..d77a0e4c41 100644
--- a/java/org/apache/tomcat/util/http/parser/ContentRange.java
+++ b/java/org/apache/tomcat/util/http/parser/ContentRange.java
@@ -71,10 +71,10 @@ public class ContentRange {
             return null;
         }
 
-        // Must be followed by '='
-        if (HttpParser.skipConstant(input, "=") == SkipResult.NOT_FOUND) {
-            return null;
-        }
+        // Must be followed by SP. Parser is lenient and accepts any LWS here.
+        // No need for explicit check as something must have terminated the
+        // token and if that something was anything other than LWS the following
+        // call to readLong() will fail.
 
         // Start
         long start = HttpParser.readLong(input);

==================================================
