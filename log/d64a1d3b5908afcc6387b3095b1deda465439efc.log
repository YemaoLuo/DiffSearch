d64a1d3b5908afcc6387b3095b1deda465439efc
==================================================
Implement read(byte[],int,int) to improve performance. Store mask as a
==================================================
Mark Emlyn
==================================================
Fri Feb 24 17:29:26 2012 +0000
==================================================
WsFrame.java
Implement read(byte[],int,int) to improve performance. Store mask as a
byte[] since that is how ost traffic will be processed.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1293350 13f79535-47bb-0310-9956-ffa450edef68



==================================================
WsInputStream.java
index 51cfede108..51bf22f10e 100644
--- a/java/org/apache/catalina/websocket/WsFrame.java
+++ b/java/org/apache/catalina/websocket/WsFrame.java
@@ -38,7 +38,7 @@ public class WsFrame {
     private final boolean fin;
     private final int rsv;
     private final byte opCode;
-    private int[] mask = new int[4];
+    private byte[] mask = new byte[4];
     private long payloadLength;
     private ByteBuffer payload;
 
@@ -86,9 +86,7 @@ public class WsFrame {
             }
         }
 
-        for (int j = 0; j < mask.length; j++) {
-            mask[j] = processorRead(processor) & 0xFF;
-        }
+        processorRead(processor, mask);
 
         if (isControl()) {
             // Note: Payload limited to <= 125 bytes by test above
@@ -127,7 +125,7 @@ public class WsFrame {
         return (opCode & 0x08) > 0;
     }
 
-    public int[] getMask() {
+    public byte[] getMask() {
         return mask;
     }
 

==================================================
