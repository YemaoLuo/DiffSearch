fa803a6439833b207444d79ee376188093fe990a
==================================================
https://issues.apache.org/bugzilla/show_bug.cgi?id=47330
==================================================
Mark Emlyn
==================================================
Thu Nov 5 02:03:12 2009 +0000
==================================================
RemoteIpValve.java
index abc4fb84fa..7252cc66d2 100644
--- a/java/org/apache/catalina/valves/LocalStrings.properties
+++ b/java/org/apache/catalina/valves/LocalStrings.properties
@@ -41,6 +41,9 @@ errorReportValve.rootCause=root cause
 errorReportValve.note=note
 errorReportValve.rootCauseInLogs=The full stack trace of the root cause is available in the {0} logs.
 
+# Remote IP valve
+remoteIpValve.syntax=Invalid regular expressions [{0}] provided.
+
 # HTTP status reports
 http.100=The client may continue ({0}).
 http.101=The server is switching protocols according to the "Upgrade" header ({0}).

==================================================
RemoteIpValveTest.java
index 3448c9a7c8..76ecf30f87 100644
--- a/java/org/apache/catalina/valves/mbeans-descriptors.xml
+++ b/java/org/apache/catalina/valves/mbeans-descriptors.xml
@@ -355,4 +355,41 @@
 
   </mbean>
 
+  <mbean name="RemoteIpValve"
+         description="Valve that sets client information (eg IP address) based on data from a trusted proxy"
+         domain="Catalina"
+         group="Valve"
+         type="org.apache.catalina.valves.RemoteIpValve">
+    
+    <attribute name="internalProxies"
+               description="Comma delimited list of internal proxies"
+               type="java.lang.String"
+               writeable="false" />
+               
+    <attribute name="protocolHeader"
+               description="The protocol header (e.g. &quot;X-Forwarded-Proto&quot;)"
+               type="java.lang.String"
+               writeable="false" />
+               
+    <attribute name="protocolHeaderHttpsValue"
+               description="The value of the protocol header for incoming https request (e.g. &quot;https&quot;)"
+               type="java.lang.String"
+               writeable="false" />
+               
+    <attribute name="proxiesHeader"
+               description="The proxies header name (e.g. &quot;X-Forwarded-By&quot;)"
+               type="java.lang.String"
+               writeable="false" />
+               
+    <attribute name="remoteIpHedaer"
+               description="The remote IP header name (e.g. &quot;X-Forwarded-For&quot;)"
+               type="java.lang.String"
+               writeable="false" />
+               
+    <attribute name="trustedProxies"
+               description="Comma delimited list of trusted proxies"
+               type="java.lang.String"
+               writeable="false" />
+               
+  </mbean>
 </mbeans-descriptors>

==================================================
