100a8088de3f1501e3e82546dc1d2114234199cc
==================================================
Fix some more deprecation warnings when building with Java 9.
==================================================
Mark Thomas
==================================================
Thu Oct 5 13:13:27 2017 +0000
==================================================
TestWebappClassLoaderThreadLocalMemoryLeak.java
Fix some more deprecation warnings when building with Java 9.
Use of Class.newInstance() in test code

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1811204 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestWebappClassLoaderWeaving.java
index 0a89a505c1..419a8298f8 100644
--- a/test/org/apache/catalina/loader/TestWebappClassLoaderThreadLocalMemoryLeak.java
+++ b/test/org/apache/catalina/loader/TestWebappClassLoaderThreadLocalMemoryLeak.java
@@ -196,7 +196,7 @@ public class TestWebappClassLoaderThreadLocalMemoryLeak extends TomcatBaseTest {
                     "org.apache.tomcat.unittest." + name, classBytes, 0,
                     offset, cl.getClass().getProtectionDomain());
             // Make sure we can create an instance
-            Object obj = lpClass.newInstance();
+            Object obj = lpClass.getDeclaredConstructor().newInstance();
             obj.toString();
         }
     }

==================================================
ChannelCreator.java
index 8258528134..fa62a7a76a 100644
--- a/test/org/apache/catalina/loader/TestWebappClassLoaderWeaving.java
+++ b/test/org/apache/catalina/loader/TestWebappClassLoaderWeaving.java
@@ -307,7 +307,7 @@ public class TestWebappClassLoaderWeaving extends TomcatBaseTest {
 
         Method m = c.getMethod("doMethod");
 
-        Object o = c.newInstance();
+        Object o = c.getDeclaredConstructor().newInstance();
         return (String) m.invoke(o);
 
     }

==================================================
TesterFactory.java
index a49189336d..aae04d2949 100644
--- a/test/org/apache/catalina/tribes/demos/ChannelCreator.java
+++ b/test/org/apache/catalina/tribes/demos/ChannelCreator.java
@@ -171,7 +171,7 @@ public class ChannelCreator {
         System.out.println("Creating receiver class="+receiver);
         Class<?> cl = Class.forName(receiver, true,
                 ChannelCreator.class.getClassLoader());
-        ReceiverBase rx = (ReceiverBase)cl.newInstance();
+        ReceiverBase rx = (ReceiverBase)cl.getDeclaredConstructor().newInstance();
         rx.setAddress(bind);
         rx.setPort(port);
         rx.setSelectorTimeout(tcpseltimeout);
@@ -185,7 +185,8 @@ public class ChannelCreator {
 
         ReplicationTransmitter ps = new ReplicationTransmitter();
         System.out.println("Creating transport class="+transport);
-        MultiPointSender sender = (MultiPointSender)Class.forName(transport,true,ChannelCreator.class.getClassLoader()).newInstance();
+        MultiPointSender sender = (MultiPointSender)Class.forName(
+                transport,true,ChannelCreator.class.getClassLoader()).getDeclaredConstructor().newInstance();
         sender.setTimeout(acktimeout);
         sender.setMaxRetryAttempts(2);
         sender.setRxBufSize(43800);

==================================================
