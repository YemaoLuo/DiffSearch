2daf16722eca276f84fdc926964d4b3460c0c8cf
==================================================
Apply patch 04 from jboynes to improve cookie handling.
==================================================
Mark Emlyn
==================================================
Wed May 21 13:55:16 2014 +0000
==================================================
Cookie.java
Apply patch 04 from jboynes to improve cookie handling.
Prevent V0 cookies using '=' in cookie names
I've checked back though the archives and I can find no record of a user asking for this feature. Also, given the known behaviour of browsers it is unlikely to have worked any way. On that basis, this should be safe.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1596574 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookieNetscapeValidator.java
index 924ba836dd..03a1a7d844 100644
--- a/java/javax/servlet/http/Cookie.java
+++ b/java/javax/servlet/http/Cookie.java
@@ -421,7 +421,10 @@ class CookieNameValidator {
 }
 
 class NetscapeValidator extends CookieNameValidator {
-    private static final String NETSCAPE_SEPARATORS = ",; ";
+    // the Netscape specification describes NAME=VALUE as
+    // "a sequence of characters excluding semi-colon, comma and white space"
+    // we also exclude the '=' character that separates NAME from VALUE
+    private static final String NETSCAPE_SEPARATORS = ",; " + "=";
 
     NetscapeValidator() {
         super(NETSCAPE_SEPARATORS);

==================================================
