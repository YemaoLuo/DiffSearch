cf6b8233414c90b1efc21aaaae8f1474a5e88adf
==================================================
Add hex decoding support
==================================================
Mark Emlyn
==================================================
Tue Sep 16 13:55:09 2014 +0000
==================================================
HexUtils.java
Add hex decoding support

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1625289 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestHexUtils.java
index 65dce3d2ec..906c682fb3 100644
--- a/java/org/apache/tomcat/util/buf/HexUtils.java
+++ b/java/org/apache/tomcat/util/buf/HexUtils.java
@@ -65,10 +65,12 @@ public final class HexUtils {
         }
     }
 
+
     public static byte getHex(int index) {
         return HEX[index];
     }
 
+
     public static String toHexString(byte[] bytes) {
         if (null == bytes) {
             return null;
@@ -84,4 +86,18 @@ public final class HexUtils {
 
         return sb.toString();
     }
+
+
+    public static byte[] fromHexString(String input) {
+        if (input == null) {
+            return null;
+        }
+
+        char[] inputChars = input.toCharArray();
+        byte[] result = new byte[input.length() >> 1];
+        for (int i = 0; i < result.length; i++) {
+            result[i] = (byte) ((getDec(inputChars[2*i]) << 4) + getDec(inputChars[2*i + 1]));
+        }
+        return result;
+    }
 }

==================================================
