2a6c5a84435087b318be2622e5e5b659fc920b9e
==================================================
In some circumstances asynchronous requests could time out too soon.
==================================================
Mark Emlyn
==================================================
Wed Feb 12 14:36:26 2014 +0000
==================================================
AbstractAjpProcessor.java
In some circumstances asynchronous requests could time out too soon.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1567634 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AbstractHttp11Processor.java
index 192d2eed84..ff7c145a08 100644
--- a/java/org/apache/coyote/ajp/AbstractAjpProcessor.java
+++ b/java/org/apache/coyote/ajp/AbstractAjpProcessor.java
@@ -521,6 +521,8 @@ public abstract class AbstractAjpProcessor<S> extends AbstractProcessor<S> {
 
         } else if (actionCode == ActionCode.ASYNC_START) {
             asyncStateMachine.asyncStart((AsyncContextCallback) param);
+            // Async time out is based on SocketWrapper access time
+            getSocketWrapper().access();
 
         } else if (actionCode == ActionCode.ASYNC_COMPLETE) {
             socketWrapper.clearDispatches();

==================================================
