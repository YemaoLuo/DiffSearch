cba33637ff3e08cdcd8cfd54ee120a1e3617c120
==================================================
Fix TLD processing when using JspC.
==================================================
Mark Emlyn
==================================================
Thu Oct 10 13:29:13 2013 +0000
==================================================
JspC.java
Fix TLD processing when using JspC.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1530971 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TldScanner.java
index fb98d93862..96705b7ad4 100644
--- a/java/org/apache/jasper/JspC.java
+++ b/java/org/apache/jasper/JspC.java
@@ -1424,6 +1424,8 @@ public class JspC extends Task implements Options {
 
         context = new JspCServletContext(log, resourceBase, classLoader);
         TldScanner scanner = new TldScanner(context, true, validateXml);
+        scanner.setClassLoader(classLoader);
+
         try {
             scanner.scan();
         } catch (SAXException e) {

==================================================
TldParser.java
index 2486b49544..7b20d941f9 100644
--- a/java/org/apache/jasper/servlet/TldScanner.java
+++ b/java/org/apache/jasper/servlet/TldScanner.java
@@ -114,6 +114,14 @@ public class TldScanner {
         return listeners;
     }
 
+    /**
+     * Set the class loader used by the digester to create objects as a result
+     * of this scan. Normally this only needs tobe set when using JspC.
+     */
+    public void setClassLoader(ClassLoader classLoader) {
+        tldParser.setClassLoader(classLoader);
+    }
+
     /**
      * Scan for TLDs required by the platform specification.
      */

==================================================
