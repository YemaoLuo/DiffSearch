a5910fa1889dc10f30acedd4fdce72f1ee64204b
==================================================
Expand the Realm tests to cover the special '*' all roles role.
==================================================
Mark Emlyn
==================================================
Tue Jun 18 13:49:50 2013 +0000
==================================================
TesterContext.java
Expand the Realm tests to cover the special '*' all roles role.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1494136 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestRealmBase.java
index 27826229ae..013ce9f8d8 100644
--- a/test/org/apache/catalina/core/TesterContext.java
+++ b/test/org/apache/catalina/core/TesterContext.java
@@ -19,6 +19,8 @@ package org.apache.catalina.core;
 import java.beans.PropertyChangeListener;
 import java.io.File;
 import java.net.URL;
+import java.util.ArrayList;
+import java.util.List;
 import java.util.Locale;
 import java.util.Map;
 import java.util.Set;
@@ -65,6 +67,23 @@ import org.apache.tomcat.JarScanner;
  */
 public class TesterContext implements Context {
 
+    private List<String> securityRoles = new ArrayList<>();
+    @Override
+    public void addSecurityRole(String role) {
+        securityRoles.add(role);
+    }
+
+    @Override
+    public boolean findSecurityRole(String role) {
+        return securityRoles.contains(role);
+    }
+
+    @Override
+    public String[] findSecurityRoles() {
+        return securityRoles.toArray(new String[securityRoles.size()]);
+    }
+
+
     @Override
     public Log getLogger() {
         return null;
@@ -698,11 +717,6 @@ public class TesterContext implements Context {
         // NO-OP
     }
 
-    @Override
-    public void addSecurityRole(String role) {
-        // NO-OP
-    }
-
     @Override
     public void addServletMapping(String pattern, String name) {
         // NO-OP
@@ -814,16 +828,6 @@ public class TesterContext implements Context {
         return null;
     }
 
-    @Override
-    public boolean findSecurityRole(String role) {
-        return false;
-    }
-
-    @Override
-    public String[] findSecurityRoles() {
-        return null;
-    }
-
     @Override
     public String findServletMapping(String pattern) {
         return null;

==================================================
