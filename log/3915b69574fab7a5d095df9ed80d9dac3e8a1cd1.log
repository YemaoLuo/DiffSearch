3915b69574fab7a5d095df9ed80d9dac3e8a1cd1
==================================================
This was discussed a month ago - didn't hear any objections. It uses the 'platform' mbean server instead of a new one if none 
==================================================
Costin Manolache
==================================================
Fri Jul 18 14:11:03 2008 +0000
==================================================
Bootstrap.java
This was discussed a month ago - didn't hear any objections. It uses the 'platform' mbean server instead of a new one if none 
was explicitely created. This allows using jconsole without any flags - without the change it would only show platform mbeans,
now it has tomcat mbeans as well.



git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@677910 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Registry.java
index b775f0aba5..2e6933f35f 100644
--- a/java/org/apache/catalina/startup/Bootstrap.java
+++ b/java/org/apache/catalina/startup/Bootstrap.java
@@ -20,6 +20,7 @@ package org.apache.catalina.startup;
 
 
 import java.io.File;
+import java.lang.management.ManagementFactory;
 import java.lang.reflect.Method;
 import java.net.MalformedURLException;
 import java.net.URL;
@@ -179,7 +180,7 @@ public final class Bootstrap {
             mBeanServer =
                 (MBeanServer) MBeanServerFactory.findMBeanServer(null).get(0);
         } else {
-            mBeanServer = MBeanServerFactory.createMBeanServer();
+            mBeanServer = ManagementFactory.getPlatformMBeanServer();
         }
 
         // Register the server classloader

==================================================
