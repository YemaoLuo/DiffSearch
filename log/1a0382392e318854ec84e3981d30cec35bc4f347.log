1a0382392e318854ec84e3981d30cec35bc4f347
==================================================
Fix saving of context.xml file from Manager app
==================================================
Mark Thomas
==================================================
Tue Apr 21 11:50:51 2020 +0100
==================================================
ManagerServlet.java
index 001e73badf..96f28d3726 100644
--- a/java/org/apache/catalina/manager/LocalStrings.properties
+++ b/java/org/apache/catalina/manager/LocalStrings.properties
@@ -165,6 +165,7 @@ managerServlet.resourcesType=OK - Listed global resources of type [{0}]
 managerServlet.saveFail=FAIL - Configuration save failed: [{0}]
 managerServlet.saved=OK - Server configuration saved
 managerServlet.savedContext=OK - Context [{0}] configuration saved
+managerServlet.savedContextFail=FAIL - Context [{0}] configuration save failed
 managerServlet.serverInfo=OK - Server info\n\
 Tomcat Version: [{0}]\n\
 OS Name: [{1}]\n\

==================================================
StoreConfig.java
index 5c87831c3d..44f0db59c4 100644
--- a/java/org/apache/catalina/manager/ManagerServlet.java
+++ b/java/org/apache/catalina/manager/ManagerServlet.java
@@ -711,11 +711,14 @@ public class ManagerServlet extends HttpServlet implements ContainerServlet {
                 return;
             }
             try {
-                mBeanServer.invoke(storeConfigOname, "store",
+                Boolean result = (Boolean) mBeanServer.invoke(storeConfigOname, "store",
                         new Object[] {context},
-                        new String [] { "java.lang.String"});
-                writer.println(smClient.getString("managerServlet.savedContext",
-                        path));
+                        new String [] { "org.apache.catalina.Context"});
+                if (result.booleanValue()) {
+                    writer.println(smClient.getString("managerServlet.savedContext", path));
+                } else {
+                    writer.println(smClient.getString("managerServlet.savedContextFail", path));
+                }
             } catch (Exception e) {
                 log(sm.getString("managerServlet.error.storeContextConfig", path), e);
                 writer.println(smClient.getString("managerServlet.exception",

==================================================
