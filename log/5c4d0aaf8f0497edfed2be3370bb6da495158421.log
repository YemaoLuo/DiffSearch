5c4d0aaf8f0497edfed2be3370bb6da495158421
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59151
==================================================
Mark Thomas
==================================================
Wed Mar 9 15:12:19 2016 +0000
==================================================
Response.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59151
Fix a regression in the fix for  BZ 56917 that added additional (and arguably unnecessary) validation to the provided redirect location.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1734258 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestResponse.java
index 283869f646..618e06cd72 100644
--- a/java/org/apache/catalina/connector/Response.java
+++ b/java/org/apache/catalina/connector/Response.java
@@ -19,7 +19,6 @@ package org.apache.catalina.connector;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.net.MalformedURLException;
-import java.net.URI;
 import java.net.URL;
 import java.nio.charset.Charset;
 import java.security.AccessController;
@@ -1335,7 +1334,7 @@ public class Response implements HttpServletResponse {
             // Relative redirects require HTTP/1.1
             if (getRequest().getCoyoteRequest().getSupportsRelativeRedirects() &&
                     getContext().getUseRelativeRedirects()) {
-                locationUri = URI.create(location).toASCIIString();
+                locationUri = location;
             } else {
                 locationUri = toAbsolute(location);
             }

==================================================
