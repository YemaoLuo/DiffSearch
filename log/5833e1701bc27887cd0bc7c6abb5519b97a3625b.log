5833e1701bc27887cd0bc7c6abb5519b97a3625b
==================================================
Add some tests based on the WS EG discussions around some edge cases. Note that some of these will never happen in practise as Tomcat will have normalized the URI.
==================================================
Mark Emlyn
==================================================
Mon Sep 9 12:32:16 2013 +0000
==================================================
UriTemplate.java
Add some tests based on the WS EG discussions around some edge cases. Note that some of these will never happen in practise as Tomcat will have normalized the URI.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1521073 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestUriTemplate.java
index f1c2c936c6..3e03f77239 100644
--- a/java/org/apache/tomcat/websocket/server/UriTemplate.java
+++ b/java/org/apache/tomcat/websocket/server/UriTemplate.java
@@ -52,13 +52,16 @@ public class UriTemplate {
         StringBuilder normalized = new StringBuilder(path.length());
         Set<String> paramNames = new HashSet<>();
 
-        String[] segments = path.split("/");
+        // Include empty segments.
+        String[] segments = path.split("/", -1);
         int paramCount = 0;
         int segmentCount = 0;
 
         for (int i = 0; i < segments.length; i++) {
             String segment = segments[i];
-            if (segment.length() == 0) {
+            // Ignore the first empty segment as the path must always start
+            // with '/'
+            if (i == 0 && segment.length() == 0) {
                 continue;
             }
             normalized.append('/');

==================================================
