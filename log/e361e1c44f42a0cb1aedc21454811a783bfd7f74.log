e361e1c44f42a0cb1aedc21454811a783bfd7f74
==================================================
Avoid unnecessary call of DeltaRequest#addSessionListener in non-primary nodes.
==================================================
Keiichi Fujino
==================================================
Mon Apr 6 02:34:10 2015 +0000
==================================================
DeltaRequest.java
Avoid unnecessary call of DeltaRequest#addSessionListener in non-primary nodes.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1671470 13f79535-47bb-0310-9956-ffa450edef68



==================================================
DeltaSession.java
index 04f0be2534..ae2b31b13c 100644
--- a/java/org/apache/catalina/ha/session/DeltaRequest.java
+++ b/java/org/apache/catalina/ha/session/DeltaRequest.java
@@ -204,9 +204,9 @@ public class DeltaRequest implements Externalizable {
                 case TYPE_LISTENER:
                     SessionListener listener = (SessionListener) info.getValue();
                     if (info.getAction() == ACTION_SET) {
-                        session.addSessionListener(listener);
+                        session.addSessionListener(listener,false);
                     } else {
-                        session.removeSessionListener(listener);
+                        session.removeSessionListener(listener,false);
                     }
                     break;
                 default :

==================================================
