18fb030bc081781fbe0ca5a7c3312e5b1ebbca6b
==================================================
Headers should be read with the standard connection timeout.
==================================================
Mark Emlyn
==================================================
Mon Sep 5 17:18:50 2011 +0000
==================================================
Http11AprProcessor.java
Headers should be read with the standard connection timeout.
The upload timeout should only be used for the request body.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1165367 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11Processor.java
index 60950e46b1..718a1252d6 100644
--- a/java/org/apache/coyote/http11/Http11AprProcessor.java
+++ b/java/org/apache/coyote/http11/Http11AprProcessor.java
@@ -219,11 +219,11 @@ public class Http11AprProcessor extends AbstractHttp11Processor<Long> {
                 if (!endpoint.isPaused()) {
                     request.setStartTime(System.currentTimeMillis());
                     keptAlive = true;
+                    inputBuffer.parseHeaders();
                     if (!disableUploadTimeout) {
                         Socket.timeoutSet(socketRef,
                                 connectionUploadTimeout * 1000);
                     }
-                    inputBuffer.parseHeaders();
                 }
             } catch (IOException e) {
                 if (log.isDebugEnabled()) {

==================================================
