791ef2126b40042bd4c52b4938842d1472c5fc61
==================================================
Fix URI parsing with encodedSolidusHandling="passthrough"
==================================================
Mark Thomas
==================================================
Fri Oct 9 11:46:03 2020 +0100
==================================================
UDecoder.java
Fix URI parsing with encodedSolidusHandling="passthrough"

Based on a pull request by willmeck.


==================================================
TestUDecoder.java
index d917ca0a47..7648a7ec4e 100644
--- a/java/org/apache/tomcat/util/buf/UDecoder.java
+++ b/java/org/apache/tomcat/util/buf/UDecoder.java
@@ -146,7 +146,9 @@ public final class UDecoder {
                         throw EXCEPTION_SLASH;
                     }
                     case PASS_THROUGH: {
-                        idx += 2;
+                        buff[idx++] = buff[j-2];
+                        buff[idx++] = buff[j-1];
+                        buff[idx] = buff[j];
                     }
                     }
                 } else {

==================================================
