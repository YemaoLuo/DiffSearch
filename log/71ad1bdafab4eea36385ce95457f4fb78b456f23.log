71ad1bdafab4eea36385ce95457f4fb78b456f23
==================================================
https://issues.apache.org/bugzilla/show_bug.cgi?id=10972
==================================================
Mark Emlyn
==================================================
Wed Dec 15 17:58:05 2010 +0000
==================================================
Catalina.java
https://issues.apache.org/bugzilla/show_bug.cgi?id=10972
Improve error message if the className attribute is missing on an element in server.xml where it is required.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1049654 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Digester.java
index 57da06d44a..0359999076 100644
--- a/java/org/apache/catalina/startup/Catalina.java
+++ b/java/org/apache/catalina/startup/Catalina.java
@@ -45,6 +45,7 @@ import org.apache.tomcat.util.log.SystemLogHandler;
 import org.apache.tomcat.util.res.StringManager;
 import org.xml.sax.Attributes;
 import org.xml.sax.InputSource;
+import org.xml.sax.SAXParseException;
 
 
 /**
@@ -532,9 +533,12 @@ public class Catalina {
             digester.push(this);
             digester.parse(inputSource);
             inputStream.close();
+        } catch (SAXParseException spe) {
+            log.warn("Catalina.start using " + getConfigFile() + ": " +
+                    spe.getMessage());
+            return;
         } catch (Exception e) {
-            log.warn("Catalina.start using "
-                               + getConfigFile() + ": " , e);
+            log.warn("Catalina.start using " + getConfigFile() + ": " , e);
             return;
         }
 

==================================================
ObjectCreateRule.java
index 1a8886f435..25e52ab604 100644
--- a/java/org/apache/tomcat/util/digester/Digester.java
+++ b/java/org/apache/tomcat/util/digester/Digester.java
@@ -2682,7 +2682,7 @@ public class Digester extends DefaultHandler {
         }
         if (locator != null) {
             String error = "Error at (" + locator.getLineNumber() + ", " +
-                    locator.getColumnNumber() + ": " + message;
+                    locator.getColumnNumber() + ") : " + message;
             if (e != null) {
                 return new SAXParseException(error, locator, e);
             } else {

==================================================
