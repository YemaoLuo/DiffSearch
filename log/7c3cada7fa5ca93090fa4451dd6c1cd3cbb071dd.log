7c3cada7fa5ca93090fa4451dd6c1cd3cbb071dd
==================================================
EL 3.0 collections operations.
==================================================
Mark Emlyn
==================================================
Mon Jul 15 15:50:23 2013 +0000
==================================================
Stream.java
EL 3.0 collections operations.
Implement distinct.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1503310 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCollectionOperations.java
index 6f83aa4405..82b6cc3895 100644
--- a/java/org/apache/el/stream/Stream.java
+++ b/java/org/apache/el/stream/Stream.java
@@ -17,9 +17,11 @@
 package org.apache.el.stream;
 
 import java.util.ArrayList;
+import java.util.HashSet;
 import java.util.Iterator;
 import java.util.List;
 import java.util.NoSuchElementException;
+import java.util.Set;
 
 import javax.el.LambdaExpression;
 
@@ -94,6 +96,27 @@ public class Stream {
     }
 
 
+    public Stream distinct() {
+        Iterator<Object> downStream = new OpIterator() {
+
+            private Set<Object> values = new HashSet<>();
+
+            @Override
+            protected void findNext() {
+                while (iterator.hasNext()) {
+                    Object obj = iterator.next();
+                    if (values.add(obj)) {
+                        next = obj;
+                        foundNext = true;
+                        break;
+                    }
+                }
+            }
+        };
+        return new Stream(downStream);
+    }
+
+
     public Iterator<?> iterator() {
         return iterator;
     }

==================================================
