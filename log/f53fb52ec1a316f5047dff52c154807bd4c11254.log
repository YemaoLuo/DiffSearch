f53fb52ec1a316f5047dff52c154807bd4c11254
==================================================
Bugfix for 65479 - PasswordValidationCallback does not return validation
==================================================
Robert Rodewald
==================================================
Mon Aug 2 11:27:08 2021 +0200
==================================================
CallbackHandlerImpl.java
Bugfix for 65479 - PasswordValidationCallback does not return validation
result in getResult



==================================================
TestJaspicCallbackHandlerInAuthenticator.java
index 59381a6e38..75d230f617 100644
--- a/java/org/apache/catalina/authenticator/jaspic/CallbackHandlerImpl.java
+++ b/java/org/apache/catalina/authenticator/jaspic/CallbackHandlerImpl.java
@@ -80,6 +80,7 @@ public class CallbackHandlerImpl implements CallbackHandler, Contained {
                         PasswordValidationCallback pvc = (PasswordValidationCallback) callback;
                         principal = container.getRealm().authenticate(pvc.getUsername(),
                                 String.valueOf(pvc.getPassword()));
+                        pvc.setResult(principal != null);
                         subject = pvc.getSubject();
                     }
                 } else {

==================================================
