9e36f2a4287a72ea5b092e5b9bd797d812e77482
==================================================
When log rotation is disabled only one separator will be used when generating the log file name.
==================================================
Violeta Georgieva
==================================================
Wed Jul 12 07:53:07 2017 +0000
==================================================
FileHandler.java
index f37d3a7187..073f50ac25 100644
--- a/build.xml
+++ b/build.xml
@@ -1328,6 +1328,7 @@
         <fileset dir="test">
           <include name="META-INF/**"/>
           <include name="**/service-config.txt"/>
+          <include name="**/logging-non-rotatable.properties"/>
         </fileset>
     </copy>
   </target>

==================================================
TestFileHandlerNonRotatable.java
index a6f8d614c9..b0f25e6848 100644
--- a/java/org/apache/juli/FileHandler.java
+++ b/java/org/apache/juli/FileHandler.java
@@ -380,6 +380,17 @@ public class FileHandler extends Handler {
         if (suffix == null) {
             suffix = getProperty(className + ".suffix", ".log");
         }
+
+        // https://bz.apache.org/bugzilla/show_bug.cgi?id=61232
+        boolean shouldCheckForRedundantSeparator = !rotatable && !prefix.isEmpty()
+                && !suffix.isEmpty();
+        // assuming separator is just one char, if there are use cases with
+        // more, the notion of separator might be introduced
+        if (shouldCheckForRedundantSeparator
+                && (prefix.charAt(prefix.length() - 1) == suffix.charAt(0))) {
+            suffix = suffix.substring(1);
+        }
+
         pattern = Pattern.compile("^(" + Pattern.quote(prefix) + ")\\d{4}-\\d{1,2}-\\d{1,2}("
                 + Pattern.quote(suffix) + ")$");
         String sMaxDays = getProperty(className + ".maxDays", String.valueOf(DEFAULT_MAX_DAYS));

==================================================
