7bd0e358ba5a07df1acb69829eec1ddad9461d09
==================================================
Fix an edge case parser bug found while investigating BZ 57136
==================================================
Mark Thomas
==================================================
Wed Sep 9 19:30:52 2015 +0000
==================================================
ELParserTokenManager.java
index 053f813217..480c8dd674 100644
--- a/java/org/apache/el/parser/ELParser.jjt
+++ b/java/org/apache/el/parser/ELParser.jjt
@@ -473,7 +473,7 @@ java.util.Deque<Integer> deque = new java.util.ArrayDeque<Integer>();
    */
   < LITERAL_EXPRESSION:
     (   (~["$", "#", "\\"])* "\\" (["$", "#"])?
-      | (~["$", "#"])* (["$", "#"] ~["{", "$", "#"])
+      | (~["$", "#"])* (["$", "#"] ~["{", "$", "#", "\\"])
       | (~["$", "#"])+
     )+
     | "$"

==================================================
TestELEvaluation.java
index 702ebf5ede..d621765d19 100644
--- a/java/org/apache/el/parser/ELParserTokenManager.java
+++ b/java/org/apache/el/parser/ELParserTokenManager.java
@@ -1,7 +1,5 @@
 /* Generated By:JJTree&JavaCC: Do not edit this line. ELParserTokenManager.java */
 package org.apache.el.parser;
-import java.io.StringReader;
-import javax.el.ELException;
 
 /** Token Manager. */
 @SuppressWarnings("all") // Ignore warnings in generated code
@@ -187,7 +185,7 @@ private int jjMoveNfa_0(int startState, int curPos)
                   jjCheckNAddTwoStates(3, 4);
                   break;
                case 5:
-                  if ((0xf7ffffffffffffffL & l) == 0L)
+                  if ((0xf7ffffffefffffffL & l) == 0L)
                      break;
                   if (kind > 1)
                      kind = 1;

==================================================
