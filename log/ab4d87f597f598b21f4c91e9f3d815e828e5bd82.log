ab4d87f597f598b21f4c91e9f3d815e828e5bd82
==================================================
More unused code removal.
==================================================
Mark Emlyn
==================================================
Fri Dec 23 19:28:58 2011 +0000
==================================================
ClusterJmxHelper.java
More unused code removal.
A little refactoring to allow some methods to be removed to simplify
later refactoring

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1222809 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Registry.java
index dddd159a5c..c64ea07943 100644
--- a/java/org/apache/catalina/ha/jmx/ClusterJmxHelper.java
+++ b/java/org/apache/catalina/ha/jmx/ClusterJmxHelper.java
@@ -37,12 +37,10 @@ import org.apache.tomcat.util.modeler.Registry;
  */
 public class ClusterJmxHelper {
 
-    protected static Registry registry = Registry.getRegistry(null,null);
+    protected static final Registry registry = Registry.getRegistry(null,null);
 
     private static final Log log = LogFactory.getLog(ClusterJmxHelper.class);
 
-    protected static boolean jmxEnabled = true;
-
     protected static MBeanServer mbeanServer = null;
 
     public static Registry getRegistry() {
@@ -63,7 +61,8 @@ public class ClusterJmxHelper {
     protected static boolean initMetaData(Class<?> clazz) {
         try {
             if (clazz==null) return false;
-            getRegistry().loadMetadata(clazz.getResourceAsStream("mbeans-descriptors.xml"));
+            getRegistry().load(null,
+                    clazz.getResourceAsStream("mbeans-descriptors.xml"), null);
         }catch (Exception x) {
             log.warn("Unable to load meta data for class:"+clazz.getName());
             return false;

==================================================
RegistryMBean.java
index 3478c04a2e..39772b186c 100644
--- a/java/org/apache/tomcat/util/modeler/Registry.java
+++ b/java/org/apache/tomcat/util/modeler/Registry.java
@@ -196,44 +196,6 @@ public class Registry implements RegistryMBean, MBeanRegistration  {
         searchedPaths=new HashMap<String,URL>();
     }
 
-    /**
-     * Load an extended mlet file. The source can be an URL, File or
-     * InputStream.
-     *
-     * All mbeans will be instantiated, registered and the attributes will be
-     * set. The result is a list of ObjectNames.
-     *
-     * @param source InputStream or URL of the file
-     * @param cl ClassLoader to be used to load the mbeans, or null to use the
-     *        default JMX mechanism ( i.e. all registered loaders )
-     * @return List of ObjectName for the loaded mbeans
-     * @throws Exception
-     *
-     * @since 1.1
-     */
-    @Override
-    public List<ObjectName> loadMBeans( Object source, ClassLoader cl )
-            throws Exception
-    {
-        return load("MbeansSource", source, null );
-    }
-
-
-    /** Load descriptors. The source can be a File or URL or InputStream for the
-     * descriptors file. In the case of File and URL, if the extension is ".ser"
-     * a serialized version will be loaded.
-     *
-     * This method should be used to explicitly load metadata - but this is not
-     * required in most cases. The registerComponent() method will find metadata
-     * in the same package.
-     *
-     * @param source
-     */
-    @Override
-    public void loadMetadata(Object source ) throws Exception {
-        load( null, source, null );
-    }
-
     /** Register a bean by creating a modeler mbean and adding it to the
      * MBeanServer.
      *

==================================================
