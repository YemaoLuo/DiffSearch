84bd363c4a01f66fb9ea7ece737e966ed373bc8a
==================================================
Fix bug 43878. When development mode isn't being used, use a single JasperLoader. The main benefit is a reduction in the use of perm gen space when there are many JSPs all using the same few tags since the tags are loaded once rather than once per JSP.
==================================================
Mark Emlyn
==================================================
Sat Dec 29 19:28:41 2007 +0000
==================================================
JspCompilationContext.java
Fix bug 43878. When development mode isn't being used, use a single JasperLoader. The main benefit is a reduction in the use of perm gen space when there are many JSPs all using the same few tags since the tags are loaded once rather than once per JSP.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@607464 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JspRuntimeContext.java
index b98e6fe357..0fe40f3db0 100644
--- a/java/org/apache/jasper/JspCompilationContext.java
+++ b/java/org/apache/jasper/JspCompilationContext.java
@@ -34,7 +34,6 @@ import org.apache.jasper.compiler.JspRuntimeContext;
 import org.apache.jasper.compiler.JspUtil;
 import org.apache.jasper.compiler.Localizer;
 import org.apache.jasper.compiler.ServletWriter;
-import org.apache.jasper.servlet.JasperLoader;
 import org.apache.jasper.servlet.JspServletWrapper;
 
 /**
@@ -176,11 +175,7 @@ public class JspCompilationContext {
 
     public ClassLoader getJspLoader() {
         if( jspLoader == null ) {
-            jspLoader = new JasperLoader
-            (new URL[] {baseUrl},
-                    getClassLoader(),
-                    rctxt.getPermissionCollection(),
-                    rctxt.getCodeSource());
+            jspLoader = rctxt.getJspLoader(baseUrl, getClassLoader());
         }
         return jspLoader;
     }

==================================================
