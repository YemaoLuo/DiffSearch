cc8d09db52c3c1bdf5b79ab746ccdfc34465e78b
==================================================
Connector alignment - this parameter is ignored with BIO
==================================================
Mark Emlyn
==================================================
Tue Sep 6 15:49:43 2011 +0000
==================================================
Http11AprProcessor.java
Connector alignment - this parameter is ignored with BIO

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1165723 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11NioProcessor.java
index e4e32cc1a2..e2637f2fad 100644
--- a/java/org/apache/coyote/http11/Http11AprProcessor.java
+++ b/java/org/apache/coyote/http11/Http11AprProcessor.java
@@ -208,7 +208,13 @@ public class Http11AprProcessor extends AbstractHttp11Processor<Long> {
                         break;
                     }
                 }
-                if (!endpoint.isPaused()) {
+                
+                if (endpoint.isPaused()) {
+                    // 503 - Service unavailable
+                    response.setStatus(503);
+                    adapter.log(request, response, 0);
+                    error = true;
+                } else {
                     request.setStartTime(System.currentTimeMillis());
                     keptAlive = true;
                     inputBuffer.parseHeaders();

==================================================
Http11Processor.java
index be8114f88b..11b30500e8 100644
--- a/java/org/apache/coyote/http11/Http11NioProcessor.java
+++ b/java/org/apache/coyote/http11/Http11NioProcessor.java
@@ -235,7 +235,13 @@ public class Http11NioProcessor extends AbstractHttp11Processor<NioChannel> {
                         break;
                     }
                 }
-                if (!endpoint.isPaused()) {
+                
+                if (endpoint.isPaused()) {
+                    // 503 - Service unavailable
+                    response.setStatus(503);
+                    adapter.log(request, response, 0);
+                    error = true;
+                } else {
                     request.setStartTime(System.currentTimeMillis());
                     keptAlive = true;
                     if ( !inputBuffer.parseHeaders() ) {

==================================================
