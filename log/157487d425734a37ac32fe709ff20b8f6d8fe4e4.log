157487d425734a37ac32fe709ff20b8f6d8fe4e4
==================================================
Treat empty token at end the same way as empty token at start/middle
==================================================
Mark Thomas
==================================================
Tue Jun 8 11:27:33 2021 +0100
==================================================
TokenList.java
Treat empty token at end the same way as empty token at start/middle


==================================================
TestTokenList.java
index 0ab7ce1980..01ac449644 100644
--- a/java/org/apache/tomcat/util/http/parser/TokenList.java
+++ b/java/org/apache/tomcat/util/http/parser/TokenList.java
@@ -84,7 +84,8 @@ public class TokenList {
             }
 
             if (fieldName.length() == 0) {
-                // No more data to read
+                // Unexpected EOF. Should have been a token.
+                invalid = true;
                 break;
             }
 

==================================================
