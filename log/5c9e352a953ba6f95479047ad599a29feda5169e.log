5c9e352a953ba6f95479047ad599a29feda5169e
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50721
==================================================
Mark Emlyn
==================================================
Wed Feb 9 23:41:32 2011 +0000
==================================================
RequestUtil.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50721
Correctly handle URL decoding where the URL ends in %nn.
Patch (for fix) provided by Christof Marti.
Additional test cases added.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1069170 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestRequestUtil.java
index 1aab53974c..9333d95f31 100644
--- a/java/org/apache/catalina/util/RequestUtil.java
+++ b/java/org/apache/catalina/util/RequestUtil.java
@@ -326,7 +326,7 @@ public final class RequestUtil {
             if (b == '+' && isQuery) {
                 b = (byte)' ';
             } else if (b == '%') {
-                if (ix + 2 >= len) {
+                if (ix + 2 > len) {
                     throw new IllegalArgumentException(
                             sm.getString("requestUtil.urlDecode.missingDigit"));
                 }

==================================================
