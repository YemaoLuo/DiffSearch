14406c0b49c29fd05dd8f707b62ece38429e16f8
==================================================
Use a separate mbean type for SocketProperties
==================================================
remm remm@apache.org
==================================================
Mon Apr 6 13:36:10 2020 +0200
==================================================
AbstractEndpoint.java
Use a separate mbean type for SocketProperties

A subType seems to not be handled well by some tools so it's likely more
robust to avoid it. Inspired by BZ64314, and similarly I cannot see the
mbean in visualvm.


==================================================
TestRegistration.java
index ba3076747b..23a2c16016 100644
--- a/java/org/apache/tomcat/util/net/AbstractEndpoint.java
+++ b/java/org/apache/tomcat/util/net/AbstractEndpoint.java
@@ -1131,7 +1131,7 @@ public abstract class AbstractEndpoint<S,U> {
             Registry.getRegistry(null, null).registerComponent(this, oname, null);
 
             ObjectName socketPropertiesOname = new ObjectName(domain +
-                    ":type=ThreadPool,name=\"" + getName() + "\",subType=SocketProperties");
+                    ":type=SocketProperties,name=\"" + getName() + "\"");
             socketProperties.setObjectName(socketPropertiesOname);
             Registry.getRegistry(null, null).registerComponent(socketProperties, socketPropertiesOname, null);
 

==================================================
