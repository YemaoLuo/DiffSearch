fce56bbf2152252aa5b380b3eaea9de5df1bc340
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60400
==================================================
Violeta Georgieva
==================================================
Fri Nov 25 14:14:29 2016 +0000
==================================================
InputBuffer.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60400
When expanding the buffer used for reading the request body, ensure the read position will be restored to the original one.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1771316 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestInputBuffer.java
index e2e7eaa289..5f711f2173 100644
--- a/java/org/apache/catalina/connector/InputBuffer.java
+++ b/java/org/apache/catalina/connector/InputBuffer.java
@@ -666,9 +666,11 @@ public class InputBuffer extends Reader
         }
 
         CharBuffer tmp = CharBuffer.allocate(newSize);
+        int oldPosition = cb.position();
         cb.position(0);
         tmp.put(cb);
         tmp.flip();
+        tmp.position(oldPosition);
         cb = tmp;
         tmp = null;
     }

==================================================
