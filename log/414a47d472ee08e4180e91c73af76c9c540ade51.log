414a47d472ee08e4180e91c73af76c9c540ade51
==================================================
Simplify to align NIO2 with NIO and APR.
==================================================
Mark Thomas
==================================================
Thu Jan 29 20:41:57 2015 +0000
==================================================
AbstractHttp11Processor.java
Simplify to align NIO2 with NIO and APR.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1655849 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11Nio2Processor.java
index 101140b871..531d0736df 100644
--- a/java/org/apache/coyote/http11/AbstractHttp11Processor.java
+++ b/java/org/apache/coyote/http11/AbstractHttp11Processor.java
@@ -1781,7 +1781,11 @@ public abstract class AbstractHttp11Processor<S> extends AbstractProcessor<S> {
             } else {
                 getInputBuffer().nextRequest();
                 getOutputBuffer().nextRequest();
-                return SocketState.OPEN;
+                if (socketWrapper.isReadPending()) {
+                    return SocketState.LONG;
+                } else {
+                    return SocketState.OPEN;
+                }
             }
         }
     }

==================================================
