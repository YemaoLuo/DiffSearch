393f2d4b47fac777d8a3dfefea42c0f8e5a05971
==================================================
Make sure connections are only kept open for keep alive.
==================================================
Mark Emlyn
==================================================
Wed Sep 7 12:36:31 2011 +0000
==================================================
Http11AprProcessor.java
Make sure connections are only kept open for keep alive.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1166151 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11Processor.java
index c79852cffb..9918980b05 100644
--- a/java/org/apache/coyote/http11/Http11AprProcessor.java
+++ b/java/org/apache/coyote/http11/Http11AprProcessor.java
@@ -219,7 +219,7 @@ public class Http11AprProcessor extends AbstractHttp11Processor<Long> {
 
     @Override
     protected boolean breakKeepAliveLoop(SocketWrapper<Long> socketWrapper) {
-        openSocket = true;
+        openSocket = keepAlive;
         // Do sendfile as needed: add socket to sendfile and end
         if (sendfileData != null && !error) {
             sendfileData.socket = socketWrapper.getSocket().longValue();

==================================================
