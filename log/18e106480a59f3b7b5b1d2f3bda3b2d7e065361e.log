18e106480a59f3b7b5b1d2f3bda3b2d7e065361e
==================================================
Try to get the member uid from the cloud, it seems more appropriate overall.
==================================================
Remy Maucherat
==================================================
Mon Oct 15 08:39:26 2018 +0000
==================================================
CloudMembershipService.java
Try to get the member uid from the cloud, it seems more appropriate overall.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1843886 13f79535-47bb-0310-9956-ffa450edef68



==================================================
KubernetesMembershipProvider.java
index b5543c0eb4..71200e9fc3 100644
--- a/java/org/apache/catalina/tribes/membership/cloud/CloudMembershipService.java
+++ b/java/org/apache/catalina/tribes/membership/cloud/CloudMembershipService.java
@@ -18,9 +18,6 @@
 package org.apache.catalina.tribes.membership.cloud;
 
 import java.io.IOException;
-import java.net.InetAddress;
-import java.security.MessageDigest;
-import java.security.NoSuchAlgorithmException;
 
 import javax.management.ObjectName;
 
@@ -42,6 +39,7 @@ public class CloudMembershipService extends MembershipServiceBase {
     public static final String MEMBERSHIP_PROVIDER_CLASS_NAME = "membershipProviderClassName";
     private static final String KUBE = "kubernetes";
     private static final String KUBE_PROVIDER_CLASS = "org.apache.catalina.tribes.membership.cloud.KubernetesMembershipProvider";
+    static final byte[] INITIAL_ID = new byte[16];
 
     private MembershipProvider membershipProvider;
     private MemberImpl localMember;
@@ -173,13 +171,7 @@ public class CloudMembershipService extends MembershipServiceBase {
 
         if (localMember == null) {
             localMember = new MemberImpl();
-            try {
-                // Set localMember unique ID to md5 hash of hostname
-                localMember.setUniqueId(MessageDigest.getInstance("md5")
-                        .digest(InetAddress.getLocalHost().getHostName().getBytes()));
-            } catch (NoSuchAlgorithmException e) {
-                throw new IOException(e);
-            }
+            localMember.setUniqueId(INITIAL_ID);
             localMember.setLocal(true);
         }
         localMember.setHostname(host);

==================================================
