76762308fbb2cf834b941761bd7ba5b0bc4c4b75
==================================================
Expand the fix in 1636063 to include imports of static fields.
==================================================
Mark Emlyn
==================================================
Sat Nov 1 22:07:55 2014 +0000
==================================================
ScopedAttributeELResolver.java
Expand the fix in 1636063 to include imports of static fields.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1636066 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestELInJsp.java
index 70e6cb2d26..73b16af204 100644
--- a/java/javax/servlet/jsp/el/ScopedAttributeELResolver.java
+++ b/java/javax/servlet/jsp/el/ScopedAttributeELResolver.java
@@ -56,13 +56,27 @@ public class ScopedAttributeELResolver extends ELResolver {
                 result = page.findAttribute(key);
 
                 if (result == null) {
-                    // This might be the name of an import class
+                    // This might be the name of an imported class
                     ImportHandler importHandler = context.getImportHandler();
                     if (importHandler != null) {
                         Class<?> clazz = importHandler.resolveClass(key);
                         if (clazz != null) {
                             result = new ELClass(clazz);
                         }
+                        if (result == null) {
+                            // This might be the name of an imported static field
+                            clazz = importHandler.resolveStatic(key);
+                            if (clazz != null) {
+                                try {
+                                    result = clazz.getField(key).get(null);
+                                } catch (IllegalArgumentException | IllegalAccessException |
+                                        NoSuchFieldException | SecurityException e) {
+                                    // Most (all?) of these should have been
+                                    // prevented by the checks when the import
+                                    // was defined.
+                                }
+                            }
+                        }
                     }
                 }
             }

==================================================
