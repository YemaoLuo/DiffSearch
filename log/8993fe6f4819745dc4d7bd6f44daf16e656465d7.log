8993fe6f4819745dc4d7bd6f44daf16e656465d7
==================================================
Correct a bug in the PushBuilder implementation that meant push URLs containing %nn sequences were not correctly decoded. Identified by FindBugs.
==================================================
Mark Thomas
==================================================
Wed Jul 26 09:36:29 2017 +0000
==================================================
ApplicationPushBuilder.java
Correct a bug in the PushBuilder implementation that meant push URLs containing %nn sequences were not correctly decoded. Identified by FindBugs.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1803030 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestApplicationPushBuilder.java
index d4893a38c3..7ec75c08e1 100644
--- a/java/org/apache/catalina/core/ApplicationPushBuilder.java
+++ b/java/org/apache/catalina/core/ApplicationPushBuilder.java
@@ -382,7 +382,7 @@ public class ApplicationPushBuilder implements PushBuilder {
 
         StringBuilder result = new StringBuilder(input.length());
         while (start != -1) {
-            // Found the start of a %nn sequence. Copy everything form the last
+            // Found the start of a %nn sequence. Copy everything from the last
             // end to this start to the output.
             result.append(input.substring(end, start));
             // Advance the end 3 characters: %nn
@@ -403,7 +403,7 @@ public class ApplicationPushBuilder implements PushBuilder {
     private static String decodePercentSequence(String sequence, Charset charset) {
         byte[] bytes = new byte[sequence.length()/3];
         for (int i = 0; i < bytes.length; i += 3) {
-            bytes[i] = (byte) (HexUtils.getDec(sequence.charAt(1 + 3 * i)) << 4 +
+            bytes[i] = (byte) ((HexUtils.getDec(sequence.charAt(1 + 3 * i)) << 4) +
                     HexUtils.getDec(sequence.charAt(2 + 3 * i)));
         }
 

==================================================
