fae26ce495a116cb8ad7184b792971e8a268676c
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46866
==================================================
Mark Emlyn
==================================================
Thu Mar 26 11:06:06 2009 +0000
==================================================
StandardServer.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46866
Better init of Random

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@758596 13f79535-47bb-0310-9956-ffa450edef68



==================================================
UUIDGenerator.java
index 3c7099c775..184972f6c6 100644
--- a/java/org/apache/catalina/core/StandardServer.java
+++ b/java/org/apache/catalina/core/StandardServer.java
@@ -420,7 +420,7 @@ public final class StandardServer
             int expected = 1024; // Cut off to avoid DoS attack
             while (expected < shutdown.length()) {
                 if (random == null)
-                    random = new Random(System.currentTimeMillis());
+                    random = new Random();
                 expected += (random.nextInt() % 1024);
             }
             while (expected > 0) {

==================================================
LoadTest.java
index 4514f49a9a..2fc83a1c0f 100644
--- a/java/org/apache/catalina/tribes/util/UUIDGenerator.java
+++ b/java/org/apache/catalina/tribes/util/UUIDGenerator.java
@@ -31,7 +31,7 @@ public class UUIDGenerator {
     public static final int BITS_PER_BYTE = 8;
     
     protected static SecureRandom secrand = null;
-    protected static Random rand = new Random(System.currentTimeMillis());
+    protected static Random rand = new Random();
     static {
         secrand = new SecureRandom();
         secrand.setSeed(rand.nextLong());

==================================================
MapDemo.java
index 35cb795023..38e303c8f9 100644
--- a/test/org/apache/catalina/tribes/demos/LoadTest.java
+++ b/test/org/apache/catalina/tribes/demos/LoadTest.java
@@ -251,7 +251,7 @@ public class LoadTest implements MembershipListener,ChannelListener, Runnable {
     public static class LoadMessage extends ByteMessage {
         
         public static byte[] outdata = new byte[size];
-        public static Random r = new Random(System.currentTimeMillis());
+        public static Random r = new Random();
         public static int getMessageSize (LoadMessage msg) {
             return msg.getMessage().length;
         }

==================================================
TestDataIntegrity.java
index 0f67e88323..08db8e616b 100644
--- a/test/org/apache/catalina/tribes/demos/MapDemo.java
+++ b/test/org/apache/catalina/tribes/demos/MapDemo.java
@@ -399,7 +399,7 @@ public class MapDemo implements ChannelListener, MembershipListener{
             dataModel.getValueAt(-1,-1);
         }
 
-        public static Random random = new Random(System.currentTimeMillis());
+        public static Random random = new Random();
         public static String random(int count, int start, int end, boolean letters, boolean numbers,
                                     char[] chars ) {
             if (count == 0) {

==================================================
TestMulticastPackages.java
index 63a71b4683..c5bf7b3592 100644
--- a/test/org/apache/catalina/tribes/test/channel/TestDataIntegrity.java
+++ b/test/org/apache/catalina/tribes/test/channel/TestDataIntegrity.java
@@ -166,7 +166,7 @@ public class TestDataIntegrity extends TestCase {
         public int length;
         public byte[] data;
         public byte key;
-        public static Random r = new Random(System.currentTimeMillis());
+        public static Random r = new Random();
         public static Data createRandomData() {
             int i = r.nextInt();
             i = ( i % 127 );

==================================================
TestRemoteProcessException.java
index 4074a458c7..33e8eb9d6b 100644
--- a/test/org/apache/catalina/tribes/test/channel/TestMulticastPackages.java
+++ b/test/org/apache/catalina/tribes/test/channel/TestMulticastPackages.java
@@ -198,7 +198,7 @@ public class TestMulticastPackages extends TestCase {
         public byte[] data;
         public byte key;
         public boolean hasNr = false;
-        public static Random r = new Random(System.currentTimeMillis());
+        public static Random r = new Random();
         public static Data createRandomData() {
             return createRandomData(ChannelReceiver.MAX_UDP_SIZE);
         }

==================================================
TestUdpPackages.java
index ac8c22f503..03b051a0f6 100644
--- a/test/org/apache/catalina/tribes/test/channel/TestRemoteProcessException.java
+++ b/test/org/apache/catalina/tribes/test/channel/TestRemoteProcessException.java
@@ -112,7 +112,7 @@ public class TestRemoteProcessException extends TestCase {
         public byte[] data;
         public byte key;
         public boolean error = false;
-        public static Random r = new Random(System.currentTimeMillis());
+        public static Random r = new Random();
         public static Data createRandomData(boolean error) {
             int i = r.nextInt();
             i = ( i % 127 );

==================================================
TestSenderConnections.java
index 5ed1b9a945..5af6411fbd 100644
--- a/test/org/apache/catalina/tribes/test/channel/TestUdpPackages.java
+++ b/test/org/apache/catalina/tribes/test/channel/TestUdpPackages.java
@@ -240,7 +240,7 @@ public class TestUdpPackages extends TestCase {
         public byte[] data;
         public byte key;
         public boolean hasNr = false;
-        public static Random r = new Random(System.currentTimeMillis());
+        public static Random r = new Random();
         public static Data createRandomData() {
             return createRandomData(ChannelReceiver.MAX_UDP_SIZE);
         }

==================================================
