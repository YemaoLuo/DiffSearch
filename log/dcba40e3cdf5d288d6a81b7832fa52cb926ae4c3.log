dcba40e3cdf5d288d6a81b7832fa52cb926ae4c3
==================================================
Add an empty non login, add the modules to the list, cleanup.
==================================================
Remy Maucherat
==================================================
Fri Oct 23 10:58:26 2015 +0000
==================================================
TomcatAuthConfig.java
Add an empty non login, add the modules to the list, cleanup.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1710170 13f79535-47bb-0310-9956-ffa450edef68



==================================================
NonLoginAuthModule.java
index 2ec1bb933d..0a61ade255 100644
--- a/java/org/apache/catalina/authenticator/jaspic/provider/TomcatAuthConfig.java
+++ b/java/org/apache/catalina/authenticator/jaspic/provider/TomcatAuthConfig.java
@@ -31,6 +31,9 @@ import org.apache.catalina.Realm;
 import org.apache.catalina.authenticator.jaspic.provider.modules.BasicAuthModule;
 import org.apache.catalina.authenticator.jaspic.provider.modules.DigestAuthModule;
 import org.apache.catalina.authenticator.jaspic.provider.modules.FormAuthModule;
+import org.apache.catalina.authenticator.jaspic.provider.modules.NonLoginAuthModule;
+import org.apache.catalina.authenticator.jaspic.provider.modules.SSLAuthModule;
+import org.apache.catalina.authenticator.jaspic.provider.modules.SpnegoAuthModule;
 import org.apache.catalina.authenticator.jaspic.provider.modules.TomcatAuthModule;
 import org.apache.tomcat.util.descriptor.web.LoginConfig;
 import org.apache.tomcat.util.res.StringManager;
@@ -123,20 +126,22 @@ public class TomcatAuthConfig implements ServerAuthConfig {
     private TomcatAuthModule getModule() throws AuthException {
         String authMethod = getAuthMethod();
         switch (authMethod) {
-        case "BASIC": {
+        case "BASIC":
             return new BasicAuthModule(context);
-        }
-        case "DIGEST": {
+        case "DIGEST":
             return new DigestAuthModule(context);
-        }
-        case "FORM": {
+        case "FORM":
             return new FormAuthModule(context);
-        }
-        default: {
+        case "NONE":
+            return new NonLoginAuthModule(context);
+        case "SPNEGO":
+            return new SpnegoAuthModule(context);
+        case "CLIENT-CERT":
+            return new SSLAuthModule(context);
+        default:
             throw new AuthException(
                     sm.getString("authenticator.jaspic.unknownAuthType", authMethod));
         }
-        }
     }
 
 

==================================================
TestJaspicBasicAuthenticator.java
index d6736da4db..70b52397ee 100644
--- a/java/org/apache/catalina/startup/Authenticators.properties
+++ b/java/org/apache/catalina/startup/Authenticators.properties
@@ -19,4 +19,3 @@ DIGEST=org.apache.catalina.authenticator.DigestAuthenticator
 FORM=org.apache.catalina.authenticator.FormAuthenticator
 NONE=org.apache.catalina.authenticator.NonLoginAuthenticator
 SPNEGO=org.apache.catalina.authenticator.SpnegoAuthenticator
-JASPIC-BASIC=org.apache.catalina.authenticator.jaspic.JaspicAuthenticator
\ No newline at end of file

==================================================
