3509e957d8ace0cddec0df24215f02025c970c8d
==================================================
Couple more container based locations.
==================================================
Mark Emlyn
==================================================
Thu Feb 2 10:31:39 2012 +0000
==================================================
ContextConfig.java
Couple more container based locations.
Really need to move setting this to the server.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1239521 13f79535-47bb-0310-9956-ffa450edef68



==================================================
HostConfig.java
index 05f5d684ee..45e9cc7278 100644
--- a/java/org/apache/catalina/startup/ContextConfig.java
+++ b/java/org/apache/catalina/startup/ContextConfig.java
@@ -1097,8 +1097,12 @@ public class ContextConfig implements LifecycleListener {
      * Get config base.
      */
     protected File getConfigBase() {
-        File configBase =
-            new File(System.getProperty(Globals.CATALINA_BASE_PROP), "conf");
+        File catalinaBase = context.getCatalinaBase();
+        if (catalinaBase == null) {
+            return null;
+        }
+
+        File configBase = new File(catalinaBase, "conf");
         if (!configBase.exists()) {
             return null;
         }

==================================================
