9920180d2b3dccaed5b580b3bd5b8a206e7d3ad2
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59925
==================================================
Mark Thomas
==================================================
Tue Aug 9 20:31:11 2016 +0000
==================================================
LegacyCookieProcessor.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=59925
Correct regression in r1628368 and ensure that HTTP separators are handled as configured.
Patch provided by Kyohei Nakamura.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1755646 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestLegacyCookieProcessor.java
index e0822b776c..2cf1b52cd2 100644
--- a/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
+++ b/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
@@ -515,7 +515,7 @@ public final class LegacyCookieProcessor implements CookieProcessor {
                     break;
                 default:
                     if (version == 0 &&
-                                isV0Separator((char)bytes[pos]) &&
+                                !isV0Separator((char)bytes[pos]) &&
                                 getAllowHttpSepsInV0() ||
                             !isHttpSeparator((char)bytes[pos]) ||
                             bytes[pos] == '=') {

==================================================
