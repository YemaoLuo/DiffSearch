8f503ed918271967ff33c910eb03440e6cf5a90d
==================================================
The AECDH alias is for "anonymous Elliptic Curve Diffie Hellman cipher suites". Parser was returning non-anonymous ECDH cipher suites.
==================================================
Mark Emlyn
==================================================
Fri Aug 1 10:48:28 2014 +0000
==================================================
OpenSSLCipherConfigurationParser.java
The AECDH alias is for "anonymous Elliptic Curve Diffie Hellman cipher suites". Parser was returning non-anonymous ECDH cipher suites.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1615068 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestOpenSSLCipherConfigurationParser.java
index caf91ca974..f999b0c183 100644
--- a/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
+++ b/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
@@ -415,9 +415,8 @@ public class OpenSSLCipherConfigurationParser {
         addListAlias(aDSS, filterByAuthentication(allCiphers, Collections.singleton(Authentication.DSS)));
         aliases.put("DSS", aliases.get(aDSS));
         addListAlias(aDH, filterByAuthentication(allCiphers, Collections.singleton(Authentication.DH)));
-        Set<Cipher> aecdh = filterByKeyExchange(allCiphers, new HashSet<>(Arrays.asList(KeyExchange.ECDHe, KeyExchange.ECDHr)));
-        aecdh.removeAll(filterByAuthentication(allCiphers, Collections.singleton(Authentication.aNULL)));
-        addListAlias(AECDH, aecdh);
+        Set<Cipher> aecdh = filterByKeyExchange(allCiphers, new HashSet<>(Arrays.asList(KeyExchange.EECDH)));
+        addListAlias(AECDH, filterByAuthentication(aecdh, Collections.singleton(Authentication.aNULL)));
         addListAlias(aECDH, filterByAuthentication(allCiphers, Collections.singleton(Authentication.ECDH)));
         addListAlias(ECDSA, filterByAuthentication(allCiphers, Collections.singleton(Authentication.ECDSA)));
         aliases.put(aECDSA, aliases.get(ECDSA));

==================================================
