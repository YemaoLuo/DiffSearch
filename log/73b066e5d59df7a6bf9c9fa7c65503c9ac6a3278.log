73b066e5d59df7a6bf9c9fa7c65503c9ac6a3278
==================================================
More alias tests.
==================================================
Mark Emlyn
==================================================
Thu Jul 31 20:19:21 2014 +0000
==================================================
OpenSSLCipherConfigurationParser.java
More alias tests.
Align behaviour for RSA alias with OpenSSL.
Despite what the docs say, RSA is equivalent to kRSA. I've double checked this with the 'official' Windows binary, the binary that ships tc native and the latest FreeBSD version.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1614999 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestOpenSSLCipherConfigurationParser.java
index b610665e81..0c39cd8ddb 100644
--- a/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
+++ b/java/org/apache/tomcat/util/net/jsse/openssl/OpenSSLCipherConfigurationParser.java
@@ -120,7 +120,8 @@ public class OpenSSLCipherConfigurationParser {
      */
     private static final String aRSA = "aRSA";
     /**
-     * Cipher suites using RSA for key exchange or for authentication.
+     * Cipher suites using RSA for key exchange
+     * Despite what the docs say, RSA is equivalent to kRSA.
      */
     private static final String RSA = "RSA";
     /**
@@ -389,7 +390,8 @@ public class OpenSSLCipherConfigurationParser {
         addListAlias(aNULL, filterByAuthentication(all, Collections.singleton(Authentication.aNULL)));
         addListAlias(kRSA, filterByKeyExchange(all, Collections.singleton(KeyExchange.RSA)));
         addListAlias(aRSA, filterByAuthentication(all, Collections.singleton(Authentication.RSA)));
-        addListAlias(RSA, filter(all, null, Collections.singleton(KeyExchange.RSA), Collections.singleton(Authentication.RSA), null, null, null));
+        // Despite what the docs say, RSA is equivalent to kRSA
+        aliases.put(RSA, aliases.get(kRSA));
         addListAlias(kEDH, filterByKeyExchange(all, Collections.singleton(KeyExchange.EDH)));
         addListAlias(kDHE, filterByKeyExchange(all, Collections.singleton(KeyExchange.EDH)));
         Set<Cipher> edh = filterByKeyExchange(all, Collections.singleton(KeyExchange.EDH));

==================================================
TesterOpenSSL.java
index de31cec39e..6603163292 100644
--- a/test/org/apache/tomcat/util/net/jsse/openssl/TestOpenSSLCipherConfigurationParser.java
+++ b/test/org/apache/tomcat/util/net/jsse/openssl/TestOpenSSLCipherConfigurationParser.java
@@ -24,14 +24,14 @@ import org.junit.Test;
 public class TestOpenSSLCipherConfigurationParser {
 
     @Test
-    public void testENull() throws Exception {
-        testSpecification("eNULL");
+    public void testANull() throws Exception {
+        testSpecification("aNULL");
     }
 
 
     @Test
-    public void testANull() throws Exception {
-        testSpecification("aNULL");
+    public void testeNull() throws Exception {
+        testSpecification("eNULL");
     }
 
 
@@ -59,6 +59,30 @@ public class TestOpenSSLCipherConfigurationParser {
     }
 
 
+    @Test
+    public void testExport() throws Exception {
+        testSpecification("EXPORT");
+    }
+
+
+    @Test
+    public void testRsa() throws Exception {
+        testSpecification("RSA");
+    }
+
+
+    @Test
+    public void testARsa() throws Exception {
+        testSpecification("aRSA");
+    }
+
+
+    @Test
+    public void testKRsa() throws Exception {
+        testSpecification("kRSA");
+    }
+
+
     private void testSpecification(String specification) throws Exception {
         // Filter out cipher suites that OpenSSL does not implement
         String parserSpecification = "" + specification;

==================================================
