c513be9c936b6de9f275f3efdb08db65c1e4626d
==================================================
Align the XML parser configuration between the Digester (web.xml, web-fragment.xml, *.tld) and JspDocumentParser (*.jspx, *.tagx)
==================================================
Mark Emlyn
==================================================
Thu Nov 21 15:13:39 2013 +0000
==================================================
JspDocumentParser.java
Align the XML parser configuration between the Digester (web.xml, web-fragment.xml, *.tld) and JspDocumentParser (*.jspx, *.tagx)

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1544208 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Digester.java
index 30137f7f85..57bbca663b 100644
--- a/java/org/apache/jasper/compiler/JspDocumentParser.java
+++ b/java/org/apache/jasper/compiler/JspDocumentParser.java
@@ -1423,16 +1423,24 @@ class JspDocumentParser
         throws Exception {
 
         SAXParserFactory factory = SAXParserFactory.newInstance();
-        factory.setNamespaceAware(true);
 
+        factory.setNamespaceAware(true);
         // Preserve xmlns attributes
         factory.setFeature(
             "http://xml.org/sax/features/namespace-prefixes",
             true);
+
         factory.setValidating(validating);
-        //factory.setFeature(
-        //    "http://xml.org/sax/features/validation",
-        //    validating);
+        if (validating) {
+            // Enable DTD validation
+            factory.setFeature(
+                    "http://xml.org/sax/features/validation",
+                    true);
+            // Enable schema validation
+            factory.setFeature(
+                    "http://apache.org/xml/features/validation/schema",
+                    true);
+        }
 
         // Configure the parser
         SAXParser saxParser = factory.newSAXParser();

==================================================
