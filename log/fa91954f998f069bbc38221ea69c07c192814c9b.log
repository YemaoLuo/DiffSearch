fa91954f998f069bbc38221ea69c07c192814c9b
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43150
==================================================
Mark Emlyn
==================================================
Thu May 1 21:25:01 2008 +0000
==================================================
ClassLoaderFactory.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43150
# in installation path stops Tomcat starting

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@652669 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JspCompilationContext.java
index a9d36b717d..53943492ea 100644
--- a/java/org/apache/catalina/startup/ClassLoaderFactory.java
+++ b/java/org/apache/catalina/startup/ClassLoaderFactory.java
@@ -121,7 +121,7 @@ public final class ClassLoaderFactory {
                 if (!file.exists() || !file.canRead())
                     continue;
                 file = new File(file.getCanonicalPath() + File.separator);
-                URL url = file.toURL();
+                URL url = file.toURI().toURL();
                 if (log.isDebugEnabled())
                     log.debug("  Including directory " + url);
                 list.add(url);
@@ -143,7 +143,7 @@ public final class ClassLoaderFactory {
                     File file = new File(directory, filenames[j]);
                     if (log.isDebugEnabled())
                         log.debug("  Including jar file " + file.getAbsolutePath());
-                    URL url = file.toURL();
+                    URL url = file.toURI().toURL();
                     list.add(url);
                 }
             }
@@ -201,7 +201,7 @@ public final class ClassLoaderFactory {
                     if (!directory.exists() || !directory.isDirectory() ||
                         !directory.canRead())
                          continue;
-                    URL url = directory.toURL();
+                    URL url = directory.toURI().toURL();
                     if (log.isDebugEnabled())
                         log.debug("  Including directory " + url);
                     list.add(url);
@@ -210,7 +210,7 @@ public final class ClassLoaderFactory {
                     file = new File(file.getCanonicalPath());
                     if (!file.exists() || !file.canRead())
                         continue;
-                    URL url = file.toURL();
+                    URL url = file.toURI().toURL();
                     if (log.isDebugEnabled())
                         log.debug("  Including jar file " + url);
                     list.add(url);
@@ -234,7 +234,7 @@ public final class ClassLoaderFactory {
                         if (log.isDebugEnabled())
                             log.debug("    Including glob jar file "
                                 + file.getAbsolutePath());
-                        URL url = file.toURL();
+                        URL url = file.toURI().toURL();
                         list.add(url);
                     }
                 }

==================================================
