a9548060156d94e4b25e0e7485a097dd429f4b6c
==================================================
https://issues.apache.org/bugzilla/show_bug.cgi?id=49228
==================================================
Mark Emlyn
==================================================
Tue May 11 15:53:10 2010 +0000
==================================================
Validator.java
https://issues.apache.org/bugzilla/show_bug.cgi?id=49228
Use English Locale since other Locale's may give add results

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@943155 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Util.java
index 8489e55c03..25a659dac3 100644
--- a/java/org/apache/jasper/compiler/Validator.java
+++ b/java/org/apache/jasper/compiler/Validator.java
@@ -22,6 +22,7 @@ import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.Hashtable;
 import java.util.Iterator;
+import java.util.Locale;
 
 import javax.el.ELException;
 import javax.el.ExpressionFactory;
@@ -330,7 +331,7 @@ class Validator {
 
             Node.Root root = pageDir.getRoot();
             String configEnc = root.getJspConfigPageEncoding();
-            String pageDirEnc = thePageDirEnc.toUpperCase();
+            String pageDirEnc = thePageDirEnc.toUpperCase(Locale.ENGLISH);
 
             /*
              * Compare the 'pageEncoding' attribute of the page directive with
@@ -339,7 +340,7 @@ class Validator {
              * "UTF-16LE" as identical.
              */
             if (configEnc != null) {
-                configEnc = configEnc.toUpperCase();
+                configEnc = configEnc.toUpperCase(Locale.ENGLISH);
                 if (!pageDirEnc.equals(configEnc)
                         && (!pageDirEnc.startsWith("UTF-16") || !configEnc
                                 .startsWith("UTF-16"))) {
@@ -359,7 +360,7 @@ class Validator {
              * identical.
              */
             if ((root.isXmlSyntax() && root.isEncodingSpecifiedInProlog()) || root.isBomPresent()) {
-                String pageEnc = root.getPageEncoding().toUpperCase();
+                String pageEnc = root.getPageEncoding().toUpperCase(Locale.ENGLISH);
                 if (!pageDirEnc.equals(pageEnc)
                         && (!pageDirEnc.startsWith("UTF-16") || !pageEnc
                                 .startsWith("UTF-16"))) {
@@ -387,7 +388,7 @@ class Validator {
                 Node.TagDirective pageDir) throws JasperException {
 
             Node.Root root = pageDir.getRoot();
-            String pageDirEnc = thePageDirEnc.toUpperCase();
+            String pageDirEnc = thePageDirEnc.toUpperCase(Locale.ENGLISH);
             /*
              * Compare the 'pageEncoding' attribute of the page directive with
              * the encoding specified in the XML prolog (only for XML syntax,
@@ -396,7 +397,7 @@ class Validator {
              * identical.
              */
             if ((root.isXmlSyntax() && root.isEncodingSpecifiedInProlog()) || root.isBomPresent()) {
-                String pageEnc = root.getPageEncoding().toUpperCase();
+                String pageEnc = root.getPageEncoding().toUpperCase(Locale.ENGLISH);
                 if (!pageDirEnc.equals(pageEnc)
                         && (!pageDirEnc.startsWith("UTF-16") || !pageEnc
                                 .startsWith("UTF-16"))) {

==================================================
