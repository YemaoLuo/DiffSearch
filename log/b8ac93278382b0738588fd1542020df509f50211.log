b8ac93278382b0738588fd1542020df509f50211
==================================================
sync up from 6.0
==================================================
Filip Hanik
==================================================
Fri Jul 20 22:24:26 2007 +0000
==================================================
JDBCStore.java
sync up from 6.0
http://svn.apache.org/viewvc?view=rev&rev=553716
http://svn.apache.org/viewvc?view=rev&rev=554109 



git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@558177 13f79535-47bb-0310-9956-ffa450edef68



==================================================
CookieTools.java
index 685f85e585..e7ce2cd6bf 100644
--- a/java/org/apache/catalina/session/JDBCStore.java
+++ b/java/org/apache/catalina/session/JDBCStore.java
@@ -970,7 +970,7 @@ public class JDBCStore
 
     /**
      * Gracefully terminate everything associated with our db.
-     * Called once when this Store is stoping.
+     * Called once when this Store is stopping.
      *
      */
     public void stop() throws LifecycleException {

==================================================
JkMain.java
index dc834114c0..e69de29bb2 100644
--- a/java/org/apache/catalina/util/CookieTools.java
+++ b/java/org/apache/catalina/util/CookieTools.java
@@ -1,159 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- * 
- *      http://www.apache.org/licenses/LICENSE-2.0
- * 
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-
-package org.apache.catalina.util;
-
-import java.text.*;
-import java.util.*;
-
-import javax.servlet.http.Cookie;
-
-// XXX use only one Date instance/request, reuse it.
-
-/**
- * Cookie utils - generate cookie header, etc
- *
- * @author Original Author Unknown
- * @author duncan@eng.sun.com
- */
-public class CookieTools {
-
-    /** Return the header name to set the cookie, based on cookie
-     *  version
-     */
-    public static String getCookieHeaderName(Cookie cookie) {
-        int version = cookie.getVersion();
-
-        if (version == 1) {
-            return "Set-Cookie2";
-        } else {
-            return "Set-Cookie";
-        }
-    }
-
-    /** Return the header value used to set this cookie
-     *  @deprecated Use StringBuffer version
-     */
-    public static String getCookieHeaderValue(Cookie cookie) {
-        StringBuffer buf = new StringBuffer();
-        getCookieHeaderValue( cookie, buf );
-        return buf.toString();
-    }
-
-    /** Return the header value used to set this cookie
-     */
-    public static void getCookieHeaderValue(Cookie cookie, StringBuffer buf) {
-        int version = cookie.getVersion();
-
-        // this part is the same for all cookies
-
-        String name = cookie.getName();     // Avoid NPE on malformed cookies
-        if (name == null)
-            name = "";
-        String value = cookie.getValue();
-        if (value == null)
-            value = "";
-        
-        buf.append(name);
-        buf.append("=");
-        maybeQuote(version, buf, value);
-
-        // add version 1 specific information
-        if (version == 1) {
-            // Version=1 ... required
-            buf.append ("; Version=1");
-
-            // Comment=comment
-            if (cookie.getComment() != null) {
-                buf.append ("; Comment=");
-                maybeQuote (version, buf, cookie.getComment());
-            }
-        }
-
-        // add domain information, if present
-
-        if (cookie.getDomain() != null) {
-            buf.append("; Domain=");
-            maybeQuote (version, buf, cookie.getDomain());
-        }
-
-        // Max-Age=secs/Discard ... or use old "Expires" format
-        if (cookie.getMaxAge() >= 0) {
-            if (version == 0) {
-                buf.append ("; Expires=");
-                if (cookie.getMaxAge() == 0)
-                    DateTool.oldCookieFormat.format(new Date(10000), buf,
-                                                    new FieldPosition(0));
-                else
-                    DateTool.oldCookieFormat.format
-                        (new Date( System.currentTimeMillis() +
-                                   cookie.getMaxAge() *1000L), buf,
-                         new FieldPosition(0));
-            } else {
-                buf.append ("; Max-Age=");
-                buf.append (cookie.getMaxAge());
-            }
-        } else if (version == 1)
-          buf.append ("; Discard");
-
-        // Path=path
-        if (cookie.getPath() != null) {
-            buf.append ("; Path=");
-            maybeQuote (version, buf, cookie.getPath());
-        }
-
-        // Secure
-        if (cookie.getSecure()) {
-          buf.append ("; Secure");
-        }
-    }
-
-    static void maybeQuote (int version, StringBuffer buf,
-                                    String value)
-    {
-        if (version == 0 || isToken (value))
-            buf.append (value);
-        else {
-            buf.append ('"');
-            buf.append (value);
-            buf.append ('"');
-        }
-    }
-
-        //
-    // from RFC 2068, token special case characters
-    //
-    private static final String tspecials = "()<>@,;:\\\"/[]?={} \t";
-
-    /*
-     * Return true iff the string counts as an HTTP/1.1 "token".
-     */
-    private static boolean isToken (String value) {
-        int len = value.length ();
-
-        for (int i = 0; i < len; i++) {
-            char c = value.charAt (i);
-
-            if (c < 0x20 || c >= 0x7f || tspecials.indexOf (c) != -1)
-              return false;
-        }
-        return true;
-    }
-
-
-}

==================================================
