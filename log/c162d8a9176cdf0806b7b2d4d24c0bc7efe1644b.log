c162d8a9176cdf0806b7b2d4d24c0bc7efe1644b
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60963
==================================================
Mark Thomas
==================================================
Thu Jul 20 14:13:48 2017 +0000
==================================================
StandardContext.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60963
Add a new WebResourceRoot implementation that extracts JARs to the work directory for improved performance when deploying packed WAR files.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1802490 13f79535-47bb-0310-9956-ffa450edef68



==================================================
ExtractingRoot.java
index 19fe994e1d..fd449600a2 100644
--- a/java/org/apache/catalina/core/StandardContext.java
+++ b/java/org/apache/catalina/core/StandardContext.java
@@ -4864,6 +4864,9 @@ public class StandardContext extends ContainerBase
             namingResources.start();
         }
 
+        // Post work directory
+        postWorkDirectory();
+
         // Add missing components as necessary
         if (getResources() == null) {   // (1) Required by Loader
             if (log.isDebugEnabled())
@@ -4894,9 +4897,6 @@ public class StandardContext extends ContainerBase
         // Initialize character set mapper
         getCharsetMapper();
 
-        // Post work directory
-        postWorkDirectory();
-
         // Validate required extensions
         boolean dependencyCheck = true;
         try {

==================================================
StandardRoot.java
index 2f7921a03d..eea644a2b7 100644
--- a/java/org/apache/catalina/webresources/LocalStrings.properties
+++ b/java/org/apache/catalina/webresources/LocalStrings.properties
@@ -32,6 +32,9 @@ dirResourceSet.notDirectory=The directory specified by base and internal path [{
 dirResourceSet.writeExists=The target of the write already exists
 dirResourceSet.writeNpe=The input stream may not be null
 
+extractingRoot.targetFailed=Failed to create the directory [{0}] for extracted JAR files
+extractingRoot.jarFailed=Failed to extract the JAR file [{0}]
+
 fileResource.getCanonicalPathFail=Unable to determine the canonical path for the resource [{0}]
 fileResource.getCreationFail=Unable to determine the creation time for the resource [{0}]
 fileResource.getUrlFail=Unable to determine a URL for the resource [{0}]

==================================================
