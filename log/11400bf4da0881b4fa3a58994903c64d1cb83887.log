11400bf4da0881b4fa3a58994903c64d1cb83887
==================================================
Fill in some of the HTTP upgrade Javadoc
==================================================
Mark Emlyn
==================================================
Thu Oct 11 20:29:01 2012 +0000
==================================================
HttpServletRequest.java
Fill in some of the HTTP upgrade Javadoc

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1397291 13f79535-47bb-0310-9956-ffa450edef68



==================================================
HttpServletRequestWrapper.java
index f3f71083c9..a6865dfcf7 100644
--- a/java/javax/servlet/http/HttpServletRequest.java
+++ b/java/javax/servlet/http/HttpServletRequest.java
@@ -485,8 +485,9 @@ public interface HttpServletRequest extends ServletRequest {
             ServletException;
 
     /**
-     * TODO SERVLET 3.1
+     * Start the HTTP upgrade process and pass the connection to the provided
+     * protocol handler once the current request/response pair has completed
+     * processing.
      */
-    public abstract void upgrade(javax.servlet.http.ProtocolHandler handler)
-            throws java.io.IOException;
+    public void upgrade(ProtocolHandler handler) throws java.io.IOException;
 }

==================================================
ProtocolHandler.java
index fbddd512ec..33c71856cf 100644
--- a/java/javax/servlet/http/HttpServletRequestWrapper.java
+++ b/java/javax/servlet/http/HttpServletRequestWrapper.java
@@ -328,8 +328,7 @@ public class HttpServletRequestWrapper extends ServletRequestWrapper implements
      * {@inheritDoc}
      */
     @Override
-    public void upgrade(javax.servlet.http.ProtocolHandler handler)
-            throws java.io.IOException {
+    public void upgrade(ProtocolHandler handler) throws java.io.IOException {
         this._getHttpServletRequest().upgrade(handler);
     }
 }

==================================================
WebConnection.java
index 7018b2f981..b213d403ba 100644
--- a/java/javax/servlet/http/ProtocolHandler.java
+++ b/java/javax/servlet/http/ProtocolHandler.java
@@ -15,10 +15,19 @@
  * limitations under the License.
  */
 package javax.servlet.http;
+
 /**
- * TODO SERVLET 3.1
- *
+ * Interface between the HTTP upgrade process and the new protocol.
  */
 public interface ProtocolHandler {
-    public abstract void init(javax.servlet.http.WebConnection connection);
+
+    /**
+     * This method is called once the request/response pair where
+     * {@link HttpServletRequest#upgrade(ProtocolHandler) is called has
+     * completed processing and is the point where control of the connection
+     * passes from the container to the {@link ProtocolHandler}.
+     *
+     * @param connection    The connection that has been upgraded
+     */
+    void init(WebConnection connection);
 }

==================================================
