3db96344ae88bbbe799403f0836e63ea1314503c
==================================================
Remove support for certificateChainFile. httpd has deprecated it and it doesn't play nicely with multiple certificate types.
==================================================
Mark Thomas
==================================================
Fri Jun 19 14:29:03 2015 +0000
==================================================
AbstractHttp11Protocol.java
Remove support for certificateChainFile. httpd has deprecated it and it doesn't play nicely with multiple certificate types.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1686424 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AprEndpoint.java
index 8e66882790..ebbf26cb1b 100644
--- a/java/org/apache/coyote/http11/AbstractHttp11Protocol.java
+++ b/java/org/apache/coyote/http11/AbstractHttp11Protocol.java
@@ -574,12 +574,6 @@ public abstract class AbstractHttp11Protocol<S> extends AbstractProtocol<S> {
     }
 
 
-    public void setSSLCertificateChainFile(String certificateChainFile) {
-        registerDefaultSSLHostConfig();
-        defaultSSLHostConfig.setCertificateChainFile(certificateChainFile);
-    }
-
-
     public void setSSLCACertificatePath(String caCertificatePath) {
         registerDefaultSSLHostConfig();
         defaultSSLHostConfig.setCaCertificatePath(caCertificatePath);

==================================================
SSLHostConfig.java
index f95f227841..efd815ffcd 100644
--- a/java/org/apache/tomcat/util/net/AprEndpoint.java
+++ b/java/org/apache/tomcat/util/net/AprEndpoint.java
@@ -500,10 +500,6 @@ public class AprEndpoint extends AbstractEndpoint<Long> implements SNICallBack {
                         SSLHostConfig.adjustRelativePath(sslHostConfig.getCertificateFile()),
                         SSLHostConfig.adjustRelativePath(sslHostConfig.getCertificateKeyFile()),
                         sslHostConfig.getCertificateKeyPassword(), SSL.SSL_AIDX_RSA);
-                // Set certificate chain file
-                SSLContext.setCertificateChainFile(ctx,
-                        SSLHostConfig.adjustRelativePath(sslHostConfig.getCertificateChainFile()),
-                        false);
                 // Support Client Certificates
                 SSLContext.setCACertificate(ctx,
                         SSLHostConfig.adjustRelativePath(sslHostConfig.getCaCertificateFile()),

==================================================
OpenSSLContext.java
index f606dfc75e..23faab2426 100644
--- a/java/org/apache/tomcat/util/net/SSLHostConfig.java
+++ b/java/org/apache/tomcat/util/net/SSLHostConfig.java
@@ -88,7 +88,6 @@ public class SSLHostConfig {
     private String truststoreProvider = System.getProperty("javax.net.ssl.trustStoreProvider");
     private String truststoreType = System.getProperty("javax.net.ssl.trustStoreType");
     // OpenSSL
-    private String certificateChainFile;
     private String certificateFile;
     private String certificateKeyFile;
     private String certificateRevocationListPath;
@@ -476,17 +475,6 @@ public class SSLHostConfig {
 
     // ------------------------------- OpenSSL specific configuration properties
 
-    public void setCertificateChainFile(String certificateChainFile) {
-        setProperty("certificateChainFile", Type.OPENSSL);
-        this.certificateChainFile = certificateChainFile;
-    }
-
-
-    public String getCertificateChainFile() {
-        return certificateChainFile;
-    }
-
-
     public void setCertificateFile(String certificateFile) {
         setProperty("certificateFile", Type.OPENSSL);
         this.certificateFile = certificateFile;

==================================================
