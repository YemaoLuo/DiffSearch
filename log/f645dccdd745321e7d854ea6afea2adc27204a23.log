f645dccdd745321e7d854ea6afea2adc27204a23
==================================================
Drop the deprecated code.
==================================================
Mark Thomas
==================================================
Tue May 3 17:33:05 2016 +0000
==================================================
TldScanner.java
Drop the deprecated code.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1742148 13f79535-47bb-0310-9956-ffa450edef68



==================================================
JarScannerCallback.java
index 6a88c56fa6..49cfbe77b0 100644
--- a/java/org/apache/jasper/servlet/TldScanner.java
+++ b/java/org/apache/jasper/servlet/TldScanner.java
@@ -18,7 +18,6 @@ package org.apache.jasper.servlet;
 
 import java.io.File;
 import java.io.IOException;
-import java.net.JarURLConnection;
 import java.net.URL;
 import java.nio.file.FileVisitResult;
 import java.nio.file.Files;
@@ -295,12 +294,6 @@ public class TldScanner {
         private boolean foundJarWithoutTld = false;
         private boolean foundFileWithoutTld = false;
 
-        @Override
-        public void scan(JarURLConnection jarConn, String webappPath, boolean isWebapp)
-                throws IOException {
-            scan(jarConn.getURL(), webappPath, isWebapp);
-        }
-
 
         @Override
         public void scan(URL jarUrl, String webappPath, boolean isWebapp) throws IOException {

==================================================
FragmentJarScannerCallback.java
index 17847d30ca..b052b9968b 100644
--- a/java/org/apache/tomcat/JarScannerCallback.java
+++ b/java/org/apache/tomcat/JarScannerCallback.java
@@ -18,7 +18,6 @@ package org.apache.tomcat;
 
 import java.io.File;
 import java.io.IOException;
-import java.net.JarURLConnection;
 import java.net.URL;
 
 /**
@@ -27,28 +26,6 @@ import java.net.URL;
  */
 public interface JarScannerCallback {
 
-    /**
-     * A JAR was found and may be accessed for further processing via the
-     * provided URL connection.
-     *
-     * @param urlConn    The connection to the identified JAR
-     * @param webappPath The path, if any, to the JAR within the web application
-     * @param isWebapp   Indicates if the JAR was found within a web
-     *                       application. If <code>false</code> the JAR should
-     *                       be treated as being provided by the container
-     *
-     * @throws IOException if an I/O error occurs while scanning the JAR
-     *
-     * @deprecated Use {@link #scan(URL, String, boolean)} instead. Because the
-     *             urlConn parameter could refer directly to a JAR or to a JAR
-     *             as an entry in a WAR, it required further processing that
-     *             included obtaining the original URL. It is simpler to provide
-     *             the URL to start with..
-     */
-    @Deprecated
-    public void scan(JarURLConnection urlConn, String webappPath, boolean isWebapp)
-            throws IOException;
-
     /**
      * A JAR was found and may be accessed for further processing via the
      * provided URL connection.

==================================================
TestTldScanner.java
index 4913a3abf0..f03329bc87 100644
--- a/java/org/apache/tomcat/util/descriptor/web/FragmentJarScannerCallback.java
+++ b/java/org/apache/tomcat/util/descriptor/web/FragmentJarScannerCallback.java
@@ -20,7 +20,6 @@ import java.io.File;
 import java.io.FileInputStream;
 import java.io.IOException;
 import java.io.InputStream;
-import java.net.JarURLConnection;
 import java.net.URL;
 import java.util.HashMap;
 import java.util.Map;
@@ -50,12 +49,6 @@ public class FragmentJarScannerCallback implements JarScannerCallback {
         this.parseRequired = parseRequired;
     }
 
-    @Override
-    public void scan(JarURLConnection jarConn, String webappPath, boolean isWebapp)
-            throws IOException {
-        scan(jarConn.getURL(), webappPath, isWebapp);
-    }
-
 
     @Override
     public void scan(URL jarUrl, String webappPath, boolean isWebapp) throws IOException {

==================================================
TestStandardJarScanner.java
index 1a73d7d5c7..cd57323e48 100644
--- a/test/org/apache/jasper/servlet/TestTldScanner.java
+++ b/test/org/apache/jasper/servlet/TestTldScanner.java
@@ -18,7 +18,6 @@ package org.apache.jasper.servlet;
 
 import java.io.File;
 import java.lang.reflect.Constructor;
-import java.net.JarURLConnection;
 import java.net.URL;
 import java.util.HashMap;
 import java.util.List;
@@ -110,9 +109,7 @@ public class TestTldScanner extends TomcatBaseTest {
             throws Exception {
         String fullPath = new File(webapp, path).toURI().toString();
         URL jarUrl = new URL("jar:" + fullPath + "!/");
-        JarURLConnection connection = (JarURLConnection) jarUrl.openConnection();
-        callback.scan(connection, path, true);
+        callback.scan(jarUrl, path, true);
     }
-
 }
 

==================================================
