0de403592beca987f2c86c3c781fb257e0ede5b2
==================================================
Apply patch 01 from jboynes to improve cookie handling.
==================================================
Mark Emlyn
==================================================
Wed May 21 11:58:49 2014 +0000
==================================================
Cookie.java
Apply patch 01 from jboynes to improve cookie handling.
Allow attribute names as cookie names.
Patch should be safe since it relaxes the current behaviour.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1596546 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookie.java
index 17745556ab..b1421523c0 100644
--- a/java/javax/servlet/http/Cookie.java
+++ b/java/javax/servlet/http/Cookie.java
@@ -401,16 +401,7 @@ class CookieNameValidator {
         if (name == null || name.length() == 0) {
             throw new IllegalArgumentException(lStrings.getString("err.cookie_name_blank"));
         }
-        if (!isToken(name) ||
-                name.equalsIgnoreCase("Comment") ||
-                name.equalsIgnoreCase("Discard") ||
-                name.equalsIgnoreCase("Domain") ||
-                name.equalsIgnoreCase("Expires") ||
-                name.equalsIgnoreCase("Max-Age") ||
-                name.equalsIgnoreCase("Path") ||
-                name.equalsIgnoreCase("Secure") ||
-                name.equalsIgnoreCase("Version") ||
-                name.startsWith("$")) {
+        if (!isToken(name) || name.startsWith("$")) {
             String errMsg = lStrings.getString("err.cookie_name_is_token");
             throw new IllegalArgumentException(MessageFormat.format(errMsg, name));
         }

==================================================
