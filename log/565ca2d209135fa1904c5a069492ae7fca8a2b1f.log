565ca2d209135fa1904c5a069492ae7fca8a2b1f
==================================================
Add Max-Age support to the RFC 6265 cookie processor
==================================================
Mark Emlyn
==================================================
Thu Oct 2 07:13:10 2014 +0000
==================================================
Rfc6265CookieProcessor.java
Add Max-Age support to the RFC 6265 cookie processor

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1628896 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookieProcessorGeneration.java
index c52db0728d..fd02e02671 100644
--- a/java/org/apache/tomcat/util/http/Rfc6265CookieProcessor.java
+++ b/java/org/apache/tomcat/util/http/Rfc6265CookieProcessor.java
@@ -87,7 +87,15 @@ public class Rfc6265CookieProcessor implements CookieProcessor {
             header.append(value);
         }
 
-        // TODO add support for the attributes.
+        // RFC 6265 prefers Max-Age to Expires so use Max-Age
+        int maxAge = cookie.getMaxAge();
+        if (maxAge > -1) {
+            // Negative Max-Age is equivalent to no Max-Age
+            header.append(";Max-Age=");
+            header.append(maxAge);
+        }
+
+        // TODO add support for the remaining attributes.
         return header.toString();
     }
 

==================================================
