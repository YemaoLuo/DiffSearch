527a49263e6ae1607bc41c739072476761cea8a4
==================================================
Fix NPE - Thanks to Han Li
==================================================
Mark Thomas
==================================================
Tue Aug 2 10:47:54 2022 +0100
==================================================
Ranges.java
Fix NPE - Thanks to Han Li


==================================================
TestRanges.java
index eadbc56a2a..d0197797b5 100644
--- a/java/org/apache/tomcat/util/http/parser/Ranges.java
+++ b/java/org/apache/tomcat/util/http/parser/Ranges.java
@@ -31,7 +31,11 @@ public class Ranges {
 
     public Ranges(String units, List<Entry> entries) {
         // Units are lower case (RFC 9110, section 14.1)
-        this.units = units.toLowerCase(Locale.ENGLISH);
+        if (units == null) {
+            this.units = null;
+        } else {
+            this.units = units.toLowerCase(Locale.ENGLISH);
+        }
         this.entries = Collections.unmodifiableList(entries);
     }
 

==================================================
