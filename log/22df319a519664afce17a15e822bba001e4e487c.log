22df319a519664afce17a15e822bba001e4e487c
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60013
==================================================
Mark Thomas
==================================================
Tue Aug 23 13:22:52 2016 +0000
==================================================
CorsFilter.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60013
Add a test case

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1757363 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TomcatBaseTest.java
index 6a6d065530..9d41eb4856 100644
--- a/java/org/apache/catalina/filters/CorsFilter.java
+++ b/java/org/apache/catalina/filters/CorsFilter.java
@@ -827,7 +827,7 @@ public final class CorsFilter extends GenericFilter {
         }
 
         // RFC6454, section 4. "If uri-scheme is file, the implementation MAY
-        // return an implementation-defined value.". No limits are okaced on
+        // return an implementation-defined value.". No limits are placed on
         // that value so treat all file URIs as valid origins.
         if (origin.startsWith("file://")) {
             return true;

==================================================
TestRewriteValve.java
index 4bbe2917db..8b1b1fb8fc 100644
--- a/test/org/apache/catalina/startup/TomcatBaseTest.java
+++ b/test/org/apache/catalina/startup/TomcatBaseTest.java
@@ -453,12 +453,13 @@ public abstract class TomcatBaseTest extends LoggingBaseTest {
             StringBuilder value;
             Object attribute;
 
+            response.setContentType("text/plain");
+            response.setCharacterEncoding("UTF-8");
+
             ServletContext ctx = this.getServletContext();
             HttpSession session = request.getSession(false);
             PrintWriter out = response.getWriter();
 
-            response.setContentType("text/plain");
-
             out.println("CONTEXT-NAME: " + ctx.getServletContextName());
             out.println("CONTEXT-PATH: " + ctx.getContextPath());
             out.println("CONTEXT-MAJOR-VERSION: " + ctx.getMajorVersion());

==================================================
