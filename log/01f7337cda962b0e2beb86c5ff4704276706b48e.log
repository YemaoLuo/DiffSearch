01f7337cda962b0e2beb86c5ff4704276706b48e
==================================================
Align processSocket() implementations for NIO and NIO2.
==================================================
Mark Thomas
==================================================
Wed Jun 1 21:31:07 2016 +0000
==================================================
Nio2Endpoint.java
Align processSocket() implementations for NIO and NIO2.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1746500 13f79535-47bb-0310-9956-ffa450edef68



==================================================
NioEndpoint.java
index a4f7d72b5c..4707a85218 100644
--- a/java/org/apache/tomcat/util/net/Nio2Endpoint.java
+++ b/java/org/apache/tomcat/util/net/Nio2Endpoint.java
@@ -380,6 +380,9 @@ public class Nio2Endpoint extends AbstractJsseEndpoint<Nio2Channel> {
     public boolean  processSocket(SocketWrapperBase<Nio2Channel> socketWrapper,
             SocketEvent event, boolean dispatch) {
         try {
+            if (socketWrapper == null) {
+                return false;
+            }
             SocketProcessor sc = processorCache.pop();
             if (sc == null) {
                 sc = new SocketProcessor(socketWrapper, event);
@@ -393,7 +396,7 @@ public class Nio2Endpoint extends AbstractJsseEndpoint<Nio2Channel> {
                 sc.run();
             }
         } catch (RejectedExecutionException ree) {
-            log.debug(sm.getString("endpoint.executor.fail", socketWrapper), ree);
+            log.warn(sm.getString("endpoint.executor.fail", socketWrapper), ree);
             return false;
         } catch (Throwable t) {
             ExceptionUtils.handleThrowable(t);

==================================================
