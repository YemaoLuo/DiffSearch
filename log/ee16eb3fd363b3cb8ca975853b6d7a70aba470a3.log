ee16eb3fd363b3cb8ca975853b6d7a70aba470a3
==================================================
Part 1 of SPNEGO/Windows authentication support.
==================================================
Mark Emlyn
==================================================
Tue Mar 29 19:08:43 2011 +0000
==================================================
Constants.java
Part 1 of SPNEGO/Windows authentication support.
This adds authentication support but not authorisation. Some Realm refactoring is required to get authorisation working.
SPNEGO is tricky to configure correctly. Some things I know will break it, some I suspect might. There is a long list of questions in the Javadoc that need to be tested.
This authenticator started off as a patch by Michael Osipov.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1086683 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SpnegoAuthenticator.java
index aaa649ff7a..ae19fb12ea 100644
--- a/java/org/apache/catalina/authenticator/Constants.java
+++ b/java/org/apache/catalina/authenticator/Constants.java
@@ -24,16 +24,23 @@ public class Constants {
     public static final String Package = "org.apache.catalina.authenticator";
 
     // Authentication methods for login configuration
+    // Servlet spec schemes
     public static final String BASIC_METHOD = "BASIC";
     public static final String CERT_METHOD = "CLIENT_CERT";
     public static final String DIGEST_METHOD = "DIGEST";
     public static final String FORM_METHOD = "FORM";
+    // Vendor specific schemes
+    public static final String SPNEGO_METHOD = "SPNEGO";
 
     // Form based authentication constants
     public static final String FORM_ACTION = "/j_security_check";
     public static final String FORM_PASSWORD = "j_password";
     public static final String FORM_USERNAME = "j_username";
 
+    // SPNEGO authentication constants
+    public static final String DEFAULT_KEYTAB = "conf/tomcat.keytab";
+    public static final String DEFAULT_SPN_CLASS = "HTTP";
+
     // Cookie name for single sign on support
     public static final String SINGLE_SIGN_ON_COOKIE =
         System.getProperty(

==================================================
Base64.java
index 922fa3776a..a995844b24 100644
--- a/java/org/apache/catalina/startup/Authenticators.properties
+++ b/java/org/apache/catalina/startup/Authenticators.properties
@@ -18,3 +18,4 @@ CLIENT-CERT=org.apache.catalina.authenticator.SSLAuthenticator
 DIGEST=org.apache.catalina.authenticator.DigestAuthenticator
 FORM=org.apache.catalina.authenticator.FormAuthenticator
 NONE=org.apache.catalina.authenticator.NonLoginAuthenticator
+SPNEGO=org.apache.catalina.authenticator.SpnegoAuthenticator
\ No newline at end of file

==================================================
