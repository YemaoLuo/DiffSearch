88389b22073e6bd3985ff9ec269237bd0c8a51b5
==================================================
Refactor to remove duplicated code
==================================================
Mark Thomas
==================================================
Thu Dec 1 11:39:44 2016 +0000
==================================================
TestELEvaluation.java
Refactor to remove duplicated code

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1772174 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TesterFunctions.java
index 98eb5fc704..8219fc831f 100644
--- a/test/org/apache/el/TestELEvaluation.java
+++ b/test/org/apache/el/TestELEvaluation.java
@@ -18,11 +18,9 @@
 package org.apache.el;
 
 import java.io.File;
-import java.lang.reflect.Method;
 import java.util.Date;
 
 import javax.el.ELException;
-import javax.el.FunctionMapper;
 import javax.el.ValueExpression;
 
 import static org.junit.Assert.assertEquals;
@@ -239,28 +237,9 @@ public class TestELEvaluation {
     private String evaluateExpression(String expression) {
         ExpressionFactoryImpl exprFactory = new ExpressionFactoryImpl();
         ELContextImpl ctx = new ELContextImpl(exprFactory);
-        ctx.setFunctionMapper(new FMapper());
+        ctx.setFunctionMapper(new TesterFunctions.FMapper());
         ValueExpression ve = exprFactory.createValueExpression(ctx, expression,
                 String.class);
         return (String) ve.getValue(ctx);
     }
-
-    public static class FMapper extends FunctionMapper {
-
-        @Override
-        public Method resolveFunction(String prefix, String localName) {
-            if ("trim".equals(localName)) {
-                Method m;
-                try {
-                    m = TesterFunctions.class.getMethod("trim", String.class);
-                    return m;
-                } catch (SecurityException e) {
-                    // Ignore
-                } catch (NoSuchMethodException e) {
-                    // Ignore
-                }
-            }
-            return null;
-        }
-    }
 }

==================================================
TestAttributeParser.java
index 3866128af8..439c919da7 100644
--- a/test/org/apache/el/TesterFunctions.java
+++ b/test/org/apache/el/TesterFunctions.java
@@ -17,6 +17,10 @@
 
 package org.apache.el;
 
+import java.lang.reflect.Method;
+
+import javax.el.FunctionMapper;
+
 public class TesterFunctions {
     public static String trim(String input) {
         return input.trim();
@@ -41,4 +45,24 @@ public class TesterFunctions {
             return RETVAL;
         }
     }
+
+
+    public static class FMapper extends FunctionMapper {
+
+        @Override
+        public Method resolveFunction(String prefix, String localName) {
+            if ("trim".equals(localName)) {
+                Method m;
+                try {
+                    m = TesterFunctions.class.getMethod("trim", String.class);
+                    return m;
+                } catch (SecurityException e) {
+                    // Ignore
+                } catch (NoSuchMethodException e) {
+                    // Ignore
+                }
+            }
+            return null;
+        }
+    }
 }

==================================================
