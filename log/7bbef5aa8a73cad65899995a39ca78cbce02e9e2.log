7bbef5aa8a73cad65899995a39ca78cbce02e9e2
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56246
==================================================
Mark Emlyn
==================================================
Wed Mar 12 14:52:09 2014 +0000
==================================================
MemoryRealm.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56246
Fix NullPointerException in MemoryRealm when authenticating an unknown user.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1576768 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestMemoryRealm.java
index 582fbf5f25..52aad26752 100644
--- a/java/org/apache/catalina/realm/MemoryRealm.java
+++ b/java/org/apache/catalina/realm/MemoryRealm.java
@@ -113,7 +113,12 @@ public class MemoryRealm  extends RealmBase {
 
         GenericPrincipal principal = principals.get(username);
 
-        boolean validated = compareCredentials(credentials, principal.getPassword());
+        boolean validated;
+        if (principal == null) {
+            validated = false;
+        } else {
+            validated = compareCredentials(credentials, principal.getPassword());
+        }
 
         if (validated) {
             if (log.isDebugEnabled())

==================================================
