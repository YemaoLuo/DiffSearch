b4b7ee72474bb5383de291fab8f3d97b4c3bbba1
==================================================
Fix possible resource leaks by closing streams properly. Issues reported by Coverity Scan.
==================================================
Violeta Georgieva
==================================================
Thu Jul 9 08:08:24 2015 +0000
==================================================
ValidatorTask.java
Fix possible resource leaks by closing streams properly. Issues reported by Coverity Scan.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1690011 13f79535-47bb-0310-9956-ffa450edef68



==================================================
FarmWarDeployer.java
index 97c8e22f36..97b3fc3dd1 100644
--- a/java/org/apache/catalina/ant/ValidatorTask.java
+++ b/java/org/apache/catalina/ant/ValidatorTask.java
@@ -93,12 +93,8 @@ public class ValidatorTask extends BaseRedirectorHelperTask {
         // SecurityManager assume that untrusted applications may be deployed.
         Digester digester = DigesterFactory.newDigester(
                 true, true, null, Globals.IS_SECURITY_ENABLED);
-        try {
-            file = file.getCanonicalFile();
-            InputStream stream =
-                new BufferedInputStream(new FileInputStream(file));
-            InputSource is =
-                new InputSource(file.toURI().toURL().toExternalForm());
+        try (InputStream stream = new BufferedInputStream(new FileInputStream(file.getCanonicalFile()));) {
+            InputSource is = new InputSource(file.toURI().toURL().toExternalForm());
             is.setByteStream(stream);
             digester.parse(is);
             handleOutput("web.xml validated");

==================================================
