7a8c7ff3f8cb56bdb1ff70c02de13d35dd78487a
==================================================
Follow up to https://issues.apache.org/bugzilla/show_bug.cgi?id=57132
==================================================
Mark Emlyn
==================================================
Thu Oct 23 13:44:38 2014 +0000
==================================================
ImportHandler.java
Follow up to https://issues.apache.org/bugzilla/show_bug.cgi?id=57132
Better handling for invalid input.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1633809 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestImportHandler.java
index 70fdac7bd6..81ba57f214 100644
--- a/java/javax/el/ImportHandler.java
+++ b/java/javax/el/ImportHandler.java
@@ -146,6 +146,10 @@ public class ImportHandler {
 
 
     public java.lang.Class<?> resolveClass(String name) {
+        if (name == null || name.contains(".")) {
+            return null;
+        }
+
         Class<?> result = clazzes.get(name);
 
         if (result == null) {

==================================================
