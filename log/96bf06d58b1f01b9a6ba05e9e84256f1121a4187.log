96bf06d58b1f01b9a6ba05e9e84256f1121a4187
==================================================
SNI Refactoring. I'm doing this in small steps as I tried to do it a single go and got something wrong that broke secure connections.
==================================================
Mark Thomas
==================================================
Thu Apr 9 18:17:24 2015 +0000
==================================================
NioEndpoint.java
SNI Refactoring. I'm doing this in small steps as I tried to do it a single go and got something wrong that broke secure connections.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1672437 13f79535-47bb-0310-9956-ffa450edef68



==================================================
SecureNioChannel.java
index d59efaf172..cde4176b21 100644
--- a/java/org/apache/tomcat/util/net/NioEndpoint.java
+++ b/java/org/apache/tomcat/util/net/NioEndpoint.java
@@ -465,7 +465,7 @@ public class NioEndpoint extends AbstractJsseEndpoint<NioChannel> {
                             Math.max(appbufsize,socketProperties.getAppReadBufSize()),
                             Math.max(appbufsize,socketProperties.getAppWriteBufSize()),
                             socketProperties.getDirectBuffer());
-                    channel = new SecureNioChannel(socket, engine, bufhandler, selectorPool);
+                    channel = new SecureNioChannel(socket, engine, bufhandler, selectorPool, this);
                 } else {
                     // normal tcp setup
                     SocketBufferHandler bufhandler = new SocketBufferHandler(

==================================================
