efbd5c179a2b7af4510e67af9df1d8dd9462eb6b
==================================================
UriTemplate should not trigger failures for '/' for for instances used for matching that end in '/'
==================================================
Mark Emlyn
==================================================
Mon Sep 9 20:10:04 2013 +0000
==================================================
UriTemplate.java
UriTemplate should not trigger failures for '/' for for instances used for matching that end in '/'

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1521271 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestUriTemplate.java
index 0529b3886e..4d82c11138 100644
--- a/java/org/apache/tomcat/websocket/server/UriTemplate.java
+++ b/java/org/apache/tomcat/websocket/server/UriTemplate.java
@@ -60,9 +60,11 @@ public class UriTemplate {
         for (int i = 0; i < segments.length; i++) {
             String segment = segments[i];
             if (segment.length() == 0) {
-                if (i == 0) {
+                if (i == 0 || (i == segments.length - 1 && paramCount == 0)) {
                     // Ignore the first empty segment as the path must always
                     // start with '/'
+                    // Ending with a '/' is also OK for instances used for
+                    // matches but not for parameterised templates.
                     continue;
                 } else {
                     // As per EG discussion, all other empty segments are

==================================================
