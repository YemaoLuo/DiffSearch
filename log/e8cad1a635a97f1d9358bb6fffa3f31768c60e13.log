e8cad1a635a97f1d9358bb6fffa3f31768c60e13
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63441
==================================================
Mark Thomas
==================================================
Thu May 16 10:48:17 2019 +0100
==================================================
DeltaManager.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63441

Further streamline the processing of session creation messages in the
DeltaManager to reduce the possibility of a session update message being
processed before the session has been created.


==================================================
DeltaSession.java
index ee76f55182..9f3abeff7c 100644
--- a/java/org/apache/catalina/ha/session/DeltaManager.java
+++ b/java/org/apache/catalina/ha/session/DeltaManager.java
@@ -468,13 +468,16 @@ public class DeltaManager extends ClusterManagerBase{
      */
     @Override
     public Session createEmptySession() {
-        return getNewDeltaSession() ;
+        return new DeltaSession(this);
     }
 
     /**
      * Get new session class to be used in the doLoad() method.
      * @return a new session
+     *
+     * @deprecated Unused. This will be removed in Tomcat 10.
      */
+    @Deprecated
     protected DeltaSession getNewDeltaSession() {
         return new DeltaSession(this);
     }

==================================================
