374690d5793248f26d5894a33bb5ed562e22da91
==================================================
Fix BZ 64784. Don't include timestamp in .java file when pre-compiling
==================================================
Mark Thomas
==================================================
Fri Oct 9 14:02:50 2020 +0100
==================================================
JspC.java
Fix BZ 64784. Don't include timestamp in .java file when pre-compiling


==================================================
Options.java
index ff28ed105b..3804d2aec5 100644
--- a/java/org/apache/jasper/JspC.java
+++ b/java/org/apache/jasper/JspC.java
@@ -1124,6 +1124,19 @@ public class JspC extends Task implements Options {
         return tagPluginManager;
     }
 
+
+    /**
+     * {@inheritDoc}
+     * <p>
+     * Hard-coded to {@code false} for pre-compiled code to enable repeatable
+     * builds.
+     */
+    @Override
+    public boolean getGeneratedJavaAddTimestamp() {
+        return false;
+    }
+
+
     /**
      * Adds servlet declaration and mapping for the JSP page servlet to the
      * generated web.xml fragment.

==================================================
Generator.java
index 4b100aa78b..19f394749e 100644
--- a/java/org/apache/jasper/Options.java
+++ b/java/org/apache/jasper/Options.java
@@ -360,4 +360,16 @@ public interface Options {
     public default boolean getUseInstanceManagerForTags() {
         return false;
     }
+
+
+    /**
+     * Should the container include the time the file was generated in the
+     * comments at the start of a Java file generated from a JSP or tag.
+     * Defaults to {@code true}.
+     *
+     * @return {@code true} to include the timestamp, otherwise don't include it
+     */
+    public default boolean getGeneratedJavaAddTimestamp() {
+        return true;
+    }
 }

==================================================
