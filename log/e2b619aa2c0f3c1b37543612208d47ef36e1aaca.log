e2b619aa2c0f3c1b37543612208d47ef36e1aaca
==================================================
Remove references to now unused jndi: URLs
==================================================
Mark Thomas
==================================================
Fri Sep 30 19:32:32 2016 +0000
==================================================
JspRuntimeContext.java
Remove references to now unused jndi: URLs

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1762947 13f79535-47bb-0310-9956-ffa450edef68



==================================================
UrlJar.java
index 4e1e95f218..1b6e32ecfe 100644
--- a/java/org/apache/jasper/compiler/JspRuntimeContext.java
+++ b/java/org/apache/jasper/compiler/JspRuntimeContext.java
@@ -507,35 +507,6 @@ public final class JspRuntimeContext {
                 // Allow the JSP to access org.apache.jasper.runtime.HttpJspBase
                 permissions.add( new RuntimePermission(
                     "accessClassInPackage.org.apache.jasper.runtime") );
-
-                if (parentClassLoader instanceof URLClassLoader) {
-                    URL [] urls = ((URLClassLoader)parentClassLoader).getURLs();
-                    String jarUrl = null;
-                    String jndiUrl = null;
-                    for (int i=0; i<urls.length; i++) {
-                        if (jndiUrl == null
-                                && urls[i].toString().startsWith("jndi:") ) {
-                            jndiUrl = urls[i].toString() + "-";
-                        }
-                        if (jarUrl == null
-                                && urls[i].toString().startsWith("jar:jndi:")
-                                ) {
-                            jarUrl = urls[i].toString();
-                            jarUrl = jarUrl.substring(0,jarUrl.length() - 2);
-                            jarUrl = jarUrl.substring(0,
-                                     jarUrl.lastIndexOf('/')) + "/-";
-                        }
-                    }
-                    if (jarUrl != null) {
-                        permissions.add(
-                                new FilePermission(jarUrl,"read"));
-                        permissions.add(
-                                new FilePermission(jarUrl.substring(4),"read"));
-                    }
-                    if (jndiUrl != null)
-                        permissions.add(
-                                new FilePermission(jndiUrl,"read") );
-                }
             } catch(Exception e) {
                 context.log("Security Init for context failed",e);
             }

==================================================
