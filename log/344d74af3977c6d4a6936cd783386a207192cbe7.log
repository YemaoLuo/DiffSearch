344d74af3977c6d4a6936cd783386a207192cbe7
==================================================
i18n for diagnostics using the user's Locale
==================================================
Mark Emlyn
==================================================
Sat May 4 22:45:19 2013 +0000
==================================================
ManagerServlet.java
i18n for diagnostics using the user's Locale

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1479212 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Diagnostics.java
index 9122ba7f1a..5d067fa7cc 100644
--- a/java/org/apache/catalina/manager/ManagerServlet.java
+++ b/java/org/apache/catalina/manager/ManagerServlet.java
@@ -368,9 +368,9 @@ public class ManagerServlet extends HttpServlet implements ContainerServlet {
         } else if (command.equals("/findleaks")) {
             findleaks(statusLine, writer, smClient);
         } else if (command.equals("/vminfo")) {
-            vmInfo(writer, smClient);
+            vmInfo(writer, request.getLocales());
         } else if (command.equals("/threaddump")) {
-            threadDump(writer, smClient);
+            threadDump(writer, request.getLocales());
         } else if (command.equals("/sslConnectorCiphers")) {
             sslConnectorCiphers(writer, smClient);
         } else {
@@ -543,8 +543,9 @@ public class ManagerServlet extends HttpServlet implements ContainerServlet {
      *
      * @param writer
      */
-    protected void vmInfo(PrintWriter writer, StringManager smClient) {
-        writer.print(Diagnostics.getVMInfo());
+    protected void vmInfo(PrintWriter writer,
+            Enumeration<Locale> requestedLocales) {
+        writer.print(Diagnostics.getVMInfo(requestedLocales));
     }
 
     /**
@@ -553,8 +554,9 @@ public class ManagerServlet extends HttpServlet implements ContainerServlet {
      *
      * @param writer
      */
-    protected void threadDump(PrintWriter writer, StringManager smClient) {
-        writer.print(Diagnostics.getThreadDump());
+    protected void threadDump(PrintWriter writer,
+            Enumeration<Locale> requestedLocales) {
+        writer.print(Diagnostics.getThreadDump(requestedLocales));
     }
 
     protected void sslConnectorCiphers(PrintWriter writer,

==================================================
