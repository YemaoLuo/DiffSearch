dd34003d1d2b30354fdfc86f0f606f5679cc2097
==================================================
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63995 close statement
==================================================
Mark Thomas
==================================================
Tue Dec 10 10:52:37 2019 +0000
==================================================
DelegatingConnection.java
Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=63995 close statement

Also do a complete code review of the DBCP 2 fork and fix one additional
difference.


==================================================
DelegatingStatement.java
index b06546a5fb..1a833056f5 100644
--- a/java/org/apache/tomcat/dbcp/dbcp2/DelegatingConnection.java
+++ b/java/org/apache/tomcat/dbcp/dbcp2/DelegatingConnection.java
@@ -621,7 +621,7 @@ public class DelegatingConnection<C extends Connection> extends AbandonedTrace i
         // Statement's when it is closed.
         // DBCP-288. Not all the traced objects will be statements
         final List<AbandonedTrace> traces = getTrace();
-        if (traces != null && traces.isEmpty()) {
+        if (traces != null && !traces.isEmpty()) {
             final List<Exception> thrownList = new ArrayList<>();
             final Iterator<AbandonedTrace> traceIter = traces.iterator();
             while (traceIter.hasNext()) {

==================================================
