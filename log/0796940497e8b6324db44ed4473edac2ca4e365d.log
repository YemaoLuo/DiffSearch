0796940497e8b6324db44ed4473edac2ca4e365d
==================================================
Also add a test for the map key.
==================================================
Remy Maucherat
==================================================
Mon Sep 3 13:09:27 2018 +0000
==================================================
TestRewriteValve.java
Also add a test for the map key.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1839960 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TesterRewriteMapA.java
index 887b73a3d1..e6a661a60c 100644
--- a/test/org/apache/catalina/valves/rewrite/TestRewriteValve.java
+++ b/test/org/apache/catalina/valves/rewrite/TestRewriteValve.java
@@ -88,6 +88,12 @@ public class TestRewriteValve extends TomcatBaseTest {
                 "RewriteRule /b/(.*).html$ /c/${mapa:$1|d$1d}", "/b/x.html", "/c/dxd");
     }
 
+    @Test
+    public void testRewriteMap04() throws Exception {
+        doTestRewrite("RewriteMap mapa org.apache.catalina.valves.rewrite.TesterRewriteMapA\n" +
+                "RewriteRule /b/(.*).html$ /c/${mapa:a$1|dd}", "/b/a.html", "/c/aaaa");
+    }
+
     @Test
     public void testRewriteServerVar() throws Exception {
         doTestRewrite("RewriteRule /b/(.*).html$ /c%{SERVLET_PATH}", "/b/x.html", "/c/b/x.html");

==================================================
