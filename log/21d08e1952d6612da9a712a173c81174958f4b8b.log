21d08e1952d6612da9a712a173c81174958f4b8b
==================================================
  BZ-63691 Skip all jar scanning if wildcard pattern is used
==================================================
Igal Sapir
==================================================
0800
==================================================
JarScanFilter.java
  BZ-63691 Skip all jar scanning if wildcard pattern is used


==================================================
StandardJarScanFilter.java
index d7f6738e74..d3aeb45beb 100644
--- a/java/org/apache/tomcat/JarScanFilter.java
+++ b/java/org/apache/tomcat/JarScanFilter.java
@@ -28,4 +28,13 @@ public interface JarScanFilter {
      *             <code>false</code> if it should be excluded
      */
     boolean check(JarScanType jarScanType, String jarName);
+
+    /**
+     *
+     * @return <code>true</code> if all of the scans should be skipped which
+     * can improve startup performance. The default is <code>false</code>.
+     */
+    default boolean isSkipAll() {
+        return false;
+    }
 }

==================================================
StandardJarScanner.java
index 84d3725899..6e942a2997 100644
--- a/java/org/apache/tomcat/util/scan/StandardJarScanFilter.java
+++ b/java/org/apache/tomcat/util/scan/StandardJarScanFilter.java
@@ -36,11 +36,13 @@ public class StandardJarScanFilter implements JarScanFilter {
     private static final String defaultScan;
     private static final Set<String> defaultSkipSet = new HashSet<>();
     private static final Set<String> defaultScanSet = new HashSet<>();
+    private static final boolean defaultSkipAll;
 
     static {
         // Initialize defaults. There are no setter methods for them.
         defaultSkip = System.getProperty(Constants.SKIP_JARS_PROPERTY);
         populateSetFromAttribute(defaultSkip, defaultSkipSet);
+        defaultSkipAll = defaultSkipSet.contains("*") || defaultSkipSet.contains("*.jar");
         defaultScan = System.getProperty(Constants.SCAN_JARS_PROPERTY);
         populateSetFromAttribute(defaultScan, defaultScanSet);
     }
@@ -132,6 +134,12 @@ public class StandardJarScanFilter implements JarScanFilter {
     }
 
 
+    @Override
+    public boolean isSkipAll() {
+        return defaultSkipAll;
+    }
+
+
     public boolean isDefaultTldScan() {
         return defaultTldScan;
     }

==================================================
