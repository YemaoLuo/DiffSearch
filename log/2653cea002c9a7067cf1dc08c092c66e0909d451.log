2653cea002c9a7067cf1dc08c092c66e0909d451
==================================================
Refactor server container shutdown into the destroy method
==================================================
Mark Emlyn
==================================================
Tue Apr 22 08:31:56 2014 +0000
==================================================
WsContextListener.java
index 325d61c5f7..04a89faa84 100644
--- a/java/org/apache/tomcat/websocket/server/LocalStrings.properties
+++ b/java/org/apache/tomcat/websocket/server/LocalStrings.properties
@@ -22,6 +22,7 @@ serverContainer.missingEndpoint=An Endpoint instance has been request for path [
 serverContainer.pojoDeploy=POJO class [{0}] deploying to path [{1}] in ServletContext [{2}]
 serverContainer.servletContextMismatch=Attempted to register a POJO annotated for WebSocket at path [{0}] in the ServletContext with context path [{1}] when the WebSocket ServerContainer is allocated to the ServletContext with context path [{2}]
 serverContainer.servletContextMissing=No ServletContext was specified
+serverContainer.threadGroupNotDestroyed=Unable to destroy WebSocket thread group [{0}] as some threads were still running when the web application was stopped
 
 uriTemplate.duplicateParameter=The parameter [{0}] appears more than once in the path which is not permitted
 uriTemplate.emptySegment=The path [{0}] contains one or more empty segments which are is not permitted

==================================================
WsServerContainer.java
index 2823d08c3b..27ea702c49 100644
--- a/java/org/apache/tomcat/websocket/server/WsContextListener.java
+++ b/java/org/apache/tomcat/websocket/server/WsContextListener.java
@@ -45,7 +45,6 @@ public class WsContextListener implements ServletContextListener {
         ServletContext sc = sce.getServletContext();
         Object obj = sc.getAttribute(Constants.SERVER_CONTAINER_SERVLET_CONTEXT_ATTRIBUTE);
         if (obj instanceof WsServerContainer) {
-            ((WsServerContainer) obj).shutdownExecutor();
             ((WsServerContainer) obj).destroy();
         }
     }

==================================================
