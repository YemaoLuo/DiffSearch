2f91be055e1349c1268c602d88dd4f96b80bf9a5
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56568
==================================================
Mark Emlyn
==================================================
Thu Jun 5 15:27:16 2014 +0000
==================================================
JspServlet.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56568
Allow JSP error pages to handle any HTTP method

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1600680 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestJspServlet.java
index 067b8dd59e..19f980677d 100644
--- a/java/org/apache/jasper/servlet/JspServlet.java
+++ b/java/org/apache/jasper/servlet/JspServlet.java
@@ -25,6 +25,7 @@ import java.security.AccessController;
 import java.security.PrivilegedActionException;
 import java.security.PrivilegedExceptionAction;
 
+import javax.servlet.DispatcherType;
 import javax.servlet.RequestDispatcher;
 import javax.servlet.ServletConfig;
 import javax.servlet.ServletContext;
@@ -283,8 +284,8 @@ public class JspServlet extends HttpServlet implements PeriodicEventListener {
 
         String method = request.getMethod();
 
-        if (!"GET".equals(method) && !"POST".equals(method) &&
-                !"HEAD".equals(method)) {
+        if (!"GET".equals(method) && !"POST".equals(method) && !"HEAD".equals(method) &&
+                !DispatcherType.ERROR.equals(request.getDispatcherType())) {
             // Specification states behaviour is undefined
             // Jasper opts to reject any other verbs, partly as they are
             // unlikely to make sense in a JSP context and partly to protect

==================================================
