a4de93b2aaf74fff7c1e194f7ce3d2228a9680b8
==================================================
Fix CVE-2010-1157.
==================================================
Mark Emlyn
==================================================
Wed Apr 21 22:11:29 2010 +0000
==================================================
AuthenticatorBase.java
Fix CVE-2010-1157.
Prevent possible disclosure of host name or IP address via the HTTP WWW-Authenticate header when using BASIC or DIGEST authentication.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@936539 13f79535-47bb-0310-9956-ffa450edef68



==================================================
BasicAuthenticator.java
index 5caed3f34c..e98dd8ef93 100644
--- a/java/org/apache/catalina/authenticator/AuthenticatorBase.java
+++ b/java/org/apache/catalina/authenticator/AuthenticatorBase.java
@@ -106,6 +106,11 @@ public abstract class AuthenticatorBase extends ValveBase
      */
     protected static final String AUTH_HEADER_NAME = "WWW-Authenticate";
 
+    /**
+     * Default authentication realm name.
+     */
+    protected static final String REALM_NAME = "Authentication required";
+
     /**
      * The message digest algorithm to be used when generating session
      * identifiers.  This must be an algorithm supported by the

==================================================
DigestAuthenticator.java
index 2e07d47bcd..95a0a29b97 100644
--- a/java/org/apache/catalina/authenticator/BasicAuthenticator.java
+++ b/java/org/apache/catalina/authenticator/BasicAuthenticator.java
@@ -165,9 +165,7 @@ public class BasicAuthenticator
         StringBuilder value = new StringBuilder(16);
         value.append("Basic realm=\"");
         if (config.getRealmName() == null) {
-            value.append(request.getServerName());
-            value.append(':');
-            value.append(Integer.toString(request.getServerPort()));
+            value.append(REALM_NAME);
         } else {
             value.append(config.getRealmName());
         }

==================================================
