1dc8594099e24426b799bb0acf80aa3462a8bf70
==================================================
Refactor: Obtain ping configuration directly from protocol
==================================================
Mark Thomas
==================================================
Tue Sep 5 09:44:09 2017 +0000
==================================================
Http2Protocol.java
Refactor: Obtain ping configuration directly from protocol

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1807331 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http2UpgradeHandler.java
index a54efeec69..bd90b2c7a8 100644
--- a/java/org/apache/coyote/http2/Http2Protocol.java
+++ b/java/org/apache/coyote/http2/Http2Protocol.java
@@ -101,12 +101,9 @@ public class Http2Protocol implements UpgradeProtocol {
     @Override
     public InternalHttpUpgradeHandler getInternalUpgradeHandler(SocketWrapperBase<?> socketWrapper,
             Adapter adapter, Request coyoteRequest) {
-        Http2UpgradeHandler result = (socketWrapper.hasAsyncIO())
+        return socketWrapper.hasAsyncIO()
                 ? new Http2AsyncUpgradeHandler(this, adapter, coyoteRequest)
                 : new Http2UpgradeHandler(this, adapter, coyoteRequest);
-
-        result.setInitiatePingDisabled(initiatePingDisabled);
-        return result;
     }
 
 
@@ -269,4 +266,9 @@ public class Http2Protocol implements UpgradeProtocol {
     public void setInitiatePingDisabled(boolean initiatePingDisabled) {
         this.initiatePingDisabled = initiatePingDisabled;
     }
+
+
+    public boolean getInitiatePingDisabled() {
+        return initiatePingDisabled;
+    }
 }

==================================================
