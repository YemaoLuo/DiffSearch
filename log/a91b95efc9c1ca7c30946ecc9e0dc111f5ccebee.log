a91b95efc9c1ca7c30946ecc9e0dc111f5ccebee
==================================================
Porting fix for BZ #40306
==================================================
William Barker
==================================================
Mon Aug 28 04:49:31 2006 +0000
==================================================
AjpAprProcessor.java
Porting fix for BZ #40306

git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk@437530 13f79535-47bb-0310-9956-ffa450edef68



==================================================
MsgContext.java
index c94dde29bc..41d948b034 100644
--- a/java/org/apache/coyote/ajp/AjpAprProcessor.java
+++ b/java/org/apache/coyote/ajp/AjpAprProcessor.java
@@ -571,6 +571,7 @@ public class AjpAprProcessor implements ActionHook {
         } else if (actionCode == ActionCode.ACTION_REQ_SET_BODY_REPLAY) {
 
             // Set the given bytes as the content
+            request.setContentLength(-1); // reset content length
             ByteChunk bc = (ByteChunk) param;
             bodyBytes.setBytes(bc.getBytes(), bc.getStart(), bc.getLength());
             first = false;

==================================================
