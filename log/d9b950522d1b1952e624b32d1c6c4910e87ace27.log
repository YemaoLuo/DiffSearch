d9b950522d1b1952e624b32d1c6c4910e87ace27
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47371
==================================================
Mark Emlyn
==================================================
Thu May 5 13:39:09 2011 +0000
==================================================
ELArithmetic.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47371
Correctly coerce the empty string to zero when used as an operand in EL arithmetic.
Patch provided by gbt.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1099789 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestELArithmetic.java
index 7ae39f0158..f0bb5b3ae2 100644
--- a/java/org/apache/el/lang/ELArithmetic.java
+++ b/java/org/apache/el/lang/ELArithmetic.java
@@ -394,13 +394,12 @@ public abstract class ELArithmetic {
         if (isNumber(obj)) {
             return coerce((Number) obj);
         }
-        if (obj instanceof String) {
-            return coerce((String) obj);
-        }
         if (obj == null || "".equals(obj)) {
             return coerce(ZERO);
         }
-
+        if (obj instanceof String) {
+            return coerce((String) obj);
+        }
         if (obj instanceof Character) {
             return coerce(Short.valueOf((short) ((Character) obj).charValue()));
         }

==================================================
