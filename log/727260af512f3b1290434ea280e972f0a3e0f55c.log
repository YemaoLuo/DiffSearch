727260af512f3b1290434ea280e972f0a3e0f55c
==================================================
use atomic counters
==================================================
Filip Hanik
==================================================
Fri Nov 14 15:18:19 2008 +0000
==================================================
PoolProperties.java
use atomic counters


git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@714027 13f79535-47bb-0310-9956-ffa450edef68



==================================================
PooledConnection.java
index ad386ad968..24bba9e664 100644
--- a/modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java
+++ b/modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java
@@ -19,12 +19,13 @@ package org.apache.tomcat.jdbc.pool;
 
 import java.lang.reflect.Method;
 import java.util.Properties;
+import java.util.concurrent.atomic.AtomicInteger;
 /**
  * @author Filip Hanik
  *
  */
 public class PoolProperties {
-    protected static volatile int poolCounter = 1;
+    protected static AtomicInteger poolCounter = new AtomicInteger(0);
     protected Properties dbProperties = new Properties();
     protected String url = null;
     protected String driverClassName = null;
@@ -50,7 +51,7 @@ public class PoolProperties {
     protected int removeAbandonedTimeout = 60;
     protected boolean logAbandoned = false;
     protected int loginTimeout = 10000;
-    protected String name = "Tomcat Connection Pool["+(poolCounter++)+"]";
+    protected String name = "Tomcat Connection Pool["+(poolCounter.addAndGet(1))+"]";
     protected String password;
     protected String username;
     protected long validationInterval = 30000;

==================================================
