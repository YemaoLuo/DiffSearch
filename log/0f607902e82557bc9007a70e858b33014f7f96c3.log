0f607902e82557bc9007a70e858b33014f7f96c3
==================================================
Expand temporary default source to cover URIs
==================================================
remm remm@apache.org
==================================================
Tue Dec 17 00:35:15 2019 +0100
==================================================
ConfigurationSource.java
Expand temporary default source to cover URIs

The memory DB actually used a URL.


==================================================
MemoryUserDatabaseTests.java
index 43d5a25b88..38228f9fc7 100644
--- a/java/org/apache/tomcat/util/file/ConfigurationSource.java
+++ b/java/org/apache/tomcat/util/file/ConfigurationSource.java
@@ -23,6 +23,7 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.net.MalformedURLException;
 import java.net.URI;
+import java.net.URL;
 
 /**
  * Abstracts configuration file storage. Allows Tomcat embedding using the regular
@@ -44,7 +45,17 @@ public interface ConfigurationSource {
             }
             if (f.isFile()) {
                 return new Resource(new FileInputStream(f), f.toURI());
-            } else {
+            }
+            URI uri = null;
+            try {
+                uri = getURI(name);
+            } catch (IllegalArgumentException e) {
+                throw new FileNotFoundException(name);
+            }
+            try {
+                URL url = uri.toURL();
+                return new Resource(url.openConnection().getInputStream(), uri);
+            } catch (MalformedURLException e) {
                 throw new FileNotFoundException(name);
             }
         }

==================================================
