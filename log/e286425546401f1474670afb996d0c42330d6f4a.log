e286425546401f1474670afb996d0c42330d6f4a
==================================================
Switch back to standard commons file-upload layout - simpler to merge updates. Part 2.
==================================================
Mark Emlyn
==================================================
Sun Aug 1 09:28:02 2010 +0000
==================================================
FileUploadBase.java
Switch back to standard commons file-upload layout - simpler to merge updates. Part 2.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@981187 13f79535-47bb-0310-9956-ffa450edef68



==================================================
MultipartStream.java
index 49985c66bd..f985257543 100644
--- a/java/org/apache/tomcat/util/http/fileupload/FileUploadBase.java
+++ b/java/org/apache/tomcat/util/http/fileupload/FileUploadBase.java
@@ -28,6 +28,10 @@ import java.util.NoSuchElementException;
 import javax.servlet.http.HttpServletRequest;
 
 import org.apache.tomcat.util.http.fileupload.MultipartStream.ItemInputStream;
+import org.apache.tomcat.util.http.fileupload.util.Closeable;
+import org.apache.tomcat.util.http.fileupload.util.FileItemHeadersImpl;
+import org.apache.tomcat.util.http.fileupload.util.LimitedInputStream;
+import org.apache.tomcat.util.http.fileupload.util.Streams;
 
 
 /**

==================================================
DiskFileItem.java
index 9c6477392a..4a8873aba3 100644
--- a/java/org/apache/tomcat/util/http/fileupload/MultipartStream.java
+++ b/java/org/apache/tomcat/util/http/fileupload/MultipartStream.java
@@ -22,6 +22,9 @@ import java.io.InputStream;
 import java.io.OutputStream;
 import java.io.UnsupportedEncodingException;
 
+import org.apache.tomcat.util.http.fileupload.util.Closeable;
+import org.apache.tomcat.util.http.fileupload.util.Streams;
+
 
 /**
  * <p> Low level API for processing file uploads.

==================================================
DiskFileItemFactory.java
similarity index 97%
rename from java/org/apache/tomcat/util/http/fileupload/DiskFileItem.java
rename to java/org/apache/tomcat/util/http/fileupload/disk/DiskFileItem.java
index 3d48a0d074..3c5babed2d 100644
--- a/java/org/apache/tomcat/util/http/fileupload/DiskFileItem.java
+++ b/java/org/apache/tomcat/util/http/fileupload/disk/DiskFileItem.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.disk;
 
 import java.io.BufferedInputStream;
 import java.io.BufferedOutputStream;
@@ -30,6 +30,14 @@ import java.io.OutputStream;
 import java.io.UnsupportedEncodingException;
 import java.util.Map;
 
+import org.apache.tomcat.util.http.fileupload.DeferredFileOutputStream;
+import org.apache.tomcat.util.http.fileupload.FileItem;
+import org.apache.tomcat.util.http.fileupload.FileItemHeaders;
+import org.apache.tomcat.util.http.fileupload.FileItemHeadersSupport;
+import org.apache.tomcat.util.http.fileupload.FileUploadException;
+import org.apache.tomcat.util.http.fileupload.IOUtils;
+import org.apache.tomcat.util.http.fileupload.ParameterParser;
+
 
 /**
  * <p> The default implementation of the

==================================================
ServletFileUpload.java
similarity index 95%
rename from java/org/apache/tomcat/util/http/fileupload/DiskFileItemFactory.java
rename to java/org/apache/tomcat/util/http/fileupload/disk/DiskFileItemFactory.java
index 1dc8f2b455..09c8ded43e 100644
--- a/java/org/apache/tomcat/util/http/fileupload/DiskFileItemFactory.java
+++ b/java/org/apache/tomcat/util/http/fileupload/disk/DiskFileItemFactory.java
@@ -14,10 +14,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.disk;
 
 import java.io.File;
 
+import org.apache.tomcat.util.http.fileupload.FileCleaningTracker;
+import org.apache.tomcat.util.http.fileupload.FileItem;
+import org.apache.tomcat.util.http.fileupload.FileItemFactory;
+
 
 /**
  * <p>The default {@link org.apache.commons.fileupload.FileItemFactory}
@@ -174,7 +178,7 @@ public class DiskFileItemFactory implements FileItemFactory {
     // --------------------------------------------------------- Public Methods
 
     /**
-     * Create a new {@link org.apache.commons.fileupload.disk.DiskFileItem}
+     * Create a new {@link org.apache.tomcat.util.http.fileupload.disk.commons.fileupload.disk.DiskFileItem}
      * instance from the supplied parameters and the local factory
      * configuration.
      *

==================================================
ServletRequestContext.java
similarity index 93%
rename from java/org/apache/tomcat/util/http/fileupload/ServletFileUpload.java
rename to java/org/apache/tomcat/util/http/fileupload/servlet/ServletFileUpload.java
index 49a9885f93..a95cc75ac0 100644
--- a/java/org/apache/tomcat/util/http/fileupload/ServletFileUpload.java
+++ b/java/org/apache/tomcat/util/http/fileupload/servlet/ServletFileUpload.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.servlet;
 
 import java.io.IOException;
 import java.util.List;
@@ -22,6 +22,12 @@ import java.util.Locale;
 
 import javax.servlet.http.HttpServletRequest;
 
+import org.apache.tomcat.util.http.fileupload.FileItem;
+import org.apache.tomcat.util.http.fileupload.FileItemFactory;
+import org.apache.tomcat.util.http.fileupload.FileItemIterator;
+import org.apache.tomcat.util.http.fileupload.FileUpload;
+import org.apache.tomcat.util.http.fileupload.FileUploadException;
+
 
 /**
  * <p>High level API for processing file uploads.</p>

==================================================
Closeable.java
similarity index 96%
rename from java/org/apache/tomcat/util/http/fileupload/ServletRequestContext.java
rename to java/org/apache/tomcat/util/http/fileupload/servlet/ServletRequestContext.java
index bb5460a1db..6db1d8e3f2 100644
--- a/java/org/apache/tomcat/util/http/fileupload/ServletRequestContext.java
+++ b/java/org/apache/tomcat/util/http/fileupload/servlet/ServletRequestContext.java
@@ -14,12 +14,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.servlet;
 
 import java.io.InputStream;
 import java.io.IOException;
 import javax.servlet.http.HttpServletRequest;
 
+import org.apache.tomcat.util.http.fileupload.RequestContext;
+
 
 /**
  * <p>Provides access to the request information needed for a request made to

==================================================
FileItemHeadersImpl.java
similarity index 96%
rename from java/org/apache/tomcat/util/http/fileupload/Closeable.java
rename to java/org/apache/tomcat/util/http/fileupload/util/Closeable.java
index 04d877b588..2c18c4750b 100644
--- a/java/org/apache/tomcat/util/http/fileupload/Closeable.java
+++ b/java/org/apache/tomcat/util/http/fileupload/util/Closeable.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.util;
 
 import java.io.IOException;
 

==================================================
LimitedInputStream.java
similarity index 96%
rename from java/org/apache/tomcat/util/http/fileupload/FileItemHeadersImpl.java
rename to java/org/apache/tomcat/util/http/fileupload/util/FileItemHeadersImpl.java
index efbdf8e9c9..72c8563b73 100644
--- a/java/org/apache/tomcat/util/http/fileupload/FileItemHeadersImpl.java
+++ b/java/org/apache/tomcat/util/http/fileupload/util/FileItemHeadersImpl.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.util;
 
 import java.io.Serializable;
 import java.util.ArrayList;
@@ -25,6 +25,8 @@ import java.util.List;
 import java.util.Locale;
 import java.util.Map;
 
+import org.apache.tomcat.util.http.fileupload.FileItemHeaders;
+
 
 /**
  * Default implementation of the {@link FileItemHeaders} interface.

==================================================
Streams.java
similarity index 99%
rename from java/org/apache/tomcat/util/http/fileupload/LimitedInputStream.java
rename to java/org/apache/tomcat/util/http/fileupload/util/LimitedInputStream.java
index bbef674d35..0f4a40eca6 100644
--- a/java/org/apache/tomcat/util/http/fileupload/LimitedInputStream.java
+++ b/java/org/apache/tomcat/util/http/fileupload/util/LimitedInputStream.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package org.apache.tomcat.util.http.fileupload;
+package org.apache.tomcat.util.http.fileupload.util;
 
 import java.io.FilterInputStream;
 import java.io.IOException;

==================================================
