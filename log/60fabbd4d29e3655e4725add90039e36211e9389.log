60fabbd4d29e3655e4725add90039e36211e9389
==================================================
Follow up to r1717311
==================================================
Violeta Georgieva
==================================================
Tue Dec 1 07:54:50 2015 +0000
==================================================
DefaultServlet.java
Follow up to r1717311

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1717385 13f79535-47bb-0310-9956-ffa450edef68



==================================================
RewriteValve.java
index cc6217f770..4cd5b57897 100644
--- a/java/org/apache/catalina/servlets/DefaultServlet.java
+++ b/java/org/apache/catalina/servlets/DefaultServlet.java
@@ -1718,7 +1718,7 @@ public class DefaultServlet extends HttpServlet {
             && resource.isFile()
             && length > sendfileSize
             && (resource.getCanonicalPath() != null)
-            && (Boolean.TRUE == request.getAttribute(Globals.SENDFILE_SUPPORTED_ATTR))
+            && (Boolean.TRUE.equals(request.getAttribute(Globals.SENDFILE_SUPPORTED_ATTR)))
             && (request.getClass().getName().equals("org.apache.catalina.connector.RequestFacade"))
             && (response.getClass().getName().equals("org.apache.catalina.connector.ResponseFacade"))) {
             request.setAttribute(Globals.SENDFILE_FILENAME_ATTR, resource.getCanonicalPath());

==================================================
TestSendFile.java
index 61cf6f5300..18f51091e2 100644
--- a/java/org/apache/catalina/valves/rewrite/RewriteValve.java
+++ b/java/org/apache/catalina/valves/rewrite/RewriteValve.java
@@ -263,7 +263,7 @@ public class RewriteValve extends ValveBase {
             return;
         }
 
-        if (invoked.get() == Boolean.TRUE) {
+        if (Boolean.TRUE.equals(invoked.get())) {
             try {
                 getNext().invoke(request, response);
             } finally {

==================================================
Async0.java
index 0c8bd7274f..4573a7a338 100644
--- a/test/org/apache/catalina/connector/TestSendFile.java
+++ b/test/org/apache/catalina/connector/TestSendFile.java
@@ -123,7 +123,7 @@ public class TestSendFile extends TomcatBaseTest{
             resp.setContentType("'application/octet-stream");
             resp.setCharacterEncoding("ISO-8859-1");
             resp.setContentLengthLong(f.length());
-            if (req.getAttribute(Globals.SENDFILE_SUPPORTED_ATTR) == Boolean.TRUE) {
+            if (Boolean.TRUE.equals(req.getAttribute(Globals.SENDFILE_SUPPORTED_ATTR))) {
                 req.setAttribute(Globals.SENDFILE_FILENAME_ATTR, f.getAbsolutePath());
                 req.setAttribute(Globals.SENDFILE_FILE_START_ATTR, new Long(0));
                 req.setAttribute(Globals.SENDFILE_FILE_END_ATTR, new Long(f.length()));

==================================================
