240c8186b988139ce5e591d71b8dc1334ffa5d8d
==================================================
Remove more START/STOP actions and started attribute. They aren't adding anything.
==================================================
Mark Emlyn
==================================================
Fri Sep 17 14:11:03 2010 +0000
==================================================
ActionCode.java
Remove more START/STOP actions and started attribute. They aren't adding anything.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@998145 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AjpAprProcessor.java
index 971877bcd0..043b4ddcfe 100644
--- a/java/org/apache/coyote/ActionCode.java
+++ b/java/org/apache/coyote/ActionCode.java
@@ -40,8 +40,6 @@ public enum ActionCode {
 
     CUSTOM,
     RESET,
-    START,
-    STOP,
     WEBAPP,
 
     /**

==================================================
AjpAprProtocol.java
index b452b512da..48f92e19d6 100644
--- a/java/org/apache/coyote/ajp/AjpAprProcessor.java
+++ b/java/org/apache/coyote/ajp/AjpAprProcessor.java
@@ -175,12 +175,6 @@ public class AjpAprProcessor implements ActionHook {
     protected MessageBytes bodyBytes = MessageBytes.newInstance();
 
 
-    /**
-     * State flag.
-     */
-    protected boolean started = false;
-
-
     /**
      * Error flag.
      */
@@ -378,7 +372,7 @@ public class AjpAprProcessor implements ActionHook {
         boolean openSocket = true;
         boolean keptAlive = false;
 
-        while (started && !error && !endpoint.isPaused()) {
+        while (!error && !endpoint.isPaused()) {
 
             // Parsing the request header
             try {
@@ -593,14 +587,6 @@ public class AjpAprProcessor implements ActionHook {
                 error = true;
             }
 
-        } else if (actionCode == ActionCode.START) {
-
-            started = true;
-
-        } else if (actionCode == ActionCode.STOP) {
-
-            started = false;
-
         } else if (actionCode == ActionCode.REQ_SSL_ATTRIBUTE ) {
 
             if (!certificates.isNull()) {

==================================================
AjpProcessor.java
index 6dc73af967..84396cc7ea 100644
--- a/java/org/apache/coyote/ajp/AjpAprProtocol.java
+++ b/java/org/apache/coyote/ajp/AjpAprProtocol.java
@@ -396,8 +396,6 @@ public class AjpAprProtocol
                     processor = createProcessor();
                 }
 
-                processor.action(ActionCode.START, null);
-
                 if (processor.process(socket)) {
                     connections.put(Long.valueOf(socket), processor);
                     return SocketState.OPEN;
@@ -427,7 +425,6 @@ public class AjpAprProtocol
                 AjpAprProtocol.log.error
                     (sm.getString("ajpprotocol.proto.error"), e);
             } finally {
-                processor.action(ActionCode.STOP, null);
                 recycledProcessors.offer(processor);
             }
             return SocketState.CLOSED;

==================================================
AjpProtocol.java
index a8709f9601..c7c45ba576 100644
--- a/java/org/apache/coyote/ajp/AjpProcessor.java
+++ b/java/org/apache/coyote/ajp/AjpProcessor.java
@@ -170,12 +170,6 @@ public class AjpProcessor implements ActionHook {
     protected MessageBytes bodyBytes = MessageBytes.newInstance();
 
 
-    /**
-     * State flag.
-     */
-    protected boolean started = false;
-
-
     /**
      * Error flag.
      */
@@ -383,7 +377,7 @@ public class AjpProcessor implements ActionHook {
         // Error flag
         error = false;
 
-        while (started && !error && !endpoint.isPaused()) {
+        while (!error && !endpoint.isPaused()) {
 
             // Parsing the request header
             try {
@@ -596,14 +590,6 @@ public class AjpProcessor implements ActionHook {
                 error = true;
             }
 
-        } else if (actionCode == ActionCode.START) {
-
-            started = true;
-
-        } else if (actionCode == ActionCode.STOP) {
-
-            started = false;
-
         } else if (actionCode == ActionCode.REQ_SSL_ATTRIBUTE ) {
 
             if (!certificates.isNull()) {

==================================================
