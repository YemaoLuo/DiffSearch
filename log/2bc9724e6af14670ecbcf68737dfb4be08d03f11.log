2bc9724e6af14670ecbcf68737dfb4be08d03f11
==================================================
Notify jmx when returning the connection that has been marked suspect.
==================================================
Keiichi Fujino
==================================================
Mon Sep 12 08:09:33 2016 +0000
==================================================
ConnectionPool.java
Notify jmx when returning the connection that has been marked suspect.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1760299 13f79535-47bb-0310-9956-ffa450edef68



==================================================
ConnectionPool.java
index c99b467530..ceb223913c 100644
--- a/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java
+++ b/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java
@@ -902,6 +902,10 @@ public class ConnectionPool {
                         log.info("Connection(" + con + ") that has been marked suspect was returned."
                                 + " The processing time is " + (System.currentTimeMillis()-con.getTimestamp()) + " ms.");
                     }
+                    if (jmxPool!=null) {
+                        jmxPool.notify(org.apache.tomcat.jdbc.pool.jmx.ConnectionPool.SUSPECT_RETURNED_NOTIFICATION,
+                                "Connection(" + con + ") that has been marked suspect was returned.");
+                    }
                 }
                 if (busy.remove(con)) {
 

==================================================
