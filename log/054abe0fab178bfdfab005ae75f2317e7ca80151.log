054abe0fab178bfdfab005ae75f2317e7ca80151
==================================================
Manually merge #548 - Avoid int overflow when parsing octet
==================================================
lihan lihan@apache.org
==================================================
Mon Aug 29 21:43:06 2022 +0800
==================================================
HttpParser.java
Manually merge #548 - Avoid int overflow when parsing octet



==================================================
TestHttpParserHost.java
index 4df0467194..21ba58967d 100644
--- a/java/org/apache/tomcat/util/http/parser/HttpParser.java
+++ b/java/org/apache/tomcat/util/http/parser/HttpParser.java
@@ -754,6 +754,10 @@ public class HttpParser {
                     }
                 } else {
                     octet = octet * 10 + c - '0';
+                    // Avoid overflow
+                    if (octet > 255) {
+                        break;
+                    }
                 }
             } else if (c == ':') {
                 break;

==================================================
