45d4cd4bc1af72207a75a31e1ba08718bf6a2425
==================================================
Fix logic error. UNSET means "Don't set the attribute" :)
==================================================
Mark Thomas
==================================================
Tue Oct 12 17:43:09 2021 +0100
==================================================
LegacyCookieProcessor.java
Fix logic error. UNSET means "Don't set the attribute" :)


==================================================
Rfc6265CookieProcessor.java
index 990ad3eae7..5867d50cd1 100644
--- a/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
+++ b/java/org/apache/tomcat/util/http/LegacyCookieProcessor.java
@@ -332,7 +332,7 @@ public final class LegacyCookieProcessor extends CookieProcessorBase {
         if (cookieSameSite == null) {
             // Use processor config
             SameSiteCookies sameSiteCookiesValue = getSameSiteCookies();
-            if (sameSiteCookiesValue.equals(SameSiteCookies.UNSET)) {
+            if (!sameSiteCookiesValue.equals(SameSiteCookies.UNSET)) {
                 buf.append("; SameSite=");
                 buf.append(sameSiteCookiesValue.getValue());
             }

==================================================
