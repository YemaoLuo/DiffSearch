05d53ea48ea78464aff22d159df64f143b7d24de
==================================================
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=57556
==================================================
Mark Thomas
==================================================
Tue Feb 10 20:54:07 2015 +0000
==================================================
StandardContext.java
Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=57556
Align getRealPath() behaviour with that of earlier versions and include a trailing separator if the real path refers to a directory.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1658804 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestStandardContext.java
index 855de61494..5a5d8fdd2a 100644
--- a/java/org/apache/catalina/core/StandardContext.java
+++ b/java/org/apache/catalina/core/StandardContext.java
@@ -4407,7 +4407,12 @@ public class StandardContext extends ContainerBase
         }
         if (resources != null) {
             try {
-                return resources.getResource(path).getCanonicalPath();
+                WebResource resource = resources.getResource(path);
+                if (resource.isDirectory()) {
+                    return resource.getCanonicalPath() + File.separatorChar;
+                } else {
+                    return resource.getCanonicalPath();
+                }
             } catch (IllegalArgumentException iae) {
                 // ServletContext.getRealPath() does not allow this to be thrown
             }

==================================================
