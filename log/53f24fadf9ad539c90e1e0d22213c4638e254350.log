53f24fadf9ad539c90e1e0d22213c4638e254350
==================================================
UCDetector
==================================================
Mark Emlyn
==================================================
Fri Feb 15 22:42:33 2013 +0000
==================================================
SmapUtil.java
UCDetector
 - use of final
 - reduce visibility

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1446795 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TagLibraryInfoImpl.java
index d3aeff5347..536b01605b 100644
--- a/java/org/apache/jasper/compiler/SmapUtil.java
+++ b/java/org/apache/jasper/compiler/SmapUtil.java
@@ -48,7 +48,7 @@ public class SmapUtil {
     //*********************************************************************
     // Constants
 
-    public static final String SMAP_ENCODING = "UTF-8";
+    private static final String SMAP_ENCODING = "UTF-8";
 
     //*********************************************************************
     // Public entry points
@@ -458,11 +458,11 @@ public class SmapUtil {
         }
     }
 
-    static class SmapGenVisitor extends Node.Visitor {
+    private static class SmapGenVisitor extends Node.Visitor {
 
         private SmapStratum smap;
-        private boolean breakAtLF;
-        private HashMap<String, SmapStratum> innerClassMap;
+        private final boolean breakAtLF;
+        private final HashMap<String, SmapStratum> innerClassMap;
 
         SmapGenVisitor(SmapStratum s, boolean breakAtLF, HashMap<String, SmapStratum> map) {
             this.smap = s;

==================================================
TagPluginManager.java
index 3240d3b905..43c0c6c63a 100644
--- a/java/org/apache/jasper/compiler/TagLibraryInfoImpl.java
+++ b/java/org/apache/jasper/compiler/TagLibraryInfoImpl.java
@@ -65,13 +65,13 @@ class TagLibraryInfoImpl extends TagLibraryInfo implements TagConstants {
     // Logger
     private final Log log = LogFactory.getLog(TagLibraryInfoImpl.class);
 
-    private JspCompilationContext ctxt;
+    private final JspCompilationContext ctxt;
 
-    private PageInfo pi;
+    private final PageInfo pi;
 
-    private ErrorDispatcher err;
+    private final ErrorDispatcher err;
 
-    private ParserController parserController;
+    private final ParserController parserController;
 
     private final void print(String name, String value, PrintWriter w) {
         if (value != null) {
@@ -761,5 +761,5 @@ class TagLibraryInfoImpl extends TagLibraryInfo implements TagConstants {
         return tlv.validate(getPrefixString(), uri, thePage);
     }
 
-    protected TagLibraryValidator tagLibraryValidator;
+    private TagLibraryValidator tagLibraryValidator;
 }

==================================================
TextOptimizer.java
index 20c4bb4758..fbdd1cbedb 100644
--- a/java/org/apache/jasper/compiler/TagPluginManager.java
+++ b/java/org/apache/jasper/compiler/TagPluginManager.java
@@ -44,7 +44,7 @@ public class TagPluginManager {
 
     private boolean initialized = false;
     private HashMap<String, TagPlugin> tagPlugins = null;
-    private ServletContext ctxt;
+    private final ServletContext ctxt;
     private PageInfo pageInfo;
 
     public TagPluginManager(ServletContext ctxt) {
@@ -172,11 +172,11 @@ public class TagPluginManager {
         tagPlugin.doTag(tagPluginContext);
     }
 
-    static class TagPluginContextImpl implements TagPluginContext {
-        private Node.CustomTag node;
+    private static class TagPluginContextImpl implements TagPluginContext {
+        private final Node.CustomTag node;
         private Node.Nodes curNodes;
-        private PageInfo pageInfo;
-        private HashMap<String, Object> pluginAttributes;
+        private final PageInfo pageInfo;
+        private final HashMap<String, Object> pluginAttributes;
 
         TagPluginContextImpl(Node.CustomTag n, PageInfo pageInfo) {
             this.node = n;

==================================================
TldLocation.java
index 5ce9623bec..9f00b579e1 100644
--- a/java/org/apache/jasper/compiler/TextOptimizer.java
+++ b/java/org/apache/jasper/compiler/TextOptimizer.java
@@ -26,12 +26,12 @@ public class TextOptimizer {
     /**
      * A visitor to concatenate contiguous template texts.
      */
-    static class TextCatVisitor extends Node.Visitor {
+    private static class TextCatVisitor extends Node.Visitor {
 
         private static final String EMPTY_TEXT = "";
 
-        private Options options;
-        private PageInfo pageInfo;
+        private final Options options;
+        private final PageInfo pageInfo;
         private int textNodeCount = 0;
         private Node.TemplateText firstTextNode = null;
         private StringBuilder textBuffer;

==================================================
TldLocationsCache.java
index 521ca830d9..5885968684 100644
--- a/java/org/apache/jasper/compiler/TldLocation.java
+++ b/java/org/apache/jasper/compiler/TldLocation.java
@@ -19,8 +19,8 @@ package org.apache.jasper.compiler;
 
 public class TldLocation {
 
-    private String entryName;
-    private JarResource jar;
+    private final String entryName;
+    private final JarResource jar;
 
     public TldLocation(String entryName) {
         this(entryName, (JarResource)null);

==================================================
Validator.java
index 725df73881..f36d48a60f 100644
--- a/java/org/apache/jasper/compiler/TldLocationsCache.java
+++ b/java/org/apache/jasper/compiler/TldLocationsCache.java
@@ -151,10 +151,10 @@ public class TldLocationsCache {
      *    [0] The location
      *    [1] If the location is a jar file, this is the location of the tld.
      */
-    private Hashtable<String, TldLocation> mappings;
+    private final Hashtable<String, TldLocation> mappings;
 
     private volatile boolean initialized;
-    private ServletContext ctxt;
+    private final ServletContext ctxt;
 
     /** Constructor.
      *

==================================================
