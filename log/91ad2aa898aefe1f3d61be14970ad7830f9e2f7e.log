91ad2aa898aefe1f3d61be14970ad7830f9e2f7e
==================================================
Update OpenSSL unit tests to use 1.0.1i
==================================================
Mark Emlyn
==================================================
Wed Aug 13 21:53:53 2014 +0000
==================================================
Authentication.java
Update OpenSSL unit tests to use 1.0.1i
Fix a couple of failures caused by some SRP ciphers incorrectly recorded as using aNULL rather than SRP as the authentication mechanism

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1617843 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Cipher.java
index a05c714289..21ad4d4fb8 100644
--- a/java/org/apache/tomcat/util/net/jsse/openssl/Authentication.java
+++ b/java/org/apache/tomcat/util/net/jsse/openssl/Authentication.java
@@ -28,5 +28,6 @@ enum Authentication {
     PSK /* PSK auth */,
     GOST94 /* GOST R 34.10-94 signature auth */,
     GOST01 /* GOST R 34.10-2001 */,
-    FZA /* Fortezza */;
+    FZA /* Fortezza */,
+    SRP
 }

==================================================
TesterOpenSSL.java
index dca0216886..70d4716cec 100644
--- a/java/org/apache/tomcat/util/net/jsse/openssl/Cipher.java
+++ b/java/org/apache/tomcat/util/net/jsse/openssl/Cipher.java
@@ -2031,7 +2031,7 @@ enum Cipher {
     TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA(
             "SRP-3DES-EDE-CBC-SHA",
             KeyExchange.SRP,
-            Authentication.aNULL,
+            Authentication.SRP,
             Encryption.TRIPLE_DES,
             MessageDigest.SHA1,
             Protocol.TLSv1,
@@ -2073,7 +2073,7 @@ enum Cipher {
     TLS_SRP_SHA_WITH_AES_128_CBC_SHA(
             "SRP-AES-128-CBC-SHA",
             KeyExchange.SRP,
-            Authentication.aNULL,
+            Authentication.SRP,
             Encryption.AES128,
             MessageDigest.SHA1,
             Protocol.TLSv1,
@@ -2115,7 +2115,7 @@ enum Cipher {
     TLS_SRP_SHA_WITH_AES_256_CBC_SHA(
             "SRP-AES-256-CBC-SHA",
             KeyExchange.SRP,
-            Authentication.aNULL,
+            Authentication.SRP,
             Encryption.AES256,
             MessageDigest.SHA1,
             Protocol.TLSv1,

==================================================
