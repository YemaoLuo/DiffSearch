62c2a65c8b1ce35bda0e1e631712a715025fcb34
==================================================
Review of Context.getApplicationLifecycleListeners() calls:
==================================================
Konstantin Kolinko
==================================================
Tue Jun 12 16:58:38 2012 +0000
==================================================
StandardContext.java
Review of Context.getApplicationLifecycleListeners() calls:
Do less work if there are no listeners or 'notify' flag is false.
I do not expect much effect from this change, because implementation of Context.getApplicationLifecycleListeners() in StandardContext is lightweight: it returns a field value. Note that by default it returns an empty array, not null.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1349439 13f79535-47bb-0310-9956-ffa450edef68



==================================================
StandardSession.java
index b95e13192f..f1e4a310e9 100644
--- a/java/org/apache/catalina/core/StandardContext.java
+++ b/java/org/apache/catalina/core/StandardContext.java
@@ -4658,7 +4658,7 @@ public class StandardContext extends ContainerBase
         context.setNewServletContextListenerAllowed(false);
 
         Object instances[] = getApplicationLifecycleListeners();
-        if (instances == null)
+        if (instances == null || instances.length == 0)
             return (ok);
         ServletContextEvent event =
           new ServletContextEvent(getServletContext());
@@ -4699,7 +4699,7 @@ public class StandardContext extends ContainerBase
 
         boolean ok = true;
         Object listeners[] = getApplicationLifecycleListeners();
-        if (listeners != null) {
+        if (listeners != null && listeners.length > 0) {
             ServletContextEvent event =
                 new ServletContextEvent(getServletContext());
             for (int i = 0; i < listeners.length; i++) {

==================================================
