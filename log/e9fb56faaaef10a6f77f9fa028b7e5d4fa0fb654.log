e9fb56faaaef10a6f77f9fa028b7e5d4fa0fb654
==================================================
Allow the maximum allowed size of a resource that is cached to be configured. The default of cacheMaxSize/20 gave too high a value for large caches.
==================================================
Mark Emlyn
==================================================
Fri Sep 26 11:56:42 2008 +0000
==================================================
StandardContext.java
Allow the maximum allowed size of a resource that is cached to be configured. The default of cacheMaxSize/20 gave too high a value for large caches.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@699287 13f79535-47bb-0310-9956-ffa450edef68



==================================================
BaseDirContext.java
index e62ab78f38..34ddce36a8 100644
--- a/java/org/apache/catalina/core/mbeans-descriptors.xml
+++ b/java/org/apache/catalina/core/mbeans-descriptors.xml
@@ -57,6 +57,10 @@
                description="Maximum cache size in KB"
                type="int"/>
       
+    <attribute name="cacheObjectMaxSize"
+               description="Maximum cached object size in KB"
+               type="int"/>
+      
     <attribute name="cacheTTL"
                description="Time interval in ms between cache refeshes"
                type="int"/>

==================================================
ProxyDirContext.java
index 78f3c02b1e..8345001099 100644
--- a/java/org/apache/naming/resources/BaseDirContext.java
+++ b/java/org/apache/naming/resources/BaseDirContext.java
@@ -105,11 +105,17 @@ public abstract class BaseDirContext implements DirContext {
 
 
     /**
-     * Max size of resources which will have their content cached.
+     * Max size of cache for resources.
      */
     protected int cacheMaxSize = 10240; // 10 MB
 
 
+    /**
+     * Max size of resources that will be content cached.
+     */
+    protected int cacheObjectMaxSize = 512; // 512 K
+
+
     // ------------------------------------------------------------- Properties
 
 
@@ -192,6 +198,22 @@ public abstract class BaseDirContext implements DirContext {
     }
 
 
+    /**
+     * Return the maximum size of objects to be cached in KB.
+     */
+    public int getCacheObjectMaxSize() {
+        return cacheObjectMaxSize;
+    }
+
+
+    /**
+     * Set the maximum size of objects to be placed the cache in KB.
+     */
+    public void setCacheObjectMaxSize(int cacheObjectMaxSize) {
+        this.cacheObjectMaxSize = cacheObjectMaxSize;
+    }
+
+
     // --------------------------------------------------------- Public Methods
 
 

==================================================
