afe77d0b5a731e91ddd58f999328028631935d21
==================================================
Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49000
==================================================
Mark Emlyn
==================================================
Tue Jan 4 18:28:23 2011 +0000
==================================================
Cookies.java
Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49000
Consistently handle name only cookies (which are not spec complaint)

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1055132 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TestCookies.java
index 01d5bae6c4..39e8edab3d 100644
--- a/java/org/apache/tomcat/util/http/Cookies.java
+++ b/java/org/apache/tomcat/util/http/Cookies.java
@@ -283,7 +283,7 @@ public final class Cookies { // extends MultiMap {
             // cookie at the end of the cookie header, so if we
             // are past the end of the header, but we have a name
             // skip to the name-only part.
-            if (pos < end && bytes[pos] == '=') {                
+            if (pos < (end - 1) && bytes[pos] == '=') {                
 
                 // Skip whitespace
                 do {

==================================================
