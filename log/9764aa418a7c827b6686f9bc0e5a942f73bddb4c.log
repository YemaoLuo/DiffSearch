9764aa418a7c827b6686f9bc0e5a942f73bddb4c
==================================================
Fix Bz 65714 - security manager + TLS + NIO2
==================================================
Mark Thomas
==================================================
Wed Dec 1 09:27:36 2021 +0000
==================================================
Constants.java
Fix Bz 65714 - security manager + TLS + NIO2


==================================================
SecureNio2Channel.java
index ca5c0e4a15..9cda5e1836 100644
--- a/java/org/apache/tomcat/util/net/Constants.java
+++ b/java/org/apache/tomcat/util/net/Constants.java
@@ -38,4 +38,6 @@ public class Constants {
     public static final String SSL_PROTO_SSLv3      = "SSLv3";
     public static final String SSL_PROTO_SSLv2      = "SSLv2";
     public static final String SSL_PROTO_SSLv2Hello = "SSLv2Hello";
+
+    public static final boolean IS_SECURITY_ENABLED = (System.getSecurityManager() != null);
 }

==================================================
