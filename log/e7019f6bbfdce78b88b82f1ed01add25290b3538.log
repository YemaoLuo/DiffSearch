e7019f6bbfdce78b88b82f1ed01add25290b3538
==================================================
Refactor onDataAvailable() in preparation for fixing BZ 64771
==================================================
Mark Thomas
==================================================
Mon Mar 22 21:51:24 2021 +0000
==================================================
CoyoteAdapter.java
Refactor onDataAvailable() in preparation for fixing BZ 64771

https://bz.apache.org/bugzilla/show_bug.cgi?id=64771


==================================================
Request.java
index b39f07bebc..ea3dbe4fd9 100644
--- a/java/org/apache/catalina/connector/CoyoteAdapter.java
+++ b/java/org/apache/catalina/connector/CoyoteAdapter.java
@@ -207,7 +207,7 @@ public class CoyoteAdapter implements Adapter {
                         // onAllDataRead() event. Therefore, make sure
                         // onDataAvailable() is not called in this case.
                         if (!request.isFinished()) {
-                            readListener.onDataAvailable();
+                            req.onDataAvailable();
                         }
                         if (request.isFinished() && req.sendAllDataReadEvent()) {
                             readListener.onAllDataRead();

==================================================
