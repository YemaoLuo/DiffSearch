f465aaa18559483c74ea407a08c23b48ec30aae4
==================================================
Remove unused configuration setting since the recent refactoring removed a layer of buffering
==================================================
Mark Thomas
==================================================
Fri Jan 9 12:22:54 2015 +0000
==================================================
AbstractHttp11Protocol.java
Remove unused configuration setting since the recent refactoring removed a layer of buffering

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1650512 13f79535-47bb-0310-9956-ffa450edef68



==================================================
Http11AprProtocol.java
index feee77027e..46edc41739 100644
--- a/java/org/apache/coyote/http11/AbstractHttp11Protocol.java
+++ b/java/org/apache/coyote/http11/AbstractHttp11Protocol.java
@@ -175,17 +175,6 @@ public abstract class AbstractHttp11Protocol<S> extends AbstractProtocol<S> {
     }
 
 
-    /**
-     * The size of the buffer used by the ServletOutputStream when performing
-     * delayed asynchronous writes using HTTP upgraded connections.
-     */
-    private int upgradeAsyncWriteBufferSize = 8192;
-    public int getUpgradeAsyncWriteBufferSize() { return upgradeAsyncWriteBufferSize; }
-    public void setUpgradeAsyncWriteBufferSize(int upgradeAsyncWriteBufferSize) {
-        this.upgradeAsyncWriteBufferSize = upgradeAsyncWriteBufferSize;
-    }
-
-
     // ------------------------------------------------ HTTP specific properties
     // ------------------------------------------ passed through to the EndPoint
 

==================================================
Http11Nio2Protocol.java
index 3af66dc459..a3390e909d 100644
--- a/java/org/apache/coyote/http11/Http11AprProtocol.java
+++ b/java/org/apache/coyote/http11/Http11AprProtocol.java
@@ -319,8 +319,7 @@ public class Http11AprProtocol extends AbstractHttp11Protocol<Long> {
                 SocketWrapperBase<Long> socket, ByteBuffer leftoverInput,
                 HttpUpgradeHandler httpUpgradeProcessor)
                 throws IOException {
-            return new UpgradeProcessor<>(socket, leftoverInput, httpUpgradeProcessor,
-                    proto.getUpgradeAsyncWriteBufferSize());
+            return new UpgradeProcessor<>(socket, leftoverInput, httpUpgradeProcessor);
         }
     }
 }

==================================================
Http11NioProtocol.java
index 3744608470..4363bdf4a5 100644
--- a/java/org/apache/coyote/http11/Http11Nio2Protocol.java
+++ b/java/org/apache/coyote/http11/Http11Nio2Protocol.java
@@ -240,8 +240,7 @@ public class Http11Nio2Protocol extends AbstractHttp11JsseProtocol<Nio2Channel>
                 SocketWrapperBase<Nio2Channel> socket, ByteBuffer leftoverInput,
                 HttpUpgradeHandler httpUpgradeProcessor)
                 throws IOException {
-            return new UpgradeProcessor<>(socket, leftoverInput,
-                    httpUpgradeProcessor, proto.getUpgradeAsyncWriteBufferSize());
+            return new UpgradeProcessor<>(socket, leftoverInput, httpUpgradeProcessor);
         }
 
         @Override

==================================================
UpgradeProcessor.java
index 19d66d3df5..c9cea7ed48 100644
--- a/java/org/apache/coyote/http11/Http11NioProtocol.java
+++ b/java/org/apache/coyote/http11/Http11NioProtocol.java
@@ -280,8 +280,7 @@ public class Http11NioProtocol extends AbstractHttp11JsseProtocol<NioChannel> {
                 SocketWrapperBase<NioChannel> socket, ByteBuffer leftoverInput,
                 HttpUpgradeHandler httpUpgradeProcessor)
                 throws IOException {
-            return new UpgradeProcessor<>(socket, leftoverInput, httpUpgradeProcessor,
-                    proto.getUpgradeAsyncWriteBufferSize());
+            return new UpgradeProcessor<>(socket, leftoverInput, httpUpgradeProcessor);
         }
 
         @Override

==================================================
UpgradeServletOutputStream.java
index fd8235549a..c554d0dfa7 100644
--- a/java/org/apache/coyote/http11/upgrade/UpgradeProcessor.java
+++ b/java/org/apache/coyote/http11/upgrade/UpgradeProcessor.java
@@ -48,11 +48,10 @@ public class UpgradeProcessor<S> implements Processor<S>, WebConnection {
 
 
     public UpgradeProcessor(SocketWrapperBase<?> wrapper, ByteBuffer leftOverInput,
-            HttpUpgradeHandler httpUpgradeHandler, int asyncWriteBufferSize) {
+            HttpUpgradeHandler httpUpgradeHandler) {
         this.httpUpgradeHandler = httpUpgradeHandler;
         this.upgradeServletInputStream = new UpgradeServletInputStream(wrapper);
-        this.upgradeServletOutputStream =
-                new UpgradeServletOutputStream(wrapper, asyncWriteBufferSize);
+        this.upgradeServletOutputStream = new UpgradeServletOutputStream(wrapper);
 
         wrapper.unRead(leftOverInput);
         wrapper.setTimeout(INFINITE_TIMEOUT);

==================================================
