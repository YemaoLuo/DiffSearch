8047f2ee5cefb3bb0239095e033fb51e7e297b77
==================================================
Fix broken stylesheet URL in XML based manager status output.
==================================================
Rainer Jung
==================================================
Wed Apr 6 21:31:25 2011 +0000
==================================================
Constants.java
Fix broken stylesheet URL in XML based manager status output.

The URLs of the status base pages have a varying number
of path segments, so a relativ URL to the stylesheet
does no longer work.


git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1089638 13f79535-47bb-0310-9956-ffa450edef68



==================================================
StatusManagerServlet.java
index c0b68421fc..1f644d9639 100644
--- a/java/org/apache/catalina/manager/Constants.java
+++ b/java/org/apache/catalina/manager/Constants.java
@@ -210,7 +210,7 @@ public class Constants {
         "<?xml version=\"1.0\" encoding=\""+CHARSET+"\"?>";
 
     public static final String XML_STYLE =
-        "<?xml-stylesheet type=\"text/xsl\" href=\"xform.xsl\" ?>";
+        "<?xml-stylesheet type=\"text/xsl\" href=\"{0}/xform.xsl\" ?>\n";
 
 }
 

==================================================
StatusTransformer.java
index 4bf605173c..092db09254 100644
--- a/java/org/apache/catalina/manager/StatusManagerServlet.java
+++ b/java/org/apache/catalina/manager/StatusManagerServlet.java
@@ -199,10 +199,12 @@ public class StatusManagerServlet
             completeStatus = true;
         }
         // use StatusTransformer to output status
-        StatusTransformer.writeHeader(writer,mode);
+        Object[] args = new Object[1];
+        args[0] = request.getContextPath();
+        StatusTransformer.writeHeader(writer,args,mode);
 
         // Body Header Section
-        Object[] args = new Object[2];
+        args = new Object[2];
         args[0] = request.getContextPath();
         if (completeStatus) {
             args[1] = sm.getString("statusServlet.complete");

==================================================
