c905c6ff0f30182292565fae2973d84e808ce832
==================================================
Handle possible status line i18n in tests.
==================================================
Remy Maucherat
==================================================
Thu Mar 20 15:51:58 2014 +0000
==================================================
TestCometProcessor.java
Handle possible status line i18n in tests.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1579672 13f79535-47bb-0310-9956-ffa450edef68



==================================================
TomcatBaseTest.java
index 92af43bcd0..6fa9bbef70 100644
--- a/test/org/apache/catalina/comet/TestCometProcessor.java
+++ b/test/org/apache/catalina/comet/TestCometProcessor.java
@@ -340,7 +340,7 @@ public class TestCometProcessor extends TomcatBaseTest {
             // Failure at any later stage and the response headers (including
             // the 200 response code will already have been sent to the client
             if (SimpleCometServlet.FAIL_ON_BEGIN.equals(initParam)) {
-                assertEquals("HTTP/1.1 500 Internal Server Error", response[0]);
+                assertEquals("500", getStatusCode(response[0]));
                 alv.validateAccessLog(1, 500, 0, 1000);
             } else {
                 assertEquals("HTTP/1.1 200 OK", response[0]);

==================================================
TestUpgrade.java
index ce2f90fd3e..93f651e388 100644
--- a/test/org/apache/catalina/startup/TomcatBaseTest.java
+++ b/test/org/apache/catalina/startup/TomcatBaseTest.java
@@ -400,6 +400,14 @@ public abstract class TomcatBaseTest extends LoggingBaseTest {
         return rc;
     }
 
+    protected static String getStatusCode(String statusLine) {
+        if (statusLine == null || statusLine.length() < 12) {
+            return statusLine;
+        } else {
+            return statusLine.substring(9, 12);
+        }
+    }
+
     private static class TomcatWithFastSessionIDs extends Tomcat {
 
         @Override

==================================================
