3285734aa74f470047a502cee85487c6431d2863
==================================================
Switch to new, non-deprecated method
==================================================
Mark Thomas
==================================================
Wed Nov 18 17:10:49 2020 +0000
==================================================
AprEndpoint.java
Switch to new, non-deprecated method


==================================================
Nio2Endpoint.java
index 67ef3d1ef7..4ba34203aa 100644
--- a/java/org/apache/tomcat/util/net/AprEndpoint.java
+++ b/java/org/apache/tomcat/util/net/AprEndpoint.java
@@ -486,7 +486,7 @@ public class AprEndpoint extends AbstractEndpoint<Long,Long> implements SNICallB
         }
         if (running) {
             running = false;
-            acceptor.stop();
+            acceptor.stop(10);
             poller.stop();
             for (SocketWrapperBase<Long> socketWrapper : connections.values()) {
                 socketWrapper.close();

==================================================
NioEndpoint.java
index 7bd882e160..5741498dcb 100644
--- a/java/org/apache/tomcat/util/net/Nio2Endpoint.java
+++ b/java/org/apache/tomcat/util/net/Nio2Endpoint.java
@@ -192,7 +192,7 @@ public class Nio2Endpoint extends AbstractJsseEndpoint<Nio2Channel,AsynchronousS
         }
         if (running) {
             running = false;
-            acceptor.stop();
+            acceptor.stop(10);
             // Use the executor to avoid binding the main thread if something bad
             // occurs and unbind will also wait for a bit for it to complete
             getExecutor().execute(new Runnable() {

==================================================
