8f83475ea84e95fab3f6a54235a40f69053a7152
==================================================
The '$' in the class name of Digester$EnvironmentPropertySource is no… (#244)
==================================================
Bernd Bohmann
==================================================
Fri Feb 28 12:09:04 2020 +0100
==================================================
Digester.java
The '$' in the class name of Digester$EnvironmentPropertySource is no… (#244)

The '$' in the class name of Digester$EnvironmentPropertySource is not really shell friendly for unix environments. The class should not a inner class.


==================================================
EnvironmentPropertySource.java
index a7c1740233..dc60837c0c 100644
--- a/java/org/apache/tomcat/util/digester/Digester.java
+++ b/java/org/apache/tomcat/util/digester/Digester.java
@@ -145,24 +145,13 @@ public class Digester extends DefaultHandler2 {
         }
     }
 
-
-    public static class EnvironmentPropertySource implements IntrospectionUtils.SecurePropertySource {
-
-        @Override
-        public String getProperty(String key) {
-            return null;
-        }
-
-        @Override
-        public String getProperty(String key, ClassLoader classLoader) {
-            if (classLoader instanceof PermissionCheck) {
-                Permission p = new RuntimePermission("getenv." + key, null);
-                if (!((PermissionCheck) classLoader).check(p)) {
-                    return null;
-                }
-            }
-            return System.getenv(key);
-        }
+    /**
+     * A {@link org.apache.tomcat.util.IntrospectionUtils.SecurePropertySource} that uses environment variables to resolve expressions.
+     * Still available for backwards compatibility.
+     * @see org.apache.tomcat.util.digester.EnvironmentPropertySource
+     *
+     */
+    public static class EnvironmentPropertySource extends org.apache.tomcat.util.digester.EnvironmentPropertySource {
     }
 
 

==================================================
