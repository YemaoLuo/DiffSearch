5a9650a0b005135f64b1b3717176827fae2e2d0f
==================================================
BZ45026: Never return an empty HTTP status response phrase.
==================================================
Rainer Jung
==================================================
Tue Mar 24 10:57:38 2009 +0000
==================================================
AjpAprProcessor.java
BZ45026: Never return an empty HTTP status response phrase.
mod_jk and httpd 2.x do not like that.

Addition to r697183.


git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@757721 13f79535-47bb-0310-9956-ffa450edef68



==================================================
AjpProcessor.java
index c0ea67b787..6ec6ca004b 100644
--- a/java/org/apache/coyote/ajp/AjpAprProcessor.java
+++ b/java/org/apache/coyote/ajp/AjpAprProcessor.java
@@ -961,6 +961,10 @@ public class AjpAprProcessor implements ActionHook {
         } else {
             message = message.replace('\n', ' ').replace('\r', ' ');
         }
+        if (message == null) {
+            // mod_jk + httpd 2.x fails with a null status message - bug 45026
+            message = Integer.toString(response.getStatus());
+        }
         tmpMB.setString(message);
         responseHeaderMessage.appendBytes(tmpMB);
 

==================================================
